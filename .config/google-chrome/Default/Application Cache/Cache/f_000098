mx.prototype.X7=ER(53,function(){return Uv(this,3)});jF.prototype.X7=ER(52,function(){return Uv(this,5)});mx.prototype.z5=ER(51,function(){return W(this,3)});jF.prototype.z5=ER(50,function(){return W(this,5)});mx.prototype.Z7=ER(49,function(){return Uv(this,2)});jF.prototype.Z7=ER(48,function(){return Uv(this,4)});mx.prototype.U5=ER(47,function(){return W(this,2)});jF.prototype.U5=ER(46,function(){return W(this,4)});function y1c(a,b){Vf(a,11).push(b)}
function z1c(a){return new li(function(b){var c=a.length,d=[];if(c)for(var e=function(a,e,f){c--;d[a]=e?{pFa:!0,value:f}:{pFa:!1,reason:f};0==c&&b(d)},f=0,h;f<a.length;f++)h=a[f],Wia(h,Fa(e,f,!0),Fa(e,f,!1));else b(d)})}function A1c(a,b){var c=fu(a,b);return u(c)?String(fu(a,b)):null}function B1c(a,b){a.D=b}var C1c=/['()]/g;function D1c(a){return"%"+a.charCodeAt(0).toString(16)}function E1c(a){a=Mb(String(a));C1c.lastIndex=0;return C1c.test(a)?a.replace(C1c,D1c):a}
function F1c(a){return null!=a?a:Number.MIN_VALUE}function G1c(a){return null!=a?a:Number.MAX_VALUE}function H1c(a,b){return ovc(b)?ovc(a)&&W(a,1)==W(b,1):ovc(a)?F1c(W(a,1))>F1c(W(b,1))&&F1c(W(a,1))<G1c(qw(b)):F1c(W(a,1))>=F1c(W(b,1))&&G1c(qw(a))<=G1c(qw(b))}function I1c(a){return a.Gl()+Yb(a.C)};function J1c(a){return R('<input type="text" id="docs-copy-link" class="'+T("docs-copy-link")+'" value="'+T(a.link)+'" readonly="readonly">')};function k_(a,b,c,d){Mp.call(this,void 0,void 0,a);this.J=this.O=this.L=this.C=null;this.Aa="";this.F=b||null;this.qa=c||new QBb(a);this.ea=null!=d?d:null;a=new vp;Ip(a,{key:"done",caption:"Done"},!0,!0);this.F&&this.qa.C()&&Ip(a,{key:"copy-link",caption:"Copy Link"});yp(this,a)}y(k_,Mp);p=k_.prototype;
p.xa=function(){k_.ma.xa.call(this);ah(sp(this),"copy-link-dialog");var a=zp(this.D,"done");ah(a,"copy-link-done-button");this.C=P(J1c,{link:this.Aa},void 0,this.oa());Zh(this.C,"label","Link to this comment");this.Ib().appendChild(this.C);if(this.L=zp(this.D,"copy-link"))a=Vd("DIV"),ah(a,"copy-link-butter-holder"),this.getElement().insertBefore(a,qp(this)),this.O=new Un(a),this.J=Wn("Link copied to clipboard.","info",!1,4E3);null!==this.ea&&(ph(this.mx(),"z-index",this.ea),ph(sp(this),"z-index",
this.ea+1))};p.Mm=function(){k_.ma.Mm.call(this);this.F&&this.getHandler().R(this.F,"copy",this.jDa);this.C.focus();this.C.select()};p.Uo=function(){k_.ma.Uo.call(this);this.F&&this.getHandler().Rc(this.F,"copy",this.jDa)};p.Ia=function(){k_.ma.Ia.call(this);this.getHandler().R(this.C,"click",this.iUb);this.L&&this.getHandler().R(this.L,"click",this.tpb)};p.OUb=function(a){this.Aa=a;this.C&&(this.C.value=a)};p.iUb=function(a){a.target.focus();a.target.select()};
p.tpb=function(a){a.stopPropagation();this.F&&this.qa.C()&&this.C&&this.C.value&&(this.C.focus(),this.C.select(),this.F.C(this.C.value))};p.jDa=function(a){a.C&&this.J&&this.O&&(this.J.isVisible()||this.O.postMessage(this.J),this.C.focus(),this.C.select())};p.Fa=function(){k_.ma.Fa.call(this);D(this.J);delete this.J;delete this.L;delete this.C};function l_(){var a=new ON(null);SR(a,!0);return a};function K1c(a,b,c){F.call(this);this.D=a;this.Ui=b;this.Ob=c;this.V=this.H=this.Ga=this.Aa=this.$=this.F=null;this.Zc=new xS;this.We=new xS;this.qa=this.O=null;this.Hd=new xS;this.Wf=new xS;this.Ra=this.Na=this.Oa=this.ea=this.L=null;this.He=new xS;this.Pe=new xS;this.vd=new xS;this.gf=new xS;this.Ta=this.Ac=null;this.C=new cX("");this.Ua=this.J=this.Ab=this.wb=this.Xd=this.$b=this.Db=this.kb=null;this.ah=this.Mc=!1;this.zd=this.Af=this.Bb=this.jb=null;this.we=new hh(this);this.va(this.we);this.Sc=
new dw;this.Qg=this.xi=this.Eh=this.Eg=this.Rh=this.Ja=null;this.Nx();a=this.we;a.R(this.F,"action",this.dvb);a.R(this.$,"action",this.ila);a.R(this.Aa,"action",this.ila);a.R(this.Ga,"action",this.ila);a.R(this.J,"focus",Fa(this.$Sa,!0));a.R(this.J,"blur",Fa(this.$Sa,!1));a.R(this.J,"change",this.Wka);a.R(this.J,"keyup",this.Wka);b=[this.O,this.qa,this.H,this.V,this.L,this.ea,this.Na,this.Ra];for(c=0;c<b.length;c++)this.we.R(b[c],"change",v(this.uZb,this,b[c])),this.we.R(b[c],"keyup",v(this.Zub,this,
b[c]));a.R(this.Bb,"change",v(this.BLa,this));a.R(this.Oa,"change",v(this.CGb,this));a.Pg(this.Ua,ff,this.XBb)}y(K1c,F);var L1c="placeholder"in document.createElement("input"),M1c=/\s*,\s*/;function N1c(a){var b=a.Qg;b||(b=[{bj:"List from a range",type:4},{bj:"List of items",type:3},{bj:"Number",type:0},{bj:"Text",type:1},{bj:"Date",type:2},{bj:"Custom formula is",type:5}],J(I(),"fecdv")&&b.push({bj:"Checkbox",type:6}),a.Qg=b);return b}
function O1c(a){var b=a.xi;b||(b=[{bj:"contains",code:9,inputs:0,example:"Approved"},{bj:"does not contain",code:10,inputs:0,example:"Approved"},{bj:"equals",code:13,inputs:0,example:"Approved"},{bj:"is valid email",code:14,inputs:-1,example:null},{bj:"is valid url",code:15,inputs:-1,example:null}],a.xi=b);return b}
function P1c(a){var b=a.Eg;b||(b=[{bj:"is valid date",code:30,inputs:-1,example:null},{bj:"equal to",code:16,inputs:2,example:"11/15/2014"},{bj:"before",code:17,inputs:2,example:"11/15/2014"},{bj:"on or before",code:19,inputs:2,example:"11/15/2014"},{bj:"after",code:18,inputs:2,example:"11/15/2014"},{bj:"on or after",code:20,inputs:2,example:"11/15/2014"},{bj:"between",code:21,inputs:3,example:"11/15/2014",FP:"11/15/2015"},{bj:"not between",code:22,inputs:3,example:"11/15/2014",FP:"11/15/2015"}],
a.Eg=b);return b}function Q1c(a){var b=a.Eh;b||(b=[{bj:"range",code:23,inputs:6,example:null},{bj:"the list of items",code:24,inputs:5,example:"Enter items separated by a comma..."}],a.Eh=b);return b}
function R1c(a){var b=a.Rh;b||(b=[{bj:"between",code:7,inputs:8,example:"10",FP:"100"},{bj:"not between",code:8,inputs:8,example:"10",FP:"100"},{bj:"less than",code:3,inputs:7,example:"10"},{bj:"less than or equal to",code:4,inputs:7,example:"10"},{bj:"greater than",code:1,inputs:7,example:"10"},{bj:"greater than or equal to",code:2,inputs:7,example:"10"},{bj:"equal to",code:5,inputs:7,example:"10"},{bj:"not equal to",code:6,inputs:7,example:"10"}],a.Rh=b);return b}
function S1c(){return{bj:"",code:29,inputs:0,example:"=ISODD(A1)"}}function T1c(){return{bj:"",code:31,inputs:-1,example:""}}p=K1c.prototype;
p.Nx=function(){var a=this.D,b,c,d,e,f,h,k,l,m,q,t,w,x,z,C=a.oa(),M;var O=C.xa("TR","waffle-dv-trrules",C.xa("TD","waffle-dv-label",C.xa("SPAN",{id:"waffle-dv-criteria"},"Criteria:")),C.xa("TD",{colspan:"7"},l=C.xa("DIV","goog-inline-block"),M=C.xa("DIV","goog-inline-block"),h=C.xa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),c=C.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),e=C.xa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"}),
b=C.xa("SPAN","waffle-dv-separator","and"),k=C.xa("INPUT",{type:"text","class":"waffle-dv-editbox-number jfk-textinput"}),d=C.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"}),f=C.xa("INPUT",{type:"text","class":"waffle-dv-editbox-date jfk-textinput"})));this.vd.Va(h);this.gf.Va(k);this.Hd.Va(c);this.Wf.Va(d);this.Zc.Va(e);this.We.Va(f);var S=l_();Th(S,l);var ha=l_();Th(ha,l);var ca=l_();Th(ca,l);var qa=l_();Th(qa,l);var sa=U1c(a,M);(w=S.getElement())&&Zh(w,"labelledby","waffle-dv-criteria");
var wa;var ya=C.xa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",C.xa("TD"),C.xa("TD",{colspan:"7"},wa=C.xa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Show dropdown list in cell")));w=new qq;Vp(w,wa);Th(w,wa);var Xa=C.xa("TR","waffle-dv-trrules waffle-dv-trrules-showitems",C.xa("TD"),C.xa("TD",{colspan:"7"},m=C.xa("SPAN","waffle-dv-label waffle-dv-checkbox-label","Use custom cell values")));var bb=new qq;Vp(bb,m);Th(bb,m);var Ua=C.xa("TR","waffle-dv-trrules",C.xa("TD"),C.xa("TD","waffle-dv-customcheckboxlabel",
C.xa("SPAN",{id:"customCheckboxInputLabel_checked"},"Checked:")),C.xa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},q=C.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));var ub=C.xa("TR","waffle-dv-trrules",C.xa("TD"),C.xa("TD","waffle-dv-customcheckboxlabel",C.xa("SPAN",{id:"customCheckboxInputLabel_unchecked"},"Unchecked:")),C.xa("TD",{colspan:"6","class":"waffle-dv-show-dropdown"},t=C.xa("INPUT",{type:"text","class":"waffle-dv-editbox-text jfk-textinput"})));this.He.Va(q);
this.Pe.Va(t);Zh(q,"labelledby","customCheckboxInputLabel_checked");Zh(t,"labelledby","customCheckboxInputLabel_unchecked");AS(this.He,"e.g., TRUE");AS(this.Pe,"e.g., FALSE");var wc=C.xa("TR","waffle-dv-trrules",C.xa("TD","waffle-dv-label",C.xa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-on-invalid-data"},"On invalid data: ")),C.xa("TD",{colspan:"7"},C.xa("DIV",{role:"radiogroup","aria-labelledby":"waffle-dv-on-invalid-data"},C.xa("INPUT",{type:"radio",id:"showWarningOnInvalidData_radio",name:"onInvalidData",
role:"radio"}),C.xa("LABEL",{"for":"showWarningOnInvalidData_radio"},"Show warning"),C.xa("INPUT",{type:"radio",id:"rejectInvalidData_radio",name:"onInvalidData",role:"radio"}),C.xa("LABEL",{"for":"rejectInvalidData_radio"},"Reject input"))));m=new jDc(!0);kDc(m,"onInvalidData",wc);var Xb=C.xa("TR","waffle-dv-trrules waffle-dv-trrules-appearance",C.xa("TD",null,C.xa("SPAN",{"class":"waffle-dv-label",id:"waffle-dv-appearance"},"Appearance:")),C.xa("TD",{colspan:"7"},x=C.xa("SPAN","waffle-dv-label waffle-dv-checkbox-label",
"Show validation help text:")));var Qc=new qq;Vp(Qc,x);Th(Qc,x);x=Qc.Da;var Kc=Eia(x,"labelledby");Zh(x,"labelledby","waffle-dv-appearance "+Kc);x=C.xa("TR","waffle-dv-trrules",C.xa("TD"),C.xa("TD",{colspan:"7","class":"waffle-dv-show-dropdown"},z=C.xa("INPUT",{type:"text","class":"waffle-dv-helptext jfk-textinput"}),Kc=C.xa("SPAN",{"class":"menuMainLink waffle-dv-smalltext","aria-label":"Reset help text to default value."},"Reset")));se(Kc,!0);a=a.O.childNodes[0];C.appendChild(a,O);C.appendChild(a,
ya);C.appendChild(a,Xa);C.appendChild(a,Ua);C.appendChild(a,ub);C.appendChild(a,wc);C.appendChild(a,Xb);C.appendChild(a,x);this.C.render(l);C=this.C;C.Cna=29;C.resize();C=this.C;C.mOa=200;C.resize();this.C.getElement().style.width="324px";L1c?this.C.getElement().placeholder="Enter items separated by a comma...":(C=this.C.getElement(),Oi(C,"Enter items separated by a comma...","Enter items separated by a comma..."));if(C=this.C.getElement())ei(C,"Enter items separated by a comma..."),bh(C,["waffle-dv-list-options-textarea",
"jfk-textinput"]);this.J=z;S.setVisible(!0);C=N1c(this);V1c(this,C,S);C=R1c(this);V1c(this,C,qa);C=O1c(this);V1c(this,C,ha);C=P1c(this);V1c(this,C,ca);W1c(this,S,qa,ha,ca,h,k,c,d,e,f,b,l,sa,ya,x,w,wa,Kc,Qc,M,m,bb,q,t,Xa,Ua,ub)};
function W1c(a,b,c,d,e,f,h,k,l,m,q,t,w,x,z,C,M,O,S,ha,ca,qa,sa,wa,ya,Xa,bb,Ua){a.F=b;a.F.setVisible(!0);a.Aa=c;a.$=e;a.Ga=d;a.Ac=t;a.L=f;a.ea=h;a.O=k;a.qa=l;a.H=m;a.V=q;a.Ta=w;a.Ja=x;a.kb=ca;a.Oa=sa;a.Na=wa;a.Ra=ya;a.Xd=Xa;a.wb=bb;a.Ab=Ua;L(a.Xd,!1);L(a.wb,!1);L(a.Ab,!1);ha.Ec(!1);a.Bb=ha;a.zd=qa;X1c(a,!1);a.Db=z;M.Ec(!0);a.jb=M;a.Af=O;a.$b=C;L(a.$b,!0);Y1c(a);Z1c(a);a.Ua=S;L(a.Ua,!1)}
function $1c(a,b){L(a.Db,23==b||24==b);a.Af.innerText="Show dropdown list in cell";b=31==b;L(a.Xd,b);var c=a.Oa.isChecked();L(a.wb,b&&c);L(a.Ab,b&&c)}function a2c(a){W1c(a,a.F,a.Aa,a.Ga,a.$,a.L,a.ea,a.O,a.qa,a.H,a.V,a.Ac,a.Ta,a.Ja,a.Db,a.$b,a.jb,a.Af,a.Ua,a.Bb,a.kb,a.zd,a.Oa,a.Na,a.Ra,a.Xd,a.wb,a.Ab)}function V1c(a,b,c){for(var d=0;d<b.length;d++){var e=a.D.oa();e=new hk(b[d].bj,null,e);c.Pd(e);e=e.getElement();Yh(e,"menuitem")}c.tf(0)}p.ila=function(){Z1c(this);this.J.value=b2c(this);this.dispatchEvent("change")};
p.dvb=function(){Y1c(this);Z1c(this);this.J.value=b2c(this);this.dispatchEvent("change")};p.$Sa=da("ah");p.Wka=function(a){this.Mc||a&&!Gka(a)||this.J.value===c2c(this)||(this.Mc=!0,L(this.Ua,!0))};p.XBb=function(){this.Mc=!1;this.J.value=b2c(this);L(this.Ua,!1)};p.BLa=function(){L(this.$b,this.Bb.isChecked())};p.CGb=function(){var a=this.Oa.isChecked();a||d2c(this);L(this.wb,a);L(this.Ab,a);e2c(this)};function e2c(a){a.J.value=b2c(a)}function f2c(a){e2c(a);a.C.resize()}
p.uZb=function(a){e2c(this);g2c(this,a)?(this.D.Cl=0,m_(a),this.dispatchEvent("change")):(this.D.Cl=1,n_(a),this.dispatchEvent("error"))};p.Zub=function(){this.dispatchEvent("keyup")};function g2c(a,b){if(0!=o_(a))return!0;var c=b.value;if(null!=c&&Kh(b)){if(!h2c(a.D))return!0;a=p_(a,c,i2c(a).code);return null!=a&&(Uv(a,3)||Uv(a,5)&&W(a,5).od()&&3==W(W(a,5).Ma(),1))}return!0}function n_(a){a.select();ah(a,"waffle-input-error")}function m_(a){a&&ch(a,"waffle-input-error")}
function d2c(a){m_(a.C.getElement());m_(a.H);m_(a.V);m_(a.L);m_(a.ea);m_(a.Na);m_(a.O);m_(a.qa);m_(a.Ja.Cr());a.D.Cl=0;a.dispatchEvent("change")}function o_(a){return N1c(a)[a.F.Wg()].type}function Y1c(a){var b=o_(a),c=!1,d=!1,e=!1,f=!1,h=!1;0==b?d=!0:2==b?c=!0:1==b?e=!0:3==b?f=!0:4==b&&(h=!0);a.$.setVisible(c);a.Aa.setVisible(d);a.Ga.setVisible(e);L(a.Ta,f);L(a.kb,h);L(a.L,!1);L(a.ea,!1);L(a.O,!1);L(a.qa,!1);L(a.H,!1);L(a.V,!1);f&&a.C.resize();a.dispatchEvent("change")}
function i2c(a){var b;null!=j2c(a)?b=j2c(a):a.$.isVisible()?b=P1c(a)[a.$.Wg()]:a.Aa.isVisible()?b=R1c(a)[a.Aa.Wg()]:5==o_(a)?b=S1c():6==o_(a)?b=T1c():b=O1c(a)[a.Ga.Wg()];return b}function j2c(a){var b=Q1c(a);return 4==o_(a)?b[0]:3==o_(a)?b[1]:null}
function Z1c(a){var b=!1,c=!1,d=!1,e=!1,f=!1,h=!1,k=!1,l=!1,m=!1,q=i2c(a);-1!=q.inputs&&(0==q.inputs?d=!0:1==q.inputs?k=e=d=!0:2==q.inputs?f=!0:3==q.inputs?k=h=f=!0:7==q.inputs?b=!0:8==q.inputs?k=c=b=!0:5==q.inputs?l=!0:6==q.inputs&&(m=!0));var t=i2c(a);if(3==o_(a))L1c?a.C.getElement().placeholder="Enter items separated by a comma...":(t=a.C.getElement(),Oi(t,"Enter items separated by a comma...","Enter items separated by a comma..."));else if(t.example)if(0==t.inputs||1==t.inputs)AS(a.Hd,"e.g., "+
t.example),AS(a.Wf,"e.g., "+t.FP||"");else if(2==t.inputs||3==t.inputs)AS(a.Zc,"e.g., "+t.example),AS(a.We,"e.g., "+t.FP||"");else if(7==t.inputs||8==t.inputs)AS(a.vd,"e.g., "+t.example),AS(a.gf,"e.g., "+t.FP||"");d2c(a);L(a.L,b);L(a.ea,c);L(a.O,d);L(a.qa,e);L(a.H,f);L(a.V,h);L(a.Ta,l);l&&a.C.resize();L(a.kb,m);$1c(a,q.code);L(a.Ac,k)}
function p_(a,b,c){var d=h2c(a.D);if(""==b||null==d.ud)return null;var e=d.rect,f=e.yc();e=e.rc();return(b=ritz_api.RitzModelApi.parseConditionArgument(d.ud+"",f,e,b,c,!0))?a.Sc.xd(Hw.Ca(),b):null}
function k2c(a){var b=new Mw,c=i2c(a),d=c.code,e=[];switch(c.inputs){case 0:e.push(p_(a,a.O.value,d));break;case 1:e.push(p_(a,a.O.value,d));e.push(p_(a,a.qa.value,d));break;case 2:e.push(p_(a,a.H.value,d));break;case 3:e.push(p_(a,a.H.value,d));e.push(p_(a,a.V.value,d));break;case 7:e.push(p_(a,a.L.value,d));break;case 8:e.push(p_(a,a.L.value,d));e.push(p_(a,a.ea.value,d));break;case 5:a=a.C.Ma().split(",");for(c=0;c<a.length;c++)e.push(xvc(a[c]));break;case 6:c=G$a("="+a.Ja.Ma());e.push(p_(a,c,
d));break;case -1:a.Oa.isChecked()&&(e.push(p_(a,Lb(a.Na.value),d)),Jb(a.Ra.value)||e.push(p_(a,Lb(a.Ra.value),d)))}for(a=0;a<e.length;a++)if(!e[a])return null;d=sS(d,e);X(b,1,d);return b}function l2c(a){var b=Lb(a.Ja.Ma());!a.Ob.C.D[Lb(Yb(b).toLowerCase())]&&CU(a.Ob,b)&&(b=Cuc(a.Ob,b,!0));return b}function b2c(a){return a.Mc||a.ah?a.J.value:c2c(a)}
function c2c(a){var b="";var c=o_(a);var d=4==c;c=3==c||4==c;if(a.$.isVisible())c=P1c(a)[a.$.Wg()],b=-1==c.inputs?b+"Enter a valid date":b+"Enter a date ";else if(a.Ga.isVisible())c=O1c(a)[a.Ga.Wg()],b=14==c.code?b+"Enter a valid email":15==c.code?b+"Enter a valid url":b+"Enter text that ";else if(c)c=j2c(a),b+="Click and enter a value from ";else if(5==o_(a))c=S1c(),b="Enter a value that satisfies the formula:";else if(6==o_(a))if(c=T1c(),a.Oa.isChecked()&&!Jb(Lb(a.Na.value))){b=Lb(a.Na.value);var e=
Lb(a.Ra.value);b=Jb(e)?"Enter "+(b+" or blank."):"Enter "+(b+(" or "+(e+".")))}else b="Enter TRUE or FALSE.";else c=R1c(a)[a.Aa.Wg()],b+="Enter a number ";-1!=c.inputs&&(b+=c.bj);e=l2c(a);23==c.code&&""!=e&&d&&(d=Cuc(a.Ob,e,!0))&&(b+=" "+d);Jb(Yb(a.O.value))||0!=c.inputs&&1!=c.inputs?Jb(Yb(a.H.value))||2!=c.inputs&&3!=c.inputs?Jb(Yb(a.L.value))||7!=c.inputs&&8!=c.inputs||(b+=" "+a.L.value):b+=" "+a.H.value:b+=" "+a.O.value;Jb(Yb(a.qa.value))||1!=c.inputs?Jb(Yb(a.V.value))||3!=c.inputs?Jb(Yb(a.ea.value))||
8!=c.inputs||(b+=" and "+a.ea.value):b+=" and "+a.V.value:b+=" and "+a.qa.value;return b}function X1c(a,b){lDc(a.zd,b?"rejectInvalidData_radio":"showWarningOnInvalidData_radio")}function q_(a,b){switch(b){case 0:a.F.tf(2);break;case 1:a.F.tf(3);break;case 2:a.F.tf(4);break;case 3:a.F.tf(1);break;case 4:a.F.tf(0);break;case 5:a.F.tf(5);break;case 6:a.F.tf(6)}}
function m2c(a,b,c,d,e){a.F.tf(0);a.$.tf(0);a.Aa.tf(0);a.Ga.tf(0);a.J.value="";a.L.value="";a.ea.value="";a.H.value="";a.V.value="";a.O.value="";a.qa.value="";a.C.Qa("");a.Ja.Qa("");X1c(a,!1);var f=a.Mc=!1,h=!1,k=!1,l=!1,m=!1,q=!1,t=!1,w=!1,x=!1,z=!1,C=!1,M=!1,O=!1,S=!1,ha=!1,ca=!1,qa=!1,sa=!1,wa=b&&W(b,1);b=wa&&Jw(wa);if((wa=wa&&Kw(wa))&&b){for(var ya=Q1c(a),Xa=P1c(a),bb=R1c(a),Ua=O1c(a),ub=S1c(),wc=T1c(),Xb=0,Qc=0;Qc<ya.length;Qc++)if(b==ya[Qc].code){Xb=ya[Qc].inputs;23==ya[Qc].code?(ca=!0,q_(a,
4)):(M=!0,q_(a,3));a.jb.Ec(!!e);break}for(e=0;e<Xa.length;e++)if(b==Xa[e].code){Xb=Xa[e].inputs;a.$.tf(e);q_(a,2);O=w=!0;break}for(e=0;e<bb.length;e++)if(b==bb[e].code){Xb=bb[e].inputs;a.Aa.tf(e);q_(a,0);S=x=!0;break}for(e=0;e<Ua.length;e++)if(b==Ua[e].code){Xb=Ua[e].inputs;a.Ga.tf(e);q_(a,1);ha=z=!0;break}b==ub.code&&(Xb=ub.inputs,q_(a,5),qa=!0);b==wc.code&&(Xb=wc.inputs,q_(a,6),sa=!0);if(O||ha||S||M||ca||qa||sa)if(ha=h2c(a.D),O=ha.rect.yc(),S=ha.rect.rc(),ha=ha.ud+"",-1==Xb)sa&&0<wa.length&&(C=
!0,a.Oa.Ec(!0),a.He.Qa(HH(wa[0],ha,O,S)),1<wa.length&&a.Pe.Qa(HH(wa[1],ha,O,S)));else if(0==Xb)m=HH(wa[0],ha,O,S),a.Hd.Qa(m),m=!0;else if(1==Xb)q=HH(wa[0],ha,O,S),m=HH(wa[1],ha,O,S),a.Hd.Qa(q),a.Wf.Qa(m),q=m=t=!0;else if(2==Xb)f=HH(wa[0],ha,O,S),a.Zc.Qa(f),f=!0;else if(3==Xb)h=HH(wa[0],ha,O,S),f=HH(wa[1],ha,O,S),a.Zc.Qa(h),a.We.Qa(f),h=f=t=!0;else if(7==Xb)k=HH(wa[0],ha,O,S),a.vd.Qa(k),k=!0;else if(8==Xb)l=HH(wa[0],ha,O,S),k=HH(wa[1],ha,O,S),a.vd.Qa(l),a.gf.Qa(k),l=k=t=!0;else if(5==Xb){M=!0;sa=[];
for(Xb=0;Xb<wa.length;Xb++)sa.push(HH(wa[Xb],ha,O,S));a.C.Qa(sa.join(","));a.C.resize()}else 6==Xb&&(ca=!0,sa=HH(wa[0],ha,O,S),null!=sa&&(sa=sa.substring(1),wa=!!NF(sa),sa=(Xb=PF(sa,a.Ui,!1,!0))?RF(Xb.rect,Xb.Tg):sa,wa||(sa=OF(sa)),a.Ja.Qa(sa)));else a.F.tf(0),ca=!0;L(a.Ac,t);a.$.setVisible(w);a.Aa.setVisible(x);a.Ga.setVisible(z);L(a.H,f);L(a.V,h);L(a.O,m);L(a.qa,q);L(a.L,k);L(a.ea,l);L(a.wb,C);L(a.Ab,C);L(a.Db,!0);L(a.Ta,M);a.C.resize();L(a.kb,ca);null!=b&&$1c(a,b)}else{if(E0a){w=zK(a.Ui);x=w.Qc();
z=new Xq;for(C=x.yc();C<x.Uc();C++)for(M=x.rc();M<x.Wc();M++)ca=w.Qf(C,M),""!=PH(ca)&&Yq(z,PH(ca).split(M1c));z.isEmpty()?w=!1:(a2c(a),a.C.Qa(z.Cd().join(",")),q_(a,3),Y1c(a),w=!0)}else w=!1;w||a2c(a)}a.BLa();c=c||"";w=c.lastIndexOf("</strong>");-1!=w&&(c=Pb(Lb(c.substring(w+9))));a.Bb.Ec(!!c);c&&(b2c(a)!=c&&a.Wka(),a.J.value=c,L(a.$b,!0));X1c(a,d)}
p.Fa=function(){this.Ra=this.Na=this.ea=this.L=this.qa=this.O=this.V=this.H=null;D(this.C);this.Db=this.jb=this.Ua=this.J=this.Ac=this.C=null;D(this.Ja);this.Ja=null;D(this.jb);this.jb=null;D(this.Ga);this.Ga=null;D(this.Aa);this.Aa=null;D(this.$);this.$=null;D(this.F);this.F=null;K1c.ma.Fa.call(this)};function n2c(a){var b=a.description;a=a.mSb;return R('<div class="waffle-dv-rec-chip" title="'+T(b)+'"><div class="waffle-dv-rec-range">'+Q(a)+'</div><div class="waffle-dv-rec-description">'+Q(b)+"</div></div>")}function o2c(){return R('<div class="waffle-dv-no-suggestions" role="alert" aria-live="polite">No suggestions for selected data</div>')};function p2c(a,b,c,d,e,f,h){mp.call(this);this.kb=a;this.Zc=b;this.Ac=c;this.Mc=d;this.Aa=e;this.jb=f;this.Bb=h;this.ea=new N(this.oa());this.Ha(this.ea);this.Ab=new kr("",new sW,this.oa());this.Ha(this.Ab);this.wb=new N(this.oa());this.Ha(this.wb);this.Oa=new qW(!1,"#4285f4");this.Ha(this.Oa);this.Db=new uW(c,q2c.Aca,q2c.Bca);this.va(this.Db);this.F=this.O=null;this.Ua=new hh(this);this.va(this.Ua);this.Ta=this.L=this.J=this.C=null;this.Ra=J(I(),"fedvs");this.qa=null;this.$b=[];this.Ob=-1;this.L=
new vp;this.L.set("save","Save",!1);this.L.set("clear","Remove validation",!1,!1);this.L.set("cancel","Cancel",!1,!0);yp(this,this.L);up(this,!1);this.render();a=this.Ib();b=this.oa();c=q2c;np(this,"Data validation");this.J||(d=b.xa("DIV",{"class":c.DXa}),e=b.xa("DIV",{"class":c.CXa},d),b.appendChild(a,e),this.J=new Tn(e),this.J.setType("warning"),this.J.setContent(""),this.J.render(d),Fsa(this.J,!0),this.J.setVisible(!1));this.Ra&&(e=b.xa("DIV",c.k3a),f=b.xa("DIV",{id:r2c.aya},"Suggested validations"),
d=b.xa("DIV",c.j3a),h=b.xa("DIV",c.Hua,"Send feedback"),b.appendChild(a,e),b.appendChild(e,h),b.appendChild(e,f),b.appendChild(a,d),this.Ab.Va(h),L(h,GA),this.ea.Va(d),e=b.xa("DIV",c.X2a),b.appendChild(d,e),this.wb.Va(e),this.Oa.render(e),rW(this.Oa,!0));this.O=b.xa("TABLE",{cellSpacing:"0","class":c.iE},b.xa("TBODY"));b.appendChild(a,this.O);this.Ra&&ah(this.O,c.s3a);a=this.Ib();a=Kd(a);b=a.xa("TR",q2c.I3a);b.appendChild(a.xa("TD","waffle-dv-label",a.xa("LABEL",{id:"waffle-dv-cell-range"},"Cell range: ")));
c=a.xa("TD",{colspan:"7"});this.C=U1c(this,c);s2c(this);b.appendChild(c);a.appendChild(this.O.childNodes[0],b);(a=this.C.Cr())&&Zh(a,"labelledby","waffle-dv-cell-range");this.F=new K1c(this,this.kb,this.Aa);yq(this,"save");t2c(this)}y(p2c,mp);
var q2c={CXa:"waffle-input-error-butter-container",DXa:"waffle-input-error-butter-wrap",Hua:"waffle-dv-feedback-link",Aca:"waffle-dv-highlight-styled-border",Bca:"waffle-dv-highlight-styled-rect",fva:"waffle-input-error",X2a:"waffle-dv-rec-spinner-container",vda:"waffle-dv-rec-chip-selected",j3a:"waffle-dv-rec-wrapper",k3a:"waffle-dv-recs-title-bar",iE:"waffle-dv-table",s3a:"waffle-dv-table-with-suggestions",I3a:"waffle-dv-trrules"},r2c={aya:"waffle-dv-recs-title"};p=p2c.prototype;p.Cl=0;
function s2c(a){if(a.C){var b=a.kb.getActiveGrid();b&&(b=RF(IG(a.Ac).Qc(),b.pe(),!0),a.C.Qa(b))}}function t2c(a){a.Ua.R(a,"dialogselect",a.tZb).R(a.F,"error",a.Xub).R(a.F,"change",a.sZb);a.Ra&&a.Ua.R(a.jb,"recommender-calc-ended",a.rZb).R(a.Ab,"action",function(){K.Ou.wc({source:"dataValidationDialogFeedback"})})}p.Xub=function(){u2c(this)};p.sZb=function(){u2c(this);Jp(this.L,"save",!0)};function v2c(a){var b=a.oa();a=a.ea.Da;var c=P(o2c);b.appendChild(a,c)}
p.rZb=function(a){var b=this;rW(this.Oa,!1);L(this.wb.Da,!1);a=a.C;if(0==a.length)v2c(this);else{var c=this.oa(),d=this.ea.Da,e=0,f=w2c(this),h=!1;A(a,function(a){var k=W(a,13);if(!(3<=e)&&k){e++;var m=AU(a),q=RF(sA(m)),t=W(k,3);b.$b.push(t);k="";switch(Jw(t)){case 14:k="Is valid email";break;case 15:k="Is valid URL";break;case 30:k="Is valid date";break;case 24:k="List: "+Kw(t).map(function(a){return W(W(a,5).Ma(),2)}).join();break;case 1:k="Greater than "+W(W(Kw(t)[0],5).Ma(),3);break;case 7:k=
Kw(t);k="Between "+(W(W(k[0],5).Ma(),3)+(" and "+W(W(k[1],5).Ma(),3)));break;case 5:k=Kw(t);k="Equals "+W(W(k[0],5).Ma(),3);break;default:pgc.C("Unrecognized data validation type.")}var w=P(n2c,{description:k,mSb:q}),x=new mr("",c);x.kf(8,!0);x.Va(w);Zh(w,"describedby",r2c.aya);b.ea.Ha(x);c.appendChild(d,w);b.Ua.R(x,"action",function(){x2c(b,x,t,q)}).R(w,"mouseenter",function(){vW(b.Db,zU(m))}).R(w,"mouseleave",function(){wW(b.Db)}).R(w,"focus",function(){Bh(w,d)});a=.98<=W(a,2);!h&&(!f||tvc(f,m)||
qvc(f,m)&&a&&(a||24==Jw(t)||7==Jw(t)||5==Jw(t)))&&(h=!0,x.dispatchEvent("action"))}})}};function x2c(a,b,c,d){var e=q2c,f=$g(b.Da,e.vda);a.ea.Cf(function(a){a.Ek(e.vda,!1);a.Oc(!1)});b.Ek(e.vda,!f);b.Oc(!f);f?(a.show(!0),a.qa=null):(b=new Mw,X(b,1,c),m2c(a.F,b,null,null,!0),f2c(a.F),a.C.Qa(d),a.qa=c)}
p.tZb=function(a){if("save"==a.key){if(!y2c(this)){a.preventDefault();return}}else{var b;if(b="clear"==a.key)(b=w2c(this))?(this.Bb.Xb(35300),this.Mc.C(new FS(new Xx,b)),b=!0):b=!1,b=!b;if(b){a.preventDefault();return}}this.C&&this.C.Pa(!1)};function u2c(a){var b=z2c(a.Cl);b&&a.J.setContent(b);a.J.setVisible(0!=a.Cl);b=2==a.Cl||4==a.Cl;var c=q2c,d=a.oa().Ww(a.C.getElement());eh(d,c.fva,b);b&&a.C.Cr().select()}
function z2c(a){switch(a){case 1:return"Please enter a valid number or formula";case 2:return"Please enter a valid range";case 3:return"Please enter a valid range";case 4:return"The selected ranges cannot intersect";case 5:return"Please enter a valid list of items";case 6:return"Please enter valid text";case 7:return"Please enter a valid date";case 8:return"Please enter a valid checked value.";case 9:return"Enter different values for checked and unchecked cell contents.";case 10:return"Formulas are not permitted as custom checked/unchecked values."}return null}
function A2c(a){var b=a.F,c=o_(b);if(0==c){c=b.L;var d=b.ea,e=g2c(b,c),f=g2c(b,d);e&&f?b.D.Cl=0:(e||n_(c),f||n_(d),b.D.Cl=1)}else if(1==c)c=b.O,d=b.qa,e=!Kh(c)||!Jb(Yb(c.value)),f=!Kh(d)||!Jb(Yb(d.value)),e&&f?b.D.Cl=0:(e||n_(c),f||n_(d),b.D.Cl=6);else if(2==c)c=b.H,d=b.V,e=!Kh(c)||!Jb(Yb(c.value)),f=!Kh(d)||!Jb(Yb(d.value)),e&&f?b.D.Cl=0:(e||n_(c),f||n_(d),b.D.Cl=7);else if(3==c||4==c)c=0,4==o_(b)?(d=l2c(b),CU(b.Ob,d)?(d=l2c(b),d=DU(b.Ob,d),e=h2c(b.D),null!=d&&null!=e&&d.ud==e.ud&&d.rect.intersects(e.rect)&&
(c=4)):c=3):3==o_(b)&&b.C.getElement()&&Jb(Yb(b.C.Ma()))&&(c=5),d=c,c=0==d,b.D.Cl=d,d=b.kb&&Kh(b.kb),b.Ta&&Kh(b.Ta)?(eh(b.C.getElement(),"waffle-input-error",!c),b.C.getElement().select()):d&&(d=b.D.oa().Ww(b.Ja.getElement()),eh(d,"waffle-input-error",!c),b.Ja.focus()),c?b.dispatchEvent("change"):b.dispatchEvent("error");else if(6==c){if(b.Oa.isChecked()){c=b.Na;e=b.Ra;d=Lb(Yb(c.value));e=Lb(Yb(e.value));f="true"==d.toLowerCase()&&"true"==e.toLowerCase()||"false"==d.toLowerCase()&&"false"==e.toLowerCase();
var h=ec(d)==ec(e);f=d==e||h||f;Jb(d)?(n_(c),b.D.Cl=8):f?b.D.Cl=9:QM(d)||QM(e)?b.D.Cl=10:b.D.Cl=0}}else b.D.Cl=0;b=a.C.Ma();b=CU(a.Aa,b);2==a.Cl&&b?a.Cl=0:0!=a.Cl||b||(a.Cl=2);u2c(a);return 0!=a.Cl}
function y2c(a){if(A2c(a))return!1;var b=a.F,c=b.zd.isChecked("rejectInvalidData_radio"),d=b2c(b);b.Bb.isChecked()||(d="");var e=k2c(b);if(!e)return!1;var f=new Xx;X(f,1,e);X(f,2,d);X(f,3,c);cuc(f,Kh(b.Db)&&b.jb.isChecked());b=w2c(a);if(!b)return!1;c=new hg;e=W(e,1);d=a.qa&&Jw(a.qa)==Jw(e);var h=Kw(e);if(d){var k=Kw(a.qa);k=k.length==h.length&&k.every(function(a,b){return a.equals(h[b])});H(c,12,!k);Xtc(c,sBc(Jw(e)))}k=ja(a.$b);for(var l=k.next();!l.done;l=k.next())y1c(c,sBc(Jw(l.value)));k=Ha()-
a.Ob;H(c,14,1E3*k);k=new fg;Zf(k,58,c);c=jj(kj(new ij,k),1).build();a.Bb.Xb(d?35578:35301,c);31==Jw(e)&&a.Bb.Xb(0<h.length?35604:35603,c);a.Mc.C(new FS(f,b));return!0}function w2c(a){var b=a.C.Ma();b=(b=DU(a.Aa,b))?b.rect:null;var c=a.C.Ma();a=(a=DU(a.Aa,c))?a.ud:null;return b&&null!=a?qA(b,a):null}function h2c(a){var b=a.C.Ma();return DU(a.Aa,b)}
function U1c(a,b){var c=a.kb.C.pe();c=new jW(a.Ac,v(a.qZb,a),!1,"e.g., Sheet1!A2:D5",!0,c,a.oa());a.getHandler().R(c,"change",function(){var a=this.F;a&&e2c(a)});c.render(b);return c}p.setVisible=function(a){p2c.ma.setVisible.call(this,a);a&&this.Ta&&(this.Ta.focus(),this.Ta=null)};p.qZb=function(a,b,c,d){this.Ta=a.Cr();this.Zc.xba(this,a,b,c,!1,!0,d)};
p.show=function(a){var b="",c=!1,d=zK(this.kb),e=XH(zI(d,EI(d)));d=null;var f=!1;e&&(e=e.C,d=W(e,1),b=W(e,2),c=W(e,3),f=W(e,4));m2c(this.F,d,b,c,f);this.setVisible(!0);this.C&&this.C.Pa(!0);s2c(this);f2c(this.F);this.Ra&&!a&&(Htc(this.jb)?(juc(this.jb),uuc(this.jb,!0,!1,[6])):(rW(this.Oa,!1),L(this.wb.Da,!1),v2c(this)));this.Ob=Ha()};p.Fa=function(){D(this.F);this.F=null;D(this.C);this.L=this.O=this.C=null;p2c.ma.Fa.call(this)};function B2c(a,b,c,d,e){mp.call(this);this.Mc=d.O;this.Ta=c;this.jb=d.C;this.Oa=d;this.$b=e;this.Ua=null;this.Bb=d.V;np(this,"Find and replace");up(this,!1);c=this.Ib();d=Kd(c);this.C=d.xa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.C.value=a;this.Aa=d.xa("INPUT",{"class":"jfk-textinput",style:"width: 20em;"});this.F=new ON(null);this.Zc=b;this.O=new jW(this.Ta,v(this.YZb,this),!1,"",!0);this.ea=null;this.qa=new qq;this.Ra=new qq;this.L=new qq;this.J=new qq;this.Ob=this.wb=this.Ab=
this.Db=!1;this.kb=d.xa("SPAN");iwc(this.kb);this.Ac=new Aq(this.C);this.va(this.Ac);a=C2c;d.xa("LABEL",{"for":a.Lua},"Search");b=d.xa("LABEL",{"for":a.Lva},"Match case");e=d.xa("LABEL",{"for":a.Mva},"Match entire cell contents");var f=d.xa("LABEL",{},"Also search within formulas"),h=d.xa("LABEL",{"for":a.vxa},"Search using regular expressions "),k=(new Vk(o0a)).toString(),l=d.xa("SPAN",null,d.xa("A",{target:"_blank",href:k},"Help"));this.getHandler().R(l,["keydown","keypress"],function(a){13==a.keyCode&&
a.stopPropagation()});k=Uh(this,"findLabel");var m=Uh(this,"replaceLabel"),q=Uh(this,"findScopeLabel"),t=d.xa("DIV","goog-inline-block"),w=d.xa("DIV",a.p2a);l=d.xa("TABLE",null,d.xa("TBODY",null,d.xa("TR",null,d.xa("TD",a.LABEL,d.xa("LABEL",{id:k},"Find")),d.xa("TD",null,this.C)),d.xa("TR",null,d.xa("TD",a.LABEL,d.xa("LABEL",{id:m},"Replace with")),d.xa("TD",null,this.Aa)),d.xa("TR",null,d.xa("TD",null,d.xa("LABEL",{id:q},"Search")),d.xa("TD",null,t,w)),d.xa("TR",null,d.xa("TD",null,""),d.xa("TD",
null,b,d.xa("BR"),e,d.xa("BR"),h,l,d.xa("BR"),f)),d.xa("TR",null,d.xa("TD",{colspan:"2"},this.kb))));this.F.render(t);ah(this.F.getElement(),a.Lua);this.O.render(w);Th(this.qa,b);Vp(this.qa,b);this.qa.getElement().id=a.Lva;Th(this.Ra,e);Vp(this.Ra,e);this.Ra.getElement().id=a.Mva;Th(this.L,h);Vp(this.L,h);this.L.getElement().id=a.vxa;Vp(this.J,f);Th(this.J,f);Zh(this.C,"labelledby",k);Zh(this.Aa,"labelledby",m);Zh(this.F.Da,"labelledby",q);d.appendChild(c,l);c=new vp;c.set("findNext","Find",!0);c.set("replace",
"Replace");c.set("replaceAll","Replace all");c.set("done","Done",!1,!0);yp(this,c);yq(this,"");this.getHandler().R(this,"dialogselect",this.ZZb).R(this.Ac,"input",this.mma).R(this.L,"change",this.JCb).R(this.F,"change",this.etb).R(this.O,"change",this.$Zb).R(this.J,"change",this.KCb);c=new Bq;c.Va(this.C);this.va(c);c=new Bq;c.Va(this.Aa);this.va(c);D2c(this);c=new kp(this.getElement());this.va(c);this.getHandler().R(c,"focusin",this.fWa).R(this.getElement(),"mousedown",this.fWa)}y(B2c,mp);
var C2c={rta:"waffle-find-replace-dialog-border",Lua:"waffle-find-replace-find-scope-select",fva:"waffle-input-error",LABEL:"waffle-find-replace-dialog-label",Lva:"find-replace-case",Mva:"find-replace-cell",vxa:"find-replace-regex",p2a:"waffle-find-replace-selection-input goog-inline-block"};
function D2c(a){var b=IG(a.Ta),c=null,d=null;b&&(c=PJb(b),d=YF(a.jb,c.ud).pe());a.J.Ec(a.Bb);var e=new hk("All sheets",g8a.bXa),f=new hk("This sheet",g8a.z2a),h=new hk("Specific range",g8a.mI);a.F.Pd(e);a.F.Pd(f);a.F.Pd(h);f=c?bJ(a.jb,c.ud):null;f=(f=c&&f?nI(f,c.rect.yc(),c.rect.rc()):null)?f.kh():1;c&&c.rect.kh()>f?Br(a.F,h):Br(a.F,e);b&&a.O.Qa(RF(c.rect,d))}function E2c(a){var b=a.F.jf().Sa(),c=WI(a.Ta.C);return 0==b?PF(a.O.Ma(),a.jb,!1,!0):1!=b||null===c?null:new kA(c,"",new Tz(0,0,1,1))}p=B2c.prototype;
p.fWa=function(a){a.target==this.getElement()?this.focus():this.$b.Cb(2)};p.$Zb=function(){F2c(this)};p.KCb=function(){var a=this.J.isChecked();V$b(this.Oa,a)};p.etb=function(){F2c(this)};p.JCb=function(){this.L.isChecked()&&this.qa.Ec(!0);this.mma()};
p.ZZb=function(a){var b=G2c;if("findNext"==a.key)a.preventDefault(),this.Db&&(r_(this,null),H2c(this,b.Kua));else if("replace"==a.key)a.preventDefault(),this.Ab&&(r_(this,null),H2c(this,b.Kwa));else if("replaceAll"==a.key&&(a.preventDefault(),this.Ob)){a=v(function(){r_(this,null);H2c(this,b.Jwa)},this);var c=this.F.jf().Sa();1<this.jb.D.length&&2==c&&!this.wb?(Ctc("Replace in all sheets?","This will replace values on all sheets. Are you sure?",a,null),this.wb=!0):a()}};
p.mma=function(){var a=0==this.C.value.length,b=this.L.isChecked()&&!ritz_api.RitzModelApi.isValidRegex(this.C.value);a=!a&&!b;zp(this.D,"findNext").disabled=!a;this.Db=a;I2c(this,a);this.Ab&&!a&&J2c(this,!1);eh(this.C,"waffle-input-error",b)};p.YZb=function(a,b,c){this.Ua=a.Cr();this.Zc.xba(this,a,b,c,!1,!0)};
function F2c(a){var b=0==a.F.jf().Sa();a.O.setVisible(b);D(a.ea);a.ea=null;var c=E2c(a),d=IG(a.Ta);b&&d&&c&&(a.ea=CN(d,c.rect,"waffle-find-replace-dialog-border",2,1),a.ea.setVisible(!0),a.va(a.ea))}function H2c(a,b){if(0==a.F.jf().Sa()&&null==E2c(a))eh(a.O.D,"waffle-range-selection-error",!0),r_(a,"Invalid range");else{var c=a.F.jf().Sa();a.dispatchEvent(new K2c(b,a.C.value,a.Aa.value,c,a.qa.isChecked(),a.Ra.isChecked(),a.L.isChecked(),a.J.isChecked(),E2c(a)))}}
p.setVisible=function(a){var b=this.Oa.Gd();I2c(this,!b);J2c(this,!b);this.Aa.disabled=b;B2c.ma.setVisible.call(this,a);a&&this.Ua&&(this.Ua.focus(),this.Ua=null)};p.HUb=function(a){this.C.value=a};p.uSa=function(){this.C.select()};p.focus=function(){this.Wb()&&this.isVisible()&&(this.C.focus(),this.$b.Cb(2),Bs(this.C,this.C.value.length),this.mma())};function J2c(a,b,c){b=b&&!a.Oa.Gd()&&0==!a.C.value.length;a.Ab=b;a=zp(a.D,"replace");a.disabled=!b;c?a.title=c:a.removeAttribute("title")}
function I2c(a,b){var c=!!ab(Gkb(a.Mc),function(a){return!a.Bj()});b=b&&!a.Oa.Gd()&&!c&&0==!a.C.value.length;a.Ob=b;a=zp(a.D,"replaceAll");a.disabled=!b;c&&(a.title="This is disabled because there are protected cells in this spreadsheet.")}function r_(a,b){var c=Kd(a.Ib());a=a.kb;b?(0<je(a).length&&c.appendChild(a,c.xa("BR")),c.appendChild(a,c.xa("B",null,Ce(c,b)))):c.Id(a)}p.Fa=function(){B2c.ma.Fa.call(this);this.wb=!1;V$b(this.Oa,this.Bb)};
function K2c(a,b,c,d,e,f,h,k,l){E.call(this,a);this.F=b;this.J=c;this.C=d;this.V=e;this.$=f;this.Aa=h;this.Ga=k;this.Ja=l||null}y(K2c,E);var G2c={Kua:"findnext",Tec:"findall",Kwa:"replace",Jwa:"replaceall",DONE:"done",e7b:"canceled"};function L2c(a,b,c,d,e){B.call(this);var f=G2c;this.H=null;this.C=a;this.D=b;this.F=c;this.O=d;this.L=e;this.J=new hh(this);this.va(this.J);this.J.R(a,f.Jwa,this.QBb).R(a,f.Kwa,this.RBb).R(a,f.Kua,this.eWa).R(a,f.DONE,this.frb)}y(L2c,B);var s_={yN:"cg",zN:"cr",xN:"cc",Jua:"loop"};p=L2c.prototype;p.JWb=function(){this.C.setVisible(!0);M2c(this,null)};p.eWa=function(a){if(JG(this.D.C)){var b=IG(this.D).Sa(),c=this.H;c||(c=EI(b),c=Dc(s_.yN,b.kc(),s_.zN,OI(b,c.y),s_.xN,PI(b,c.x)));N2c(this,a,b,c)}};
function N2c(a,b,c,d){var e=new dw,f=O2c(b);P2c(f,c,d);c=e.serialize(f);a=v(function(a){var c=e.xd((new j8a).Ca(),a);a=W(f,1);var d=b.type;JG(this.D.C)&&(c?Uv(c,1)?(d=W(c,1),c=Dc(s_.yN,parseInt(d.yb(),10),s_.zN,d.Tq(),s_.xN,d.getColumnIndex(),s_.Jua,W(c,2)),Q2c(this,a,c)):(Q2c(this,a,{}),"replace"==d&&this.C.focus()):R2c(this))},a);ritz_api.RitzModelApi.findNext(c,a)}function P2c(a,b,c){if(c){var d=""+c[s_.yN],e=new Vx;X(e,1,d);X(e,2,Tib(b,c[s_.zN],"r"));X(e,3,Tib(b,c[s_.xN],"c"));X(a,10,e)}}
function O2c(a){var b=new uE;X(b,1,a.F);X(b,3,a.J);X(b,5,a.C);if(0==a.C||1==a.C){var c=a.Ja,d=new uw;X(d,1,""+c.ud);var e=c.rect.yc();X(d,2,e);vw(d,c.rect.Uc());d.Gu(c.rect.rc());d.Rx(c.rect.Wc());b.setSelection(d)}X(b,6,a.V||!1);X(b,7,a.$||!1);X(b,8,a.Aa||!1);b.setType(a.Ga?1:0);X(b,11,0);return b}function Q2c(a,b,c){c?c&&null!=c.cg?(b=c[s_.yN],c[s_.Jua]&&r_(a.C,"No more results found, looping around"),a.F.zA(b,v(a.XZb,a,c))):(M2c(a,null),r_(a.C,"There are no entries matching "+b)):R2c(a)}
p.XZb=function(a){var b=IG(this.D).Sa(),c=a[s_.zN],d=a[s_.xN];a[s_.zN]=OI(b,c);a[s_.xN]=PI(b,d);M2c(this,a);a=new Dd(d,c);b=new kA(b.kc(),"",Vz(a));EU(this.F,b,v(this.K4a,this,a))};
p.K4a=function(a){if(!this.isDisposed()){this.C.focus();var b=IG(this.D).Sa();UH(b.Qf(a.y,a.x))&&!this.C.J.isChecked()&&J2c(this.C,!1,"Can't replace formula");var c=pI(b,a.y),d=qI(b,a.x);!c||!d||c.isVisible()&&d.isVisible()||(c=this.C,d=QF(a),a=PH(zI(b,a)),r_(c,"A match was found in hidden cell "+(d+(' with value "'+(a+'".')))))}};function R2c(a){r_(a.C,null);r_(a.C,"Error while searching spreadsheet. Please try again.")}
p.RBb=function(a){if(!this.L.Gd()){var b=this.H;if(b){var c=QH(this.F,b[s_.yN]);if(c){c=c.Nc();var d=Tib(c,b[s_.zN],"r"),e=Tib(c,b[s_.xN],"c"),f=c.Qf(d,e);if(!UH(f)||this.C.J.isChecked()){f=PH(f);var h=new dw,k=O2c(a);X(k,5,0);P2c(k,c,b);var l=new uw;X(l,1,""+b[s_.yN]);X(l,2,d);vw(l,d+1);l.Gu(e);l.Rx(e+1);k.setSelection(l);b=h.serialize(k);b=ritz_api.RitzModelApi.getReplaceResult(b);S2c(this,c,k,f,b,!1);this.eWa(a)}}}}};
p.QBb=function(a){if(!this.L.Gd()&&JG(this.D.C)){var b=this.F.getActiveGrid().Nc(),c=O2c(a);S2c(this,b,c,a.F,a.J,!0)}};
function S2c(a,b,c,d,e,f){b=new dX(b,c);UF(b,v(function(a,b){a?(a=W(b,5),b=W(b,4),b=0==a?"No matches found":f?(new lt(1==b?"{NUM_CHANGED, plural,=0 {unused plural form}=1 {Replaced one instance of {ORIGINAL_VALUE} with {NEW_VALUE}}other {Replaced # instances of {ORIGINAL_VALUE} with {NEW_VALUE}}}":"{NUM_SHEETS, plural,=0 {unused plural form}=1 {unused plural form}other {Replaced {NUM_CHANGED} instances of {ORIGINAL_VALUE} with {NEW_VALUE} across # sheets}}")).format({NUM_CHANGED:a,NUM_SHEETS:b,ORIGINAL_VALUE:d,
NEW_VALUE:e}):'Replaced "'+(d+('" with "'+(e+'"'))),r_(this.C,null),r_(this.C,b)):R2c(this)},a));r_(a.C,null);r_(a.C,"Working...");a.O.C(b)}p.frb=function(){M2c(this,null)};function M2c(a,b){a.H=b;(a=a.C)&&J2c(a,null!=b)};function T2c(a){a=a||{};var b=a.type;return R('<input class="'+T("jfk-textinput")+(a.Ed?" "+T(a.Ed):"")+'"'+(a.id?' id="'+T(a.id)+'"':"")+(a.maxLength?' maxlength="'+T(a.maxLength)+'"':"")+(a.k$&&a.iYb?' label="'+T(a.k$)+'"':"")+(a.name?' name="'+T(a.name)+'"':"")+(a.k$?' placeholder="'+T(a.k$)+'"':"")+' type="'+T(null!=b?b:"text")+'"'+(a.pattern?' pattern="'+T(a.pattern)+'"':"")+(a.value?' value="'+T(a.value)+'"':"")+(a.dir?' dir="'+T(a.dir)+'"':"")+(a.attributes?" "+kq(a.attributes):"")+">")};function U2c(a){a=""+(""+V2c({id:"waffle-resize-selection-custom",BNa:a.wga,Tk:gq("<br/>"+Q(T2c({id:"waffle-resize-input",Ed:"waffle-resize-inset-input"})))})+V2c({id:"waffle-resize-selection-auto",BNa:bq("Fit to data"),Tk:gq("")})+"");return R(a)}function V2c(a){return R('<div class="waffle-resize-option"><input type="radio" name="waffle-resize-selection" id="'+T(a.id)+'"><label for="'+T(a.id)+'" class="waffle-resize-label">'+Q(a.BNa)+"</label>"+Q(a.Tk)+"</div>")}
function W2c(a){var b=a.kfb;a='<label for="waffle-resize-input">'+Q(a.wga)+'</label><br/><br/><input id="waffle-resize-input"/>';b&&(a+='<br/><br/><span class="waffle-resize-dialog-checkbox"><span id="waffle-resize-rows-can-grow-checkbox">Allow row heights to grow automatically to fit cell contents.</span></span>');return R(a+"")};function X2c(a,b,c,d,e){mp.call(this);this.L=a;this.Aa=b;var f=this.L.Qc().ld();this.C=f;this.F=Va(this.L.Dj(),function(a){return a.ld()==f});this.J=new xS;this.O=new jDc(!0);this.ea=new qq;this.Oa=c;this.Ra=d;this.qa=e}y(X2c,mp);var Y2c={AUTO:"waffle-resize-selection-auto",Dr:"waffle-resize-selection-custom",Dca:"waffle-resize-input",d1a:"waffle-resize-selection",i2a:"waffle-resize-rows-can-grow-checkbox"};p=X2c.prototype;
p.xa=function(){X2c.ma.xa.call(this);var a=this.F[0];if("r"==this.C){var b=a.yc();a=a.Uc()-1;var c=String(HF(b+1)),d=String(HF(a+1));b=1<this.F.length?"Resize selected rows":b==a?"Resize row "+c:"Resize rows "+(c+(" - "+d))}else b=a.rc(),a=a.Wc()-1,c=JF(b),b=1<this.F.length?"Resize selected columns":b==a?"Resize column "+c:"Resize columns "+(c+(" - "+JF(a)));np(this,b);"r"==this.C?this.Ib().appendChild(P(W2c,{wga:Z2c(this),kfb:J(I(),"fefrha")})):this.Ib().appendChild(P(U2c,{wga:Z2c(this)}));yq(this,
"ok")};p.Ia=function(){X2c.ma.Ia.call(this);var a=this.oa(),b="r"==this.C;this.J.Va(a.getElement(Y2c.Dca));J(I(),"fefrha")&&b&&(a=a.getElement(Y2c.i2a),Vp(this.ea,a),Th(this.ea,a));a=this.L.Qc();var c=a.ld();a=$cb(xI(this.L,c,bA(a,c)));this.J.Qa(String(a));b||(kDc(this.O,Y2c.d1a),lDc(this.O,Y2c.Dr));this.getHandler().R(this,"dialogselect",this.r0b).R(this.J.getElement(),"focus",this.FGb)};p.FGb=function(){"c"==this.C&&lDc(this.O,Y2c.Dr)};p.focus=function(){this.Wb()&&BS(this.J)};
function Z2c(a){return"r"==a.C?"Enter new row height in pixels. (Default: "+(hI+")"):"Enter new column width in pixels. (Default: "+(bdb+")")}
p.r0b=function(a){if("ok"==a.key)if((a="r"==this.C)||mDc(this.O)==Y2c.Dr){var b=parseInt(this.J.Ma(),10);isNaN(b)?eB("Entered value is not a number."):2>b||2E3<b?eB("Size must be between 2 and 2000 pixels."):(this.qa.C("r"==this.C?35310:35308),b=new BL(this.L,this.F[0],b,this.F.slice(1)),J(I(),"fefrha")&&a&&(a=!this.ea.isChecked(),b.L=a),this.Aa.C(b))}else b=IG(this.Oa).$,a=b.H,b=J(I(),"fecllr")?b.D:null,this.qa.C(35307),sYb(this.F,a,b,this.Ra,this.Aa)};function $2c(a){Sf(this,a,0,-1,null,null)}y($2c,Rf);$2c.prototype.getType=function(){return G(this,3)};$2c.prototype.setType=function(a){H(this,3,a)};function a3c(a){N.call(this,a);this.$=RA("email");this.C=this.D=null}y(a3c,N);p=a3c.prototype;
p.xa=function(){var a=this.oa();var b=this.oa();this.C=new TV;this.va(this.C);this.D=new TV;this.va(this.D);var c=b.xa("DIV","waffle-dialog-notifications-input");Yh(c,"presentation");this.F=new RV;SV(this.F,b.xa("LABEL",null,"Any changes are made"));this.F.render(c);this.C.xG(this.F);var d=b.xa("DIV","waffle-dialog-notifications-input");Yh(d,"presentation");this.J=new RV;SV(this.J,b.xa("LABEL",null,"A user submits a form"));this.J.render(d);this.C.xG(this.J);var e=b.xa("DIV","waffle-dialog-notifications-input");
Yh(e,"presentation");this.H=new RV;SV(this.H,b.xa("LABEL",null,"Email - daily digest"));this.H.render(e);this.D.xG(this.H);var f=b.xa("DIV","waffle-dialog-notifications-input");Yh(f,"presentation");this.L=new RV;SV(this.L,b.xa("LABEL",null,"Email - right away"));this.L.render(f);this.D.xG(this.L);b=b.xa("DIV",null,b.xa("DIV","waffle-dialog-notifications-toplabel","Notify me at "+(this.$+" when...")),b.xa("DIV",{role:"radiogroup","aria-label":"Notify me at "+(this.$+" when...")},c,d),b.xa("DIV",{style:"padding: 5px"}),
b.xa("DIV","waffle-dialog-notifications-label","Notify me with..."),b.xa("DIV",{role:"radiogroup","aria-label":"Notify me with..."},e,f));c=this.oa();d=c.xa("DIV");this.O=iS("Save",c);this.Ha(this.O,!1);this.O.render(d);this.V=new mr("Cancel",c);this.Ha(this.V,!1);this.V.render(d);this.Da=a.xa("DIV","waffle-dialog-notifications",a.xa("DIV",null,b),a.xa("DIV",null,d))};
p.Ia=function(){a3c.ma.Ia.call(this);this.getHandler().R(this.O,"action",this.RTb,!0).R(this.V,"action",v(this.dispatchEvent,this,new E("cancelRuleEdit"))).R(this.C,"change",this.ksa).R(this.D,"change",this.ksa)};p.Jd=function(a){a3c.ma.Jd.call(this,a);a?1==a.getType()?UV(this.C,this.F):2==a.getType()&&UV(this.C,this.J):UV(this.C,null);a?2==G(a,2)?UV(this.D,this.H):1==G(a,2)&&UV(this.D,this.L):UV(this.D,null);this.ksa()};p.focus=function(){var a=VV(this.C),b=this.C.C.Se(0);(a||b).getElement().focus()};
p.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};p.RTb=function(){this.dispatchEvent(new E("saveRule",b3c(this)))};function b3c(a){var b=new $2c,c=a.Sa();c&&(c=G(c,1),H(b,1,c));a.F.isChecked()?b.setType(1):a.J.isChecked()&&b.setType(2);a.L.isChecked()?H(b,2,1):a.H.isChecked()&&H(b,2,2);return b}p.ksa=function(){var a=(this.F.isChecked()||this.J.isChecked())&&(this.L.isChecked()||this.H.isChecked());this.O.Pa(a)};function c3c(a){return R("<div><div>"+Q(a.c7a)+"</div>"+Q(pq({id:"waffle-confirm-suppress-checkbox",Ed:"waffle-confirm-suppress-checkbox"},void 0))+'<span id="waffle-confirm-suppress-label">'+Q(a.kra)+"</span></div>")};function d3c(a,b,c,d,e,f,h){if(Ca(c)){var k=new vp;k.set("ok",c.ok,!0);k.set("cancel",c.cancel,!1,!0)}else k=zza;return e3c(d||"Heads up!",a,b,k,e,f,h)}function e3c(a,b,c,d,e,f,h){b=nd(b);if(f){b=Pp(c3c({c7a:b,kra:f}));var k=new qq;var l=c;c=function(){l(k.isChecked())}}a=HAa(a,b,c,e||null,void 0,void 0,d,h);k&&(a.Ha(k),k.Va(ye(a.oa(),"waffle-confirm-suppress-checkbox")),c=ye(a.oa(),"waffle-confirm-suppress-label"),Vp(k,c),k.Ec(!1));return a};function t_(a,b){N.call(this,b);this.Jd(a)}y(t_,N);
t_.prototype.xa=function(){var a=this.Sa(),b="";1==a.getType()?b="any changes are made":2==a.getType()&&(b="form submitted");var c="";2==G(a,2)?c+="send digest email":1==G(a,2)&&(c+="send email");c="If "+(b+(" then "+c));var d=this.oa();a=d.xa("TD",null);b=d.xa("TD",{width:"50px"});c=d.xa("TR",{valign:"center"},d.xa("TD",null,d.xa("SPAN","waffle-notification-rule",c)),d.xa("TD",{align:"right"},d.xa("TABLE",null,d.xa("TBODY",null,d.xa("TR",null,a,b)))));d=gi(ir,"waffle-notifications-add");this.D=new kr("Edit",
d,this.oa());this.D.Re("goog-link-button");this.D.Re("menuMainLink");this.Ha(this.D,!1);this.D.render(a);this.C=new kr("Delete",d,this.oa());this.C.Re("goog-link-button");this.C.Re("menuMainLink");this.Ha(this.C,!1);this.C.render(b);this.Da=c};t_.prototype.Ia=function(){t_.ma.Ia.call(this);this.getHandler().R(this.D,"action",this.H);this.getHandler().R(this.C,"action",this.F)};t_.prototype.H=function(){this.dispatchEvent(new E("edit",this.Sa()))};
t_.prototype.F=function(){var a=v(function(){this.dispatchEvent(new E("del",this.Sa()))},this),b=v(function(){this.C.getElement().focus()},this);d3c("Are you sure you want to delete this notification rule?",a,void 0,void 0,b)};function f3c(a){N.call(this,a);this.C=null}y(f3c,N);f3c.prototype.xa=function(){var a=this.oa();this.C=a.xa("TBODY");this.Da=a.xa("TABLE",{className:"waffle-dialog-notifications-list",width:"100%"},this.C)};f3c.prototype.Ib=g("C");f3c.prototype.setVisible=function(a){this.getElement()&&L(this.getElement(),a)};function g3c(a,b,c){mp.call(this);this.L=b;np(this,"Set notification rules");up(this,!1);a=new vp;a.set("cancel","Done",!1,!0);yp(this,a);this.C=new a3c(c);this.Ha(this.C,!1);this.F=new f3c;this.Ha(this.F,!1);this.J=new kr("Add another notification rule",yP.getInstance(),this.oa());this.Ha(this.J,!1)}y(g3c,mp);p=g3c.prototype;
p.xa=function(){g3c.ma.xa.call(this);var a=this.oa(),b=Mob(new Vk(l0a+"91588")).toString();b=a.xa("A",{target:"_blank",href:b},"Help");var c=a.xa("DIV");this.J.render(c);this.ea=a.xa("DIV");this.O=a.xa("DIV");var d=a.xa("DIV","waffle-dialog-notifications-bounds",this.ea,this.O);b=a.xa("DIV",null,a.xa("DIV",{align:"right"},b),d,c);a.appendChild(this.Ib(),b);yq(this,"")};
p.Ia=function(){g3c.ma.Ia.call(this);this.F.render(this.ea);this.C.render(this.O);this.getHandler().R(this,"edit",this.A0b).R(this,"del",this.z0b).R(this.J,"action",this.y0b).R(this,"saveRule",this.QTb).R(this,"cancelRuleEdit",this.k6a)};p.s_=function(a){this.isDisposed()||(this.C.setVisible(!1),h3c(this,!1),vA(this.L,"/notifications/list",v(this.SXb,this,a)).ue())};
p.SXb=function(a,b,c){if(!this.isDisposed()){b=c.Xe();c=[];for(var d=0;d<b.length;d++)c[d]=new $2c(b[d]);this.Jd(c);if(a&&0==c.length)i3c(this,null,!1);else{if(a=this.Sa())if(b=this.F,b.Id(!0),b.oa().Id(b.Ib()),b.Jd(a),c=b.oa(),0==a.length)c.appendChild(b.Ib(),c.xa("TR",null,c.xa("TD",{align:"center"},"No notification rules currently defined")));else for(d=0;d<a.length;d++)b.Ha(new t_(a[d],c),!0);h3c(this,!0);this.focus()}}};
p.QTb=function(a){this.C.setVisible(!1);a=a.target;var b=a.serialize();G(a,1)?Dq(vA(this.L,"/notifications/set",v(this.s_,this,!1)),{rule:b}).ue():Dq(vA(this.L,"/notifications/create",v(this.s_,this,!1)),{rule:b}).ue()};p.k6a=function(){this.C.setVisible(!1);this.s_(!1)};p.A0b=function(a){i3c(this,a?a.target:null,!0)};p.y0b=function(){i3c(this,null,!0)};function i3c(a,b,c){h3c(a,!1);var d=a.C;d.Jd(b);d.setVisible(!0);c&&a.C.focus()}
p.z0b=function(a){this.F.setVisible(!1);a=a.target;Dq(vA(this.L,"/notifications/delete",v(this.s_,this,!1)),{rule_id:G(a,1)}).ue()};function h3c(a,b){a.F.setVisible(b);var c=rp(a);L(c,b);a.J.setVisible(b)}p.show=function(){this.setVisible(!0);this.s_(!0)};function j3c(a,b,c){b=c||b;c="";var d='<span id="ds-settings-link-desc">Display language: </span><a aria-labelledby="ds-settings-link-desc ds-settings-link" id="ds-settings-link" target="_blank">'+(Q(a.r8a)+"</a>");c+='<tr class="dialog-settings-general-settings-div"><div>'+d+"</div>";a.GVb&&(c+='<div class="dialog-settings-english-name-div">'+Q(pq({id:"waffle-settings-dialog-english-name-checkbox"},b))+'<label for="waffle-settings-dialog-english-name-checkbox" id="waffle-settings-dialog-english-name-checkbox-label">Always use English function names</label></div>');
return R(c+"</tr>")}function k3c(){return R('<div id="spreadsheet-settings-tab-bar" class="spreadsheet-settings-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="general-settings-tab" class="spreadsheet-settings-tab goog-tab goog-tab-selected">General</div><div id="calculation-settings-tab" class="spreadsheet-settings-tab goog-tab">Calculation</div></div>')};function u_(a,b,c,d){mp.call(this);this.Db=a;this.Zc=b;this.ea=c;this.Ac=d;this.C={};this.Ab=this.jb=!1;this.$b=this.Bb=this.wb="";this.Mc=new dw;this.J=[];this.F=this.Mc.xd((new nx).Ca(),ritz_api.RitzModelApi.getWorkbookProperties());np(this,"Settings for this spreadsheet");this.Ua=!1;this.Ra=new qq;this.Ha(this.Ra);this.O=new WU;this.Ha(this.O);this.L=new WU;this.Ha(this.L);this.kb=new nV;this.Ha(this.kb);this.Oa=this.Ta=null;this.Ob=new it(1);this.qa=this.Aa="";this.C[0]=l_();this.C[1]=l_();this.C[2]=
l_();this.C[3]=l_();this.C[4]=new xS;this.C[5]=new xS}y(u_,mp);var l3c=null,m3c={k2:0,y3a:1,nXa:2,V_a:3,m0a:4,oYa:5},n3c={Z3a:"waffle-settings-dialog-english-name-checkbox",$3a:"waffle-settings-dialog-english-name-checkbox-label"},o3c=[{value:"",caption:"On change"},{value:"60000",caption:"On change and every minute"},{value:"3600000",caption:"On change and every hour"}],p3c=[{value:"ON",caption:"On"},{value:"OFF",caption:"Off"}];p=u_.prototype;
p.xa=function(){u_.ma.xa.call(this);var a=this.Ib(),b=this.oa(),c=[q3c(b,"Locale","waffle-settings-label-locale"),r3c(this,b,"This affects formatting details such as functions, dates, and currency.",0,"waffle-settings-label-locale","waffle-settings-description-locale"),s3c(this),q3c(b,"Time zone","waffle-settings-label-timezone"),r3c(this,b,"Your spreadsheet's history will be recorded in this time zone. This will affect all time-related functions.",1,"waffle-settings-label-timezone","waffle-settings-description-timezone"),
s3c(this)],d=[];d.push(q3c(b,"Recalculation","waffle-settings-label-autorecalc"));d.push(r3c(this,b,"This affects how often NOW, TODAY, RAND, and RANDBETWEEN are updated.",2,"waffle-settings-label-autorecalc","waffle-settings-description-autorecalc"));d.push(s3c(this));d.push(q3c(b,"Iterative calculation","waffle-settings-label-iterativecalc"));var e=Mob(new Vk(l0a+"58515")).toString();e=b.xa("A",{target:"_blank",href:e}," Learn more about iterative calculation.");d.push(r3c(this,b,"Determines whether formulas with circular references are resolved by iterative calculation.",
3,"waffle-settings-label-iterativecalc","waffle-settings-description-iterativecalc",e));e=q3c(b,"Max number of iterations","waffle-settings-label-maxiterations");d.push(e);this.J.push(e);e=r3c(this,b,"The maximum number of calculation rounds to perform during iterative calculation.",4,"waffle-settings-label-maxiterations","waffle-settings-description-maxiterations");t3c(e);d.push(e);this.J.push(e);e=q3c(b,"Threshold","waffle-settings-label-convergencethreshold");d.push(e);this.J.push(e);e=r3c(this,
b,"The threshold value such that calculation rounds stop when successive results differ by less.",5,"waffle-settings-label-convergencethreshold","waffle-settings-description-convergencethreshold");t3c(e);d.push(e);this.J.push(e);"OFF"==this.C[3].jf().Ma()&&u3c(this);d.push(s3c(this));c=mb(c,d);c.push(P(j3c,{r8a:this.Bb,GVb:this.Ua}));this.Ta=b.xa("TABLE","dialog-settings",b.xa("TBODY",null,c));this.Oa=b.xa("table","dialog-settings",b.xa("tbody",null,d));c=P(k3c);b.appendChild(a,c);this.kb.Va(c);b.appendChild(a,
this.Ta);b.appendChild(a,this.Oa);L(this.Oa,!1);l3c||(a=new vp(b),a.set("save","Save settings",!0),a.set("cancel","Cancel",!1,!0),l3c=a);yp(this,l3c);v3c(this,4,Uv(this.F,3)&&W(this.F,3).Z7()?W(this.F,3).U5().toString():"50");v3c(this,5,Uv(this.F,3)&&W(this.F,3).X7()?W(this.F,3).z5().toString():"0.05");yq(this,"save")};function t3c(a){a=a.firstChild.firstChild;ah(a,"jfk-textinput");ph(a,"width","7em")}function u3c(a){for(var b=0;b<a.J.length;b++)L(a.J[b],!1)}
function q3c(a,b,c){return a.xa("TR",null,a.xa("TD",{id:c,"class":"dialog-settings-label"},b))}function r3c(a,b,c,d,e,f,h){b=b.xa("TR",null,b.xa("TD","dialog-settings-input"),b.xa("TD",{id:f,"class":"dialog-settings-text"},c,h));a=a.C[d];a.render(b.firstChild);a=a.Da;Zh(a,"labelledby",e);Zh(a,"describedby",f);return b}function s3c(a){a=a.oa();return a.xa("TR",null,a.xa("TD",{colspan:2,"class":"dialog-settings-sep-td"},a.xa("HR",{"class":"dialog-settings-sep"})))}
p.Ia=function(){u_.ma.Ia.call(this);cf(this,"dialogselect",v(this.Q0b,this));this.getHandler().R(this.C[3],"action",this.WVb);this.getHandler().R(this.kb,"select",this.jFb);var a=this.C[4].getElement();this.O.wj(a);ZU(this.O,a,a);this.O.render();YU(this.O);this.getHandler().R(a,"change",v(this.nYb,this));a=this.C[5].getElement();this.L.wj(a);ZU(this.L,a);this.L.render();YU(this.L);this.getHandler().R(a,"change",v(this.mYb,this));if(this.Ua){a=this.oa().getElement(n3c.Z3a);var b=this.oa().getElement(n3c.$3a);
this.Ra.Va(a);Vp(this.Ra,b);this.Ra.Ec(!N0a||Gob(this.ea.F))}};p.setVisible=function(a){if(a){if(!this.jb){w3c(this);return}var b=this.ea.L;v3c(this,0,b.C);b=b.J||Yub().name();v3c(this,1,b);v3c(this,2,Uv(this.F,3)&&W(this.F,3).zla()?W(this.F,3).kia().toString():"");v3c(this,3,Uv(this.F,3)&&Uv(W(this.F,3),1)?W(W(this.F,3),1)?"ON":"OFF":"OFF")}u_.ma.setVisible.call(this,a);this.jb&&!this.Ab&&((a=Nd("ds-settings-link"))&&td(a,this.wb),this.Ab=!0)};
function w3c(a){Cq(a.Zc.Ke("/info/settings").Ef(x3c()),v(function(a){a=a.Xe();(a={locale:a.l?this.LJ(a.l):null,LUa:a.tz?this.LJ(a.tz):null,z8a:a.dls,lKb:a.dln,kYb:a.hl},a.locale)&&a.LUa&&(y3c(this,0,a.locale),y3c(this,1,a.LUa),y3c(this,2,o3c),y3c(this,3,p3c),this.wb=a.z8a,this.Bb=a.lKb,this.$b=a.kYb,this.Ua=N0a&&ritz_api.RitzModelApi.isFunctionLocalizationSupportedForLocale(this.$b),this.jb=!0);this.setVisible(!0)},a)).ue()}
function x3c(){var a=fl(RA("win").location.href),b=dl(a,"hl");a=dl(a,"forcehl");return["hl",b,"forcehl",a]}function y3c(a,b,c){a=a.C[b];b=c.length;for(var d=0;d<b;d++){var e=c[d];e=new hk(e.caption,e.value);a.Pd(e);e=e.getElement();Yh(e,"menuitem")}a.Bc().getElement().style.overflow="auto";SR(a,!0)}p.LJ=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];b.push({value:d[0],caption:d[1]})}return b};function v3c(a,b,c){(a=a.C[b])&&a.Qa(c)}
p.Q0b=function(a){if("save"==a.key)if("ON"!=this.C[3].jf().Ma()||""==this.Aa&&""==this.qa){z3c(this);a=this.ea.L.C;this.Db.C(A3c(this));this.Db.C(B3c(this));if(this.Ua){var b=!N0a||Gob(this.ea.F);var c=this.Ra.isChecked();b!=c?(Rob(this.ea,c),b=jj(new ij,1).build(),this.Ac.Xb(c?2433:2434,b),c=!0):c=!1}else c=!1;c||(c=this.C[0].jf(),c=null!=c&&c.Ma()!=a);c&&Xpa(this.ea.D.C,this.P0b)}else a.preventDefault(),z3c(this),""!=this.Aa&&XU(this.O,this.Aa,!0),""!=this.qa&&XU(this.L,this.qa,!0)};
p.WVb=function(a){if("ON"==a.target.Ma())for(a=0;a<this.J.length;a++)L(this.J[a],!0);else u3c(this);z3c(this)};function z3c(a){YU(a.O);YU(a.L)}p.nYb=function(){this.Aa="";var a=this.C[4].Ma()||"";a=this.Ob.parse(a);if(isNaN(a)||parseInt(a,10)!=a)this.Aa="Please enter an integer value.";else if(0>=a||1E4<a)this.Aa="Please enter a value between 1 and 10000."};p.mYb=function(){this.qa="";var a=this.C[5].Ma()||"";a=this.Ob.parse(a);isNaN(a)?this.qa="Please enter a numeric value.":0>a&&(this.qa="Please enter a non-negative value.")};
p.jFb=function(a){switch(a.target.getId()){case "general-settings-tab":L(this.Ta,!0);L(this.Oa,!1);break;case "calculation-settings-tab":L(this.Ta,!1),L(this.Oa,!0)}};function A3c(a){var b=a.C;var c=b[m3c.nXa].jf().Ma();var d=b[m3c.V_a].jf().Ma();a=b[m3c.m0a].Ma()||"";b=b[m3c.oYa].Ma()||"";var e,f;""==c?f=!0:e=parseInt(c,10);c="ON"==d;return new DL(e,f,c,isNaN(parseInt(a,10))||!c?void 0:parseInt(a,10),isNaN(parseFloat(b))||!c?void 0:parseFloat(b))}
function B3c(a){var b=a.C;a=a.ea.L;var c=b[m3c.k2].jf();c=null==c?a.C:c.Ma();b=b[m3c.y3a].jf();b=null==b?a.J||Yub().name():b.Ma();return new Ovb(c,b)}p.P0b=function(){(new Qvb).exec()};p.Fa=function(){hc(this.C,D);delete this.C;u_.ma.Fa.call(this)};function C3c(a,b,c,d,e,f,h){mp.call(this,void 0,!1,h);this.L=this.J=this.ea=this.O=null;this.Aa=a;this.C=b;this.F=[];this.qa=new dec(a,d,e,f)}r(C3c,mp);p=C3c.prototype;
p.xa=function(){mp.prototype.xa.call(this);var a=this.oa(),b=this.C.Qc(),c=QF(iA(b)),d=QF(new Dd(b.left+b.width-1,b.top+b.height-1));np(this,"Sort range from "+(c+(" to "+d)));D3c||(c=new vp,c.set("save","Sort"),c.set("cancel","Cancel",!1,!0),D3c=c);yp(this,D3c);yq(this,"save");var e;c=a.xa("DIV",{style:"overflow: hidden"},d=a.xa("SPAN","jfk-checkbox"),e=a.xa("SPAN",{style:"cursor: default"},"Data has header row"));var f=this.L=new qq(void 0,a);f.Va(d);Vp(f,e);1==b.height&&f.Pa(!1);GK(this.Aa,this.C.kc(),
b)||(f.Ec(!0),f.Pa(!1));p1a&&ritz_api.TablesApi.getTables((new dw).serialize(qA(b,this.C.kc())),v(function(a){if(0<a.length){var c=a[0];a=wcc(c.getDimensionTableAccessor().getHeaderRange());if(c=ritz_api.TablesApi.isRowBased(c))c=oA(a),c=1==qw(c)-W(c,1);c&&(c=qA(b,this.C.kc()),c=a.yb()==c.yb()&&H1c(oA(a),oA(c))&&H1c(pA(a),pA(c)));c&&f.Ec(!0)}},this));d=this.Ib();a.appendChild(d,c);this.O=a.xa("DIV",{style:"overflow-y:auto;overflow-x:hidden;max-height:300px"},a.xa("TABLE",{cellSpacing:"0"},this.ea=
a.xa("TBODY")));a.appendChild(d,this.O);c=E3c(this);this.F.push(c);c=a.xa("SPAN","menuMainLink waffle-sd-add","+ Add another sort column");a.appendChild(d,c);se(c,!0);Yh(c,"button");this.J=c};p.Ia=function(){mp.prototype.Ia.call(this);this.getHandler().R(this,"dialogselect",this.kLb).Pg(this.J,ff,this.zlb).R(this.L,"change",this.cub)};
function E3c(a){var b=a.oa(),c=0==a.F.length,d=new F3c(a,c,a.C,a.F.length,b),e=b.xa("TR",null,b.xa("TD",{colspan:"4"},b.xa("DIV","waffle-sd-row-separator")));d.render(a.ea);b.appendChild(a.ea,e);c||a.getHandler().Pg(d.D,ff,v(a.V7a,a,d));a=G3c(a);H3c(d,a);return d}p.V7a=function(a){var b=this.F;if(1<b.length){var c=Sa(b,a);-1!=c&&(lb(b,c),b=a.getElement(),b=le(b),a.dispose(),ge(b),L(this.J,!0),this.J.focus(),iB("Sort criteria removed."))}};
function G3c(a){var b=a.C.Qc(),c=b.rc();b=b.Wc();var d=Wa(a.F,function(a){return a.Zj()},a);if(d)for(var e=NI(a.C,d[d.length-1]),f=e+1<b?e+1:c;f!=e;f=f+1<b?f+1:c){var h=PI(a.C,f);if(!db(d,h))return h}return null}p.cub=function(){for(var a=this.F,b=0;b<a.length;b++)H3c(a[b])};p.zlb=function(){var a=gA(this.C.Qc(),"c");a=Math.max(10,a);this.F.length<a&&(this.F.push(E3c(this)),iB("Sort criteria added."));Bh(Ra(this.F).getElement(),this.O,!0);this.O.scrollLeft=0;this.F.length>=a&&L(this.J,!1)};
p.kLb=function(a){if("save"==a.key){a=[];for(var b=[],c=this.F,d=0;d<c.length;d++){var e=c[d];a.push(e.Zj());e=e.F.isChecked();b.push(e?1:0)}c=this.C.Qc();d=gA(c,"r");if(this.L.isChecked()&&1<d){d=c.yc()+1;e=c.rc();var f=c.Uc(),h=c.Wc();c.top=d;c.left=e;c.height=f-d;c.width=h-e}a=new cec(a,b,this.C,c,this.L.isChecked());eec(this.qa,this.C,a)}};p.Fa=function(){mp.prototype.Fa.call(this);Cb(this.F)};var D3c=null;
function F3c(a,b,c,d,e){N.call(this,e);this.J=this.L=this.F=this.C=this.D=null;this.V=-1;this.$=a;this.O=b;this.H=c}r(F3c,N);F3c.prototype.Zj=function(){var a=this.C.jf();return a?a.Ma():-1};
F3c.prototype.xa=function(){var a=this.oa(),b=this.O?"sort by":"then by",c,d,e,f=a.xa("TR","waffle-sd-tr-rules",a.xa("TD","waffle-sd-delete",this.O?"":this.D=a.xa("SPAN",{title:"Remove sort criteria."},"x")),a.xa("TD","waffle-sd-td-rules",a.xa("LABEL",{id:Uh(this,"csl")},b)),b=a.xa("TD","waffle-sd-column-selector"),a.xa("TD","waffle-sd-td-ascending",e=a.xa("DIV",null,c=a.xa("DIV",{title:"Ascending"}),d=a.xa("DIV",{title:"Descending"}))));Yh(e,"radiogroup");e=this.F=new RV(a,De(a,fo(SM(!0,this.Ne()))),
"ascending");e.render(c);a=this.L=new RV(a,De(a,fo(SM(!1,this.Ne()))),"descending");a.render(d);this.J=new TV([e,a]);UV(this.J,e);a=this.C=l_();a.render(b);Zh(a.getElement(),"label",this.O?"Select first column to sort by:":"Select next column to sort by:");this.D&&(se(this.D,!0),Yh(this.D,"button"),ei(this.D,"Remove sort criteria."));this.Da=f};
function H3c(a,b){var c=a.oa(),d=a.$.L.isChecked(),e=a.H.Qc(),f=e.yc(),h=e.rc();e=e.Wc();a.V=b||a.Zj();for(b=a.C.ej();0<b;b--)a.C.dC(0);for(;h<e;h++)b=Sb(PH(a.H.Qf(f,h)),25),b=new hk(Jb(b)||!d?"Column "+JF(h):b,PI(a.H,h),c),b.Re("waffle-sd-menu-item"),a.C.Pd(b);a.C.tf(0);0<=a.V&&a.C.Qa(a.V)}F3c.prototype.Fa=function(){N.prototype.Fa.call(this);this.C=this.D=this.H=this.$=null;D(this.F);D(this.L);D(this.J);this.J=this.L=this.F=null};function I3c(a,b,c){return GAa(a||"There was a problem",nd(b),void 0,void 0,void 0,void 0,c)};function J3c(a,b){mp.call(this,"docs-material-dialog",a,b);yp(this,null);xp(this,!0);tp(this,this.yJ?0:.6);this.O=new XW("Ok");this.Ha(this.O);this.C=new YCc("Cancel");this.Ha(this.C)}r(J3c,mp);p=J3c.prototype;p.Ia=function(){var a=this;mp.prototype.Ia.call(this);this.getHandler().R(this.O,"action",function(){return a.C7()}).R(this.C,"action",function(){a.dispatchEvent("de")&&a.setVisible(!1)}).R(this.Da,"keypress",this.$Kb)};
p.$Kb=function(a){13==a.keyCode&&(a.target==uza(this)||a.target==this.C.getElement()?this.dispatchEvent("de")&&this.setVisible(!1):("TEXTAREA"!=a.target.tagName&&"SELECT"!=a.target.tagName&&"A"!=a.target.tagName||a.target.disabled)&&this.C7())};p.C7=function(){this.dispatchEvent("ce")&&this.setVisible(!1)};p.xa=function(){mp.prototype.xa.call(this);var a=rp(this);this.C.render(a);this.O.render(a);L(a,!0);Rp(uza(this),$Cc)};p.cC=function(a){mp.prototype.cC.call(this,a);tp(this,this.yJ?0:.6)};function K3c(a,b,c){J3c.call(this);np(this,"Grouping rule");this.qa=a;this.Oa=b;this.Aa=c;this.ea=new N;this.Ha(this.ea,!0);this.F=new L3c("Minimum value","e.g. 0",!0);this.ea.Ha(this.F,!0);this.L=new L3c("Maximum value","e.g. 100",!0);this.ea.Ha(this.L,!0);this.J=new L3c("Interval size","e.g. 10",!1);this.Ha(this.J,!0);(a=this.qa.C.getActiveGrid())&&(a=TI(a.Nc()))&&(a=M3c(this,a))&&Uv(a,10)&&Uv(W(a,10),3)&&(a=W(W(a,10),3),Uv(a,1)&&(b=this.F,c=W(a,1),b.zL.Qa(eX.format(c))),Uv(a,2)&&(b=this.J,c=W(a,
2),b.zL.Qa(eX.format(c))),Uv(a,3)&&(b=this.L,a=W(a,3),b.zL.Qa(eX.format(a))))}r(K3c,J3c);
K3c.prototype.C7=function(){var a=N3c(this.F),b=N3c(this.J),c=N3c(this.L);if(isNaN(a)||isNaN(b)||isNaN(c))var d=!1;else 0>=b?(O3c(this.J,"Must be greater than 0"),d=!1):null!=a&&null!=c&&a>=c?(O3c(this.F,"Value too large"),d=!1):d=!0;if(d){d=new oy;d.setType(2);var e=new ry;null!=a&&X(e,1,a);null!=b&&X(e,2,b);null!=c&&X(e,3,c);X(d,3,e);if(a=this.qa.C.getActiveGrid())if(a=a.Nc(),b=TI(a))if(c=M3c(this,b))X(c,10,d),this.Oa.C(new tO(b,a));J3c.prototype.C7.call(this)}};
function M3c(a,b){b=Pgb(b,function(b){return b.P5()==a.Aa});if(0==b.length)return null;if(1==b.length)return b[0];if(2==b.length)return Uv(b[0],10)?b[0]:b[1]}function L3c(a,b,c,d){N.call(this,d);this.J=a;this.O=b;this.L=c;this.H=new N;this.Ha(this.H,!0);this.zL=new aX;this.Ha(this.zL,!0);this.F=null;this.C=new N;this.Ha(this.C,!0);this.D=new WU(this.oa(),!0,!0);this.va(this.D)}r(L3c,N);
L3c.prototype.Ia=function(){N.prototype.Ia.call(this);this.Da.className="waffle-pivot-histogram-errorable-input";this.H.Da.className="waffle-pivot-histogram-dialog-caption";this.oa().Te(this.H.getElement(),this.J);this.F=this.zL.Md().wL(this.zL.Da);this.F.placeholder=this.O;ei(this.F,this.J);ZU(this.D,this.F);this.C.Da.className="waffle-pivot-histogram-dialog-error";P3c(this)};
function N3c(a){P3c(a);var b=a.zL.Ma();if(Jb(b)){if(a.L)return null;O3c(a,"Required");return NaN}b=eX.parse(b);isNaN(b)&&O3c(a,"Must be a number");return b}function O3c(a,b){a.C.Da.style.visibility="";a.oa().Te(a.C.Da,b);XU(a.D,b,!1)}function P3c(a){a.C.Da.style.visibility="hidden";YU(a.D)};function Q3c(a){return R("<li class='nfd-format-pill'><div class='nfd-format-display'>"+Q(a.egb)+"</div><div class='nfd-format-sample'>"+Q(a.cTb)+"</div></li>")};function R3c(a,b,c){N.call(this);this.Jd(a);this.D=b;this.C=c}y(R3c,N);p=R3c.prototype;p.xa=function(){var a=this.Sa(),b=this.C?dba(aS(a),30):aS(a);a=this.C?F$b(a,this.D):"";this.Da=P(Q3c,{egb:b,cTb:a})};p.Ia=function(){R3c.ma.Ia.call(this);se(this.getElement(),!0);var a=new Jj(this.getElement());this.va(a);this.getHandler().R(a,"key",this.M2b).R(this.getElement(),"mousedown",this.L2b).R(this.getElement(),"dblclick",this.hrb)};
p.M2b=function(a){function b(a,b){for(;b=a(b);)if(Kh(b)){b.focus();break}}switch(a.keyCode){case 13:case 32:this.dispatchEvent("change");break;case 40:b(le,this.getElement());break;case 38:b(Yca,this.getElement())}};p.L2b=function(a){a.preventDefault();this.dispatchEvent("change")};p.hrb=function(){this.dispatchEvent("action")};function S3c(a,b,c){N.call(this);this.D=b;this.C=c;T3c(this,a)}y(S3c,N);S3c.prototype.xa=function(){this.Da=this.oa().xa("UL","nfd-pill-container")};function T3c(a,b){A(b,function(b){a.Ha(new R3c(b,a.D,a.C),!0)})}S3c.prototype.filter=function(a){a=a.toLowerCase();this.Cf(function(b){var c=Jb(Yb(a)),d=aS(b.Sa()).toLowerCase();c=c||Qb(d,a);L(b.getElement(),c)})};function v_(a){mp.call(this,"nfd-dialog modal-dialog");this.F=a;this.input=this.Vfa();this.Ha(this.input,!0);this.J=new N;this.Ha(this.J,!0);a=this.a6();qb(a,void 0,I1c);this.C=new S3c(a,this.$X(),this.JTa());this.J.Ha(this.C,!0);yp(this,null);this.ij=!0}y(v_,mp);p=v_.prototype;p.DWa=Je;p.JTa=Ie;p.isEmpty=function(){return Jb(this.input.Ma())};p.Ze=function(){return this.input.Sa().Ze()};p.xa=function(){v_.ma.xa.call(this);var a=Vd("DIV","dialog-separator");fe(a,qp(this))};
p.Ia=function(){v_.ma.Ia.call(this);ah(this.J.getElement(),"nfd-dialog-content");this.getHandler().R(this.C,"change",this.stb).R(this.C,"action",this.xsa).R(this.input.O,"action",this.xsa).R(this.input,"afterhide",this.Mlb);this.input.V&&this.getHandler().R(this.input.V,"input",this.E2b);var a=this.input.qa;a&&this.getHandler().R(a,"key",this.F2b);a=this.a6()[0];this.input.rM(a)};p.Mlb=function(a){a.stopPropagation()};p.stb=function(a){this.input.rM(a.target.Sa());U3c(this.input,!1)};
p.E2b=function(){this.C.filter(this.input.Ma());U3c(this.input,!this.input.Sa().Ze())};p.F2b=function(a){13==a.keyCode&&this.xsa()};p.xsa=function(){this.Ze()&&!this.isEmpty()?(g3a.wc(new $R(this.L1(),void 0,this.DWa())),this.setVisible(!1)):(U3c(this.input,!0),this.input.dFa())};function w_(a,b,c,d,e){hk.call(this,b,c,d,e);this.C=a}y(w_,hk);w_.prototype.Gk=function(){var a=w_.ma.Gk.call(this),b=this.getParent();return b&&b instanceof bk&&!b.isVisible()?this.C(a,this.Sa()):a};function x_(a){N.call(this);this.J=new N;this.va(this.J);this.D=new xS("");this.va(this.D);this.O=new mr("");this.va(this.O);this.$=a;this.qa=null}y(x_,N);p=x_.prototype;
p.Ia=function(){x_.ma.Ia.call(this);var a=Wh(this,"nfd-icwr");this.J.Va(a);this.Ha(this.J);if(a=Wh(this,"nfd-i"))this.D.Va(a),this.D.Nd(this.J),ch(this.D.getElement(),"jfk-textinput"),a=new Bq,a.Va(this.D.getElement()),this.va(a),this.V=a=new Aq(this.D.getElement()),this.va(a),this.qa=a=new Jj(this.D.getElement()),this.va(a),a=new kp(this.D.getElement()),this.getHandler().R(a,"focusout",Fa(this.BWa,!1)).R(a,"focusin",Fa(this.BWa,!0)).R(this.V,"input",this.D2b);a=Wh(this,"nfd-a");this.O.Va(a);this.Ha(this.O)};
p.Ma=function(){return this.D.Ma()};p.D2b=function(){var a=this.Sa(),b=this.Ma();X(a.bH,2,b);this.CWa()};p.CWa=Je;p.BWa=function(a){eh(this.J.getElement(),"nfd-input-focus",a)};p.rM=function(a){this.Jd(a.clone());this.D.Qa(aS(a));try{this.D.getElement().focus()}catch(b){}};p.dFa=function(){this.D.getElement().focus()};function U3c(a,b){a=a.J.getElement();eh(a,"nfd-invalid",b)};function V3c(a,b,c){b=c||b;return R("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+T(a.PZ)+"'>"+W3c(a)+"</div>"+X3c(a,b)+"</div>")}function Y3c(a,b,c){b=c||b;return R("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+T(a.PZ)+"'></div>"+X3c(a,b)+"</div>")}
function Z3c(a,b,c){b=c||b;return R("<div class='nfd-inputall'><div class='nfd-input jfk-textinput' id='"+T(a.PZ)+"'><div style='display: table-row;'><div class='nfd-inner-input' style='display: table-cell;'>"+W3c(a)+"</div><div class='nfd-inner-input-content' style='display: table-cell;'><div id='"+T(a.OIb)+"'></div></div></div></div>"+X3c(a,b)+"</div>")}
function $3c(){var a=""+("<div class='cnf-sample-wrapper'><table class='cnf-sample-table'><tbody>"+a4c({label:""})+a4c({label:gq("Negative:")})+a4c({label:gq("Zero:")})+a4c({label:gq("Text:")})+"</tbody></table><a class='cnf-help-link' href='//support.google.com/drive/?p=drive_custom_numbers' target='_blank'>Help</a></div>");return R(a)}function a4c(a){return R("<tr><td class='nfd-sample-label'>"+Q(a.label)+"</td><td class='nfd-rendered-sample'></td></tr>")}
function X3c(a,b){a=""+Q(lr({id:a.QV,style:2,Ed:"nfd-apply",content:bq("Apply")},b));return R(a)}function W3c(a){return R(Q(T2c({id:a.UMa,k$:a.VMa,iYb:!0})))};function b4c(a){x_.call(this,a);this.F=new N;this.C=new ON("")}y(b4c,x_);p=b4c.prototype;p.xa=function(){this.Da=P(Z3c,{PZ:Uh(this,"nfd-icwr"),UMa:Uh(this,"nfd-i"),VMa:this.$,OIb:Uh(this,"nfd-ic"),QV:Uh(this,"nfd-a")})};p.Ia=function(){b4c.ma.Ia.call(this);var a=Wh(this,"nfd-ic");this.F.Va(a);this.F.Nd(this.J);this.F.Ha(this.C,!0);this.getHandler().R(this.C,"aftershow",this.G2b).R(this.C,"action",this.UJa).R(this.V,"input",Fa(this.AVa,null))};
p.rM=function(a){b4c.ma.rM.call(this,a);a.C&&this.D.Qa(ht[a.C][1]);this.AVa(a)};
p.AVa=function(a){a=a?a.C:void 0;var b=this.C;b.Mf(null);if(a){var c=this.Sa(),d=c.C;c4c(this,c);c=iec(d,ht[d][2]);c=new $R(d4c(c),hec[d],d);c4c(this,c);c=iec(d,d+" "+ht[d][1]);d=new $R(d4c(c),hec[d],d);c4c(this,d)}else this.Sa().C=null;var e="[$"+this.Ma()+"]";d=a?hec[a]:null;c=[];c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,0,!0));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,2,!1));c.push(ritz_api.RitzModelApi.buildCurrencyPattern(e,
0,!1));for(e=0;e<c.length;e++){var f=new $R(d4c(c[e]),d,a);c4c(this,f)}b.tf(0);this.UJa();ah(b.Bc().getElement(),"number-format-menu")};function c4c(a,b){var c=new w_(function(a){return dba(a,25)},F$b(b,1E3),b);a.va(c);a.va(b);c.yp(!0);a=a.C;for(b=0;b<a.ej();b++)if(a.Se(b).Gk()==c.Gk())return;a.Pd(c)}p.UJa=function(){for(var a=this.C,b=0;b<a.ej();b++)a.Se(b).Ec(!1);a.IH()};p.G2b=function(){this.C.jf().Ec(!0)};function d4c(a){var b=new iw;X(b,2,a);b.setType(4);return b};function e4c(a){v_.call(this,a);np(this,"Custom currencies")}y(e4c,v_);p=e4c.prototype;p.$X=n(1000.12);p.Vfa=function(){return new b4c("Custom currency")};p.a6=function(){var a=this;Jbc();for(var b=this.F,c=0;c<b.length;c++){var d=b[c],e=d.C;e?d.D=hec[e]:B1c(d,kec(d.Gl()))}var f=[];hc(ht,function(b,c){b=jec(c);a.va(b);f.push(b)});var h=wDc();vb(f,function(a,b){return h(aS(a),aS(b))});return b.concat(f)};
p.L1=function(){var a=new iw;a.setType(4);X(a,3,1);var b=this.input.C.jf().Ma().Gl();X(a,2,b);return a};p.DWa=function(){return this.input.Sa().C};function f4c(a){N.call(this);a=Math.abs(a);var b=[];b.push(a);b.push(-1*a);b.push(0);this.C=b}y(f4c,N);f4c.prototype.xa=function(){var a=P($3c);this.F=Qd("nfd-sample-label",a);this.D=Oca("nfd-rendered-sample",a);this.Da=a};function y_(a,b){x_.call(this,a);this.C=new f4c(b);this.Jd(new $R(""))}y(y_,x_);y_.prototype.xa=function(){this.Da=P(V3c,{UMa:Uh(this,"nfd-i"),VMa:this.$,PZ:Uh(this,"nfd-icwr"),QV:Uh(this,"nfd-a")})};y_.prototype.Ia=function(){y_.ma.Ia.call(this);this.Ha(this.C,!0);g4c(this)};y_.prototype.CWa=function(){g4c(this)};y_.prototype.rM=function(a){y_.ma.rM.call(this,a);g4c(this)};
function g4c(a){var b=a.Sa();if(b){var c=a.C;a=b.Gl().split(";").length-1;qe(c.F,0<a?"Positive:":"Sample:");for(var d=0;d<c.C.length;d++){var e=c.D[d],f=F$b(b,c.C[d]),h=ritz_api.RitzModelApi.getColorForFormattedString(String(c.C[d]),b.Gl()),k=d<=a;L(ne(e),k);qe(e,f);ph(e,"color",h||"")}d=b.Ze()?ritz_api.RitzModelApi.renderStringInNumberFormat("text",b.Gl()):"Invalid format";b=ritz_api.RitzModelApi.getColorForFormattedString("text",b.Gl());c=c.D[3];L(ne(c),3<=a);qe(c,d);ph(c,"color",b||"")}};function h4c(a){v_.call(this,a);np(this,"Custom number formats")}y(h4c,v_);h4c.prototype.$X=n(1234.56);h4c.prototype.Vfa=function(){return new y_("Custom number format",1234.56)};
h4c.prototype.a6=function(){var a=this.F;a.push(new $R("0"));a.push(new $R("0.00"));a.push(new $R("#,##0"));a.push(new $R("#,##0.00"));a.push(new $R("#,##0_);(#,##0)"));a.push(new $R("#,##0_);[Red](#,##0)"));a.push(new $R("#,##0.00_);(#,##0.00)"));a.push(new $R("#,##0.00_);[Red](#,##0.00)"));a.push(new $R("$#,##0_);($#,##0)"));a.push(new $R("$#,##0_);[Red]($#,##0)"));a.push(new $R("$#,##0.00_);($#,##0.00)"));a.push(new $R("$#,##0.00_);[Red]($#,##0.00)"));a.push(new $R("@"));a.push(new $R("0%"));a.push(new $R("0.00%"));
a.push(new $R("0.00E+00"));a.push(new $R("##0.0E+0"));a.push(new $R("# ?/?"));a.push(new $R("# ??/??"));a.push(new $R('_($* #,##0_);_($* (#,##0);_($* "-"_);_(@_)'));a.push(new $R('_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)'));a.push(new $R('_($* #,##0.00_);_($* (#,##0.00);_($* "-"??_);_(@_)'));a.push(new $R('_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)'));return a};h4c.prototype.L1=function(){var a=new iw;a.setType(2);X(a,3,1);var b=this.input.Ma();X(a,2,b);return a};function z_(a,b){mk.call(this,b,new i4c(a))}y(z_,mk);p=z_.prototype;p.jh=function(a,b,c){z_.ma.jh.call(this,a,b,c);a.Wb()&&this.Wb()&&a.getParent()==this&&j4c(this)};p.Ia=function(){z_.ma.Ia.call(this);j4c(this)};p.Ad=function(a){z_.ma.Ad.call(this,a);j4c(this)};p.removeChild=function(a,b){a=z_.ma.removeChild.call(this,a,b);j4c(this);return a};p.Bn=function(a,b){a=z_.ma.Bn.call(this,a,b);j4c(this);return a};
p.Hj=function(a){var b;if(!(b=37!=a.keyCode&&39!=a.keyCode)){a:{b=a.keyCode;var c=ek(this);if(c){b=39==b;this.Ne()&&(b=!b);c=c.getElement();c=Sa(c.parentNode.childNodes,c);var d;(d=ek(this))?(d=d.getElement(),d=mda(d,k4c)):d=null;d=d?Sa(d.parentNode.childNodes,d):-1;var e=d==this.getNumberOfColumns()-1;if(b||0==d)if(b&&!e)e=d+1;else{b=!1;break a}else e=d-1;e=l4c(this,e);b?b=l4c(this,d)-c+Math.min(c,e-1):(b=-(c+1),e>c&&(b-=e-1-c));this.eaa(this.Oj+b);b=!0}else b=!1}b=!b}return b?z_.ma.Hj.call(this,
a):!0};p.getNumberOfColumns=function(){return this.getElement()?this.getElement().childNodes.length:0};function l4c(a,b){return 0==a.getNumberOfColumns()?0:(a.getElement()?a.getElement().childNodes[b]:null).childNodes.length}
function j4c(a){var b,c=a.Md(),d=a.cd(),e=nb(Pd("div",k4c,a.getElement())),f=a.getElement();for(b=e.length;b<c.D&&b<d;b++)e[b]=a.oa().xa("DIV",k4c),f.appendChild(e[b]);f=e.length;c=Array(f);d=[];b=0;for(var h=!1,k=0;k<a.cd();k++)a.kd(k)instanceof lk?(d.push(new m4c(b,k,!0)),b=k+1):a.kd(k)instanceof gk&&(0==k?h=!0:(a.kd(k-1),d.push(new m4c(b,k-1,!1)),b=k));k=a.cd();0<d.length&&Ra(d).end!=k-1&&d.push(new m4c(b,k-1,!1));b=h;h=a.cd();if(0==d.length&&b)c[0]=h;else{b=d.length-Math.max(0,d.length-f);b=a.cd()-
b;b=Math.ceil(b/f);if(0==d.length)for(h=0;h<f;h++)c[h]=(h+1)*b-1;else n4c(d,b,f);f=d.length;for(b=0;b<f;b++)c[b]=d[b].end}for(f=d=0;f<a.cd();f++){for(;f>c[d];)++d;b=a.kd(f);h=b.getElement();h.parentNode!=e[d]&&e[d].appendChild(h);f==c[d]&&b instanceof lk?L(h,!1):L(h,!0)}for(a=e.length-1;a>d;--a)e[a].parentNode.removeChild(e[a]),e[a]=null}
function n4c(a,b,c){function d(a){return a.end-a.start-(a.DHb?1:0)}c=Math.max(0,a.length-c);for(var e=0;e<a.length-1;e++)a[e].C=d(a[e])+d(a[e+1]);for(e=0;e<c;e++){for(var f=32765,h=-1,k=!1,l=0;l<a.length-1;l++){var m=a[l].C;m<f&&(f=m,h=l);if(m<=b){a[l+1].start=a[l].start;ib(a,l,1);k=!0;break}}k||(a[h+1].start=a[h].start,ib(a,l,1))}}function m4c(a,b,c){this.start=a;this.end=b;this.DHb=c}function i4c(a){kk.call(this);this.D=a}y(i4c,kk);var k4c="docs-multi-menu-col";function o4c(a){this.C=a}y(o4c,B);o4c.prototype.create=function(){return new z_(this.C)};function p4c(a,b){x_.call(this,a);this.ea=new N;this.H=new q4c;this.F=new N;a=(new o4c(3)).create();a.Ha(new gk("Date"),!0);a.Ha(new hk("Day","DAY_TOKEN"),!0);a.Ha(new hk("Month","MONTH_TOKEN"),!0);a.Ha(new hk("Year","YEAR_TOKEN"),!0);a.Ha(new gk("Time"),!0);a.Ha(new hk("Hours","HOURS_TOKEN"),!0);a.Ha(new hk("Minutes","MINUTES_TOKEN"),!0);a.Ha(new hk("Seconds","SECONDS_TOKEN"),!0);a.Ha(new hk("Milliseconds","MILLIS_TOKEN"),!0);a.Ha(new hk("AM/PM","AM_PM_TOKEN"),!0);a.Ha(new gk("Duration"),!0);a.Ha(new hk("Elapsed hours",
"ELAPSED_HOURS_TOKEN"),!0);a.Ha(new hk("Elapsed minutes","ELAPSED_MINUTES_TOKEN"),!0);a.Ha(new hk("Elapsed seconds","ELAPSED_SECONDS_TOKEN"),!0);this.L=new JGb(a);this.C=b}y(p4c,x_);p=p4c.prototype;p.xa=function(){this.Da=P(Y3c,{PZ:Uh(this,"nfd-icwr"),QV:Uh(this,"nfd-a")})};
p.Ia=function(){p4c.ma.Ia.call(this);ah(this.getElement(),"nfd-date-time-input");var a=Wh(this,"nfd-icwr"),b=this.ea;b.Va(a);b.Nd(this);b.Ha(this.L,!0);ah(this.L.getElement(),"nfd-date-time-menu-button");ah(this.L.Bc().getElement(),"nfd-date-time-menu");ei(this.L.Da,"Add a date or time format");b.Ha(this.H,!0);Mc||ah(this.H.getElement(),"nfd-date-time-left-most");a=this.F;b.Ha(a,!0);ph(a.getElement(),"display","inline");this.getHandler().R(this,"ee",Fa(this.EWa,"left")).R(this,"ie",Fa(this.UKa,"left")).R(this,
"je",Fa(this.UKa,"right")).R(this,"ke",Fa(this.FLa,"left")).R(this,"le",Fa(this.FLa,"right")).R(this,"he",Fa(this.EWa,"right")).R(this.L,"action",this.$pb)};p.dFa=function(){this.ea.getElement().focus()};
p.rM=function(a){this.Jd(a.clone());var b=this.F;b.Id(!0);qe(this.H.getElement(),"");a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a.Gl());for(var c=0;c<a.length;c++){var d=a[c],e=d[0];"LITERAL_TOKEN"==e?0==c?qe(this.H.getElement(),d[2]):(e=b.kd(b.cd()-1),d=d[2],qe(e.dA.getElement(),ue(e.dA.getElement())+d)):r4c(this,e).Qa(d[1])}0<b.cd()&&b.kd(b.cd()-1).jy.getElement().focus()};
p.Ma=function(){for(var a=this.H.toString(),b=0;b<this.F.cd();b++)a+=this.F.kd(b).toString();a=ritz_api.RitzModelApi.renderDateAsTokens(this.C,a);b="";for(var c=!1,d=0;d<a.length;d++){var e=a[d][1];switch(a[d][0]){case "ELAPSED_HOURS_TOKEN":case "ELAPSED_MINUTES_TOKEN":case "ELAPSED_SECONDS_TOKEN":c?(e=Tb(e,"["),e=Tb(e,"]")):c=!0}b+=e}return b};p.$pb=function(a){a=a.target.Ma();r4c(this,a).jy.getElement().focus()};
function r4c(a,b){U3c(a,!1);switch(b){case "DAY_TOKEN":var c=s4c(a);break;case "MONTH_TOKEN":c=t4c(a);break;case "YEAR_TOKEN":c=u4c(a);break;case "HOURS_TOKEN":c=v4c();break;case "MINUTES_TOKEN":c=w4c();break;case "SECONDS_TOKEN":c=x4c();break;case "MILLIS_TOKEN":c=y4c();break;case "AM_PM_TOKEN":c=z4c(a);break;case "ELAPSED_HOURS_TOKEN":c=A4c();break;case "ELAPSED_MINUTES_TOKEN":c=B4c();break;case "ELAPSED_SECONDS_TOKEN":c=C4c()}b=c;b.Ha(new lk,!0);b.Ha(new hk("Delete"),!0);c=new D4c(c,"");a.F.Ha(c,
!0);return c}p.EWa=function(a,b){b=b.target;if(b instanceof q4c){if(b===this.H&&"left"==a)return;b=b.getParent();if("right"==a&&(b=this.F.kd(Xh(this.F,b)+1),!b))return}a=ue(b.dA.getElement());var c=b.getParent(),d=Xh(c,b);c.removeChild(b,!0);0==d?(b=this.H.getElement(),c=ue(b),qe(b,c+a),E4c(this.H,c.length)):(d--,b=c.kd(d),c=ue(b.dA.getElement()),qe(b.dA.getElement(),ue(b.dA.getElement())+a),E4c(b.dA,c.length))};
p.FLa=function(a,b){b=b.target.getParent();a="left"==a?0:1;(a=this.F.kd(Xh(this.F,b)+a))&&a.jy.getElement().focus()};p.UKa=function(a,b){var c="left"==a?-1:0;(b=this.F.kd(Xh(this.F,b.target)+c))||"left"!=a?b&&(b=b.dA):b=this.H;c=ue(b.getElement()).length;E4c(b,"left"==a?c:0)};function D4c(a,b){N.call(this);this.jy=new ON("",a);this.Ha(this.jy,!0);this.dA=new q4c(b);this.Ha(this.dA,!0)}y(D4c,N);p=D4c.prototype;
p.Ia=function(){D4c.ma.Ia.call(this);ph(this.getElement(),"display","inline-block");this.jy.tf(0);this.C=new Jj(this.jy.getElement());this.va(this.C);this.getHandler().R(this.jy,"action",this.H2b).R(this.C,"key",this.I2b)};p.H2b=function(){this.jy.IH();this.jy.jf().Sa()||this.dispatchEvent("he")};p.I2b=function(a){switch(a.keyCode){case 8:case 46:a.repeat||(a.preventDefault(),this.dispatchEvent("he"));break;case 37:a.preventDefault();this.dispatchEvent("ie");break;case 39:a.preventDefault(),this.dispatchEvent("je")}};
p.toString=function(){return this.jy.jf().Sa()+this.dA.toString()};p.Qa=function(a){this.jy.Qa(a)};function q4c(a){N.call(this);this.C=a||""}y(q4c,N);p=q4c.prototype;p.xa=function(){var a=Vd("SPAN");Rd(a,{contentEditable:!0});qe(a,this.C);var b=a.style;Ic&&!Tc("8")?(b.whiteSpace="pre",b.wordWrap="break-word"):b.whiteSpace=Mc?"-moz-pre-wrap":"pre-wrap";this.Da=a};
p.Ia=function(){q4c.ma.Ia.call(this);var a=new Jj(this.getElement());this.va(a);this.getHandler().R(a,"key",this.J2b).R(this.getElement(),"paste",this.K2b)};function E4c(a,b){if(0==ue(a.getElement()).length&&0==b)a.getElement().focus();else{var c=a.getElement().firstChild;b=lM(c,b);a.getElement().focus();b.select()}}
p.J2b=function(a){var b=te(this.getElement()),c=bM(),d=ue(this.getElement()).length,e=c?0==c.Ih()&&0==c.Jn():Jb(Yb(b));b=c?c.Ih()==d&&c.Jn()==d:Jb(Yb(b));switch(a.keyCode){case 8:e&&(a.preventDefault(),this.dispatchEvent("ee"));break;case 46:b&&(a.preventDefault(),this.dispatchEvent("he"));break;case 40:this.dispatchEvent("fe");break;case 38:this.dispatchEvent("ge");break;case 37:e&&(a.preventDefault(),this.dispatchEvent("ke"));break;case 39:b&&(a.preventDefault(),this.dispatchEvent("le"));break;
case 13:a.preventDefault()}};p.toString=function(){var a=Naa(ue(this.getElement())).replace(/"/g,'"\\""');return 0==Yb(a).length?"":'"'+a+'"'};p.K2b=function(){var a=v(function(){qe(this.getElement(),ue(this.getElement()))},this);wi(a)};
function s4c(a){function b(a){return"Day ("+(a+")")}var c=[],d="d",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Day without leading zero ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="dd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day with leading zero ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="ddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Day as abbreviation ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="dddd";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Day as full name ("+
(e+")");c.push(new w_(Fa(b,e),a,d));d=new mk;for(e=0;e<c.length;e++)d.Ha(c[e],!0);return d}
function t4c(a){function b(a){return"Month ("+(a+")")}var c=[],d="m",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Month without leading zero ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="mm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month with leading zero ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="mmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Month as abbreviation ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="mmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,
d);f="Month as full name ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="mmmmm";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="First letter of the month ("+(e+")");c.push(new w_(Fa(b,e),a,d));d=new mk;for(e=0;e<c.length;e++)d.Ha(c[e],!0);return d}
function u4c(a){function b(a){return"Year ("+(a+")")}var c=[],d="yy",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Two digit year ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="yyyy";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Full numeric year ("+(e+")");c.push(new w_(Fa(b,e),a,d));d=new mk;for(e=0;e<c.length;e++)d.Ha(c[e],!0);return d}
function v4c(){function a(a){return"Hour ("+(a+")")}var b=[],c="h",d="1",e="Hour without leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c="hh";d="01";e="Hour with leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c=new mk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function w4c(){function a(a){return"Minute ("+(a+")")}var b=[],c="m",d="1",e="Minute without leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c="mm";d="01";e="Minute with leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c=new mk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function x4c(){function a(a){return"Second ("+(a+")")}var b=[],c="s",d="1",e="Second without leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c="ss";d="01";e="Second with leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c=new mk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function y4c(){function a(a){return"Milliseconds ("+(a+")")}var b=[],c="0",d="1",e="Precision to 1/10 of a second ("+(d+")");b.push(new w_(Fa(a,d),e,c));c="00";d="01";e="Precision to 1/100 of a second ("+(d+")");b.push(new w_(Fa(a,d),e,c));c="000";d="001";e="Precision to 1/1000 of a second ("+(d+")");b.push(new w_(Fa(a,d),e,c));c=new mk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function z4c(a){function b(a){return"AM/PM ("+(a+")")}var c=[],d="am/pm",e=ritz_api.RitzModelApi.renderFormattedString(a.C,d),f="Full ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="a/p";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);f="Shortened lowercase ("+(e+")");c.push(new w_(Fa(b,e),f,d));d="A/P";e=ritz_api.RitzModelApi.renderFormattedString(a.C,d);a="Shortened uppercase ("+(e+")");c.push(new w_(Fa(b,e),a,d));d=new mk;for(e=0;e<c.length;e++)d.Ha(c[e],!0);return d}
function A4c(){function a(a){return"Elapsed hours ("+(a+")")}var b=[],c="[h]",d="1",e="Elapsed hours without leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c="[hh]";d="01";e="Elapsed hours with leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c=new mk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function B4c(){function a(a){return"Elapsed minutes ("+(a+")")}var b=[],c="[m]",d="1",e="Elapsed minutes without leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c="[mm]";d="01";e="Elapsed minutes with leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c=new mk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c}
function C4c(){function a(a){return"Elapsed seconds ("+(a+")")}var b=[],c="[s]",d="1",e="Elapsed seconds without leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c="[ss]";d="01";e="Elapsed seconds with leading zero ("+(d+")");b.push(new w_(Fa(a,d),e,c));c=new mk;for(d=0;d<b.length;d++)c.Ha(b[d],!0);return c};function F4c(a){v_.call(this,a);np(this,"Custom date and time formats")}y(F4c,v_);p=F4c.prototype;p.JTa=He;p.$X=n(11175.5628472222);p.isEmpty=function(){return Jb($v(this.L1(),2))};p.Ze=function(){return ritz_api.RitzModelApi.isValidFormatPattern($v(this.L1(),2))};p.Vfa=function(){return new p4c("Custom date time format",11175.5628472222)};p.L1=function(){return G4c(this.input.Ma())};
p.a6=function(){for(var a=this.F,b=0;b<a.length;b++){var c=a[b],d=ritz_api.RitzModelApi.renderFormattedString(this.$X(),c.Gl());c.D=d}b=H4c(this);qb(b);for(c=0;c<b.length;c++)a.push(new $R(G4c(b[c]),ritz_api.RitzModelApi.renderFormattedString(this.$X(),b[c])));return a};
function H4c(a){var b=Xs,c=Wa(b.DATEFORMATS,function(a){return I4c(a)},a),d=Wa(b.TIMEFORMATS,function(a){return I4c(a)},a),e=c.concat(d);b=b.DATETIMEFORMATS;qb(b);a=Wa(b,function(a){return I4c(a)},a);for(b=0;b<a.length;b++){var f=a[b];f=f.replace(/\{1\}/,c[0]);f=f.replace(/\{0\}/,d[0]);e.push(f)}return e}
function I4c(a){a=a.split(/('+)/);for(var b=!1,c=0;c<a.length;++c){var d=a[c].match(/'/g);if(d){for(var e="",f=0;f<a[c].length;f+=2)e+="'";a[c]=e}d&&1==d.length%2?(a[c]='"',b=!b):d||b||(d=a[c],d=d.replace(/E/gi,"d"),d=d.replace(/z/gi,""),d=d.replace(/a/gi,"am/pm"),d=d.replace(/\[/gi,""),d=d.replace(/\]/gi,""),d=d.replace(/\by\b/gi,"yyyy"),a[c]=d)}return Lb(a.join(""))}function G4c(a){var b=new iw;b.setType(7);X(b,3,1);X(b,2,a);return b};function J4c(a,b){this.D=a;this.C=b}J4c.prototype.getUrl=g("D");J4c.prototype.getTitle=g("C");function K4c(a,b,c,d,e,f){ds.call(this,a,b,"domain",d,e,f);this.H=c}y(K4c,ds);K4c.prototype.C=function(){var a=K4c.ma.C.call(this);a.domainName=this.H;return ic(a,eDa)};vDa.set("domain",function(a){return new K4c(a.name,a.id,a.domainName,a.me,a.iconUrl,a.requiresKey)});new K4c("","DEFAULT","",!0);function L4c(){};function M4c(a){for(var b="",c=a.sUb,d=c.length,e=0;e<d;e++){var f=c[e],h=a.qUb[f.Jh()];f.getName();var k=f.getLabel();f=f.tIb;f=R('<div id="'+T(h)+'" tabindex="0" role="link" class="'+T("ess-button")+'" aria-label="'+T(k)+'"><div class="'+T("ess-icon")+" "+T(f)+'"></div></div>');b+=f}return R(b+"")};function N4c(a,b){N.call(this,b);this.D=a||[];this.F=[];this.C=null}y(N4c,N);p=N4c.prototype;p.Kea=!0;p.gea=!1;p.uP=null;p.pDa=!1;p.Pa=function(a,b){this.Kea=a;this.gea=b;if(this.pDa){b=this.oa();for(var c=0,d;d=this.D[c];c++){var e=b.getElement(this.uP.Vpa+"-"+d.Jh()),f=a;eh(e,"ess-button",f);eh(e,"ess-disabled-button",!f);f=d.getName();d=d.getLabel();Oi(e,f,d)}}};
p.xa=function(){this.Da=this.hb.createElement("SPAN");var a={};a.Vpa=Uh(this,"service");a.sUb=this.D;this.uP=a;for(var b={},c=0,d;d=this.D[c];c++)b[d.Jh()]=this.uP.Vpa+"-"+d.Jh();a.qUb=b;this.uP=a;Rp(this.getElement(),M4c,this.uP);this.pDa=!0};
p.jSb=function(a){if(this.Kea){if(this.C){var b={};b.externalSharingService=a.C;this.C.C(9,b)}if(this.gea)this.dispatchEvent(new O4c(new P4c(a,this.F,this.C||void 0)));else{var c=this.C||void 0;b=a.getUrl(this.F);if(c){var d={};d.externalSharingService=a.C;c.C(10,d)}a={LHc:!0};a.target=a.target||b.target||"google_popup";a.width=a.width||690;a.height=a.height||500;(a=co(b,a))&&a.focus()}}};
p.Ia=function(){this.Pa(this.Kea,this.gea);for(var a=this.oa(),b=this.getHandler(),c=0,d;d=this.D[c];c++){var e=a.getElement(this.uP.Vpa+"-"+d.Jh());b.Pg(e,ff,v(this.jSb,this,d))}};p.Fa=function(){N4c.ma.Fa.call(this);delete this.F;delete this.D;this.C=null};function O4c(a,b){E.call(this,"me",b);this.context=a}y(O4c,E);function P4c(){}y(P4c,L4c);function A_(a,b,c,d){this.C=a;this.F=b;this.D=c;this.tIb=d;this.H=Q4c++}var Q4c=0;A_.prototype.Jh=g("H");A_.prototype.getName=g("F");A_.prototype.getLabel=g("D");function R4c(){A_.call(this,"fb","Facebook","Share via Facebook","ess-facebook-icon")}y(R4c,A_);R4c.prototype.getUrl=function(a){var b=Wa(a,function(a){return a.getTitle()});a=Wa(a,function(a){return a.getUrl()});return"http://www.facebook.com/share.php?u="+Mb(a.join(","))+"&t="+Mb(b.join(","))};function S4c(){A_.call(this,"gp","Google+","Share via Google+","ess-gplus-icon")}y(S4c,A_);S4c.prototype.getUrl=function(a){return 0==a.length?"http://plus.google.com":"http://plus.google.com/share?url="+Mb(a[0].getUrl())};function T4c(){A_.call(this,"gm","Gmail","Share via Gmail","ess-gmail-icon")}y(T4c,A_);T4c.prototype.getUrl=function(a){a=Wa(a,function(a){return a.getTitle()+" - "+a.getUrl()});return"https://mail.google.com/mail/?view=cm&ui=2&cmid=0&fs=1&tf=1&body="+Mb(a.join("\n"))};function U4c(){A_.call(this,"tw","Twitter","Share via Twitter","ess-twitter-icon")}y(U4c,A_);U4c.prototype.getUrl=function(a){for(var b=pa(void 0)?void 0:140,c=[],d=0,e=0;e<a.length;e++){var f=a[e].getUrl(),h=d+f.length+(d?1:0);if(h>b)break;else c.push(f),d=h}for(e=0;e<a.length;e++){f=a[e].getTitle();h=c[e]?" - ":"";var k=b-d-h.length;if(k<f.length)if(4<=k)f=f.substring(0,k-3)+"\u2026";else break;d+=f.length+h.length;c[e]=f+h+(c[e]?c[e]:"")}a=c.join(" ");return"http://twitter.com/home?status="+Mb(a)};function B_(a){N.call(this,a)}y(B_,N);function V4c(a){a.dispatchEvent(new E("ne"))}B_.prototype.cY=function(){return{}};B_.prototype.dK=Je;B_.prototype.Opa=ua;function W4c(a){N.call(this,a)}y(W4c,N);W4c.prototype.F=Je;W4c.prototype.H=ua;W4c.prototype.J=ua;function X4c(a,b,c){b=c||b;c="";var d="Make your content visible to anyone by publishing it to the web. You can link to or embed your document. "+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+E1c(a.locale)+'&answer=183965">Learn more</a>');c+='<div class="pub-dialog-wrap"><div><div class="pub-dialog-info" aria-live="polite" id="pub-dialog-status-info"></div><div class="pub-dialog-option-vspacer"></div><div class="pub-dialog-info-help">'+d+'</div><div id="pub-dialog-links-tab-bar" class="pub-dialog-tab-bar goog-tab-bar goog-tab-bar-top"><div id="pub-dialog-link-tab" class="pub-dialog-tab goog-tab goog-tab-selected">Link</div><div id="pub-dialog-embed-tab" class="pub-dialog-tab goog-tab">Embed</div></div><div class="goog-tab-bar-clear"></div><div class="goog-tab-content"><div id="pub-dialog-link-tab-content"><div id="pub-dialog-link-options"></div><input id="pub-dialog-document-link" type="text" class="pub-dialog-document-link jfk-textinput" value="'+
T(a.hab)+'" readonly="readonly" aria-label="'+jq("Link to published document.")+" "+T(a.$Qa)+'"><div id="pub-dialog-sharing-services" class="pub-dialog-link-content-div"><label for="pub-dialog-sharing-services-links">Or share this link using:</label><span id="pub-dialog-sharing-services-links"></span></div></div><div id="pub-dialog-embed-tab-content" style="display:none"><div id="pub-dialog-embed-options"></div><textarea id="pub-dialog-embed-code" rows="3" cols="60" class="pub-dialog-embed-code jfk-textinput" readonly="readonly" aria-label="'+
jq("HTML embed code of published document.")+" "+T(a.$Qa)+'">'+hAa(a.ffb)+'</textarea></div></div><div id="pub-dialog-links-notice"></div>'+Q(lr({id:"pub-dialog-publish-link-button",style:2,value:a.iSb},b))+'<div class="pub-dialog-sep-div"><hr class="pub-dialog-sep"></div><div class="pub-dialog-settings"><div id="pub-dialog-settings-header" class="pub-dialog-zippy-header">'+Q(hs({ov:"pub-dialog-settings-zippy-icon",icon:"docs-icon-img docs-zippy-closed"},b))+'Published content & settings</div><div id="pub-dialog-settings-content" class="pub-dialog-zippy-content"><div id="pub-dialog-published-content"></div>'+
Q(lr({id:"pub-dialog-publish-button",value:a.gSb},b))+'<div class="pub-dialog-checkbox-container">';a.$Ib&&(d="Require viewers to sign in with their "+(Q(a.domain)+" account"),c+=Q(pq({id:"pub-dialog-dom-signin-req",checked:a.Ws,disabled:a.xJ},b))+' <label for="pub-dialog-dom-signin-req" id="pub-dialog-dom-signin-req-label"'+(a.xJ?' class="pub-dialog-disabled-text"':"")+">"+d+"</label><br>");a.EP&&(c+=Q(pq({id:"pub-dialog-auto-publish-checkbox"},b))+' <label for="pub-dialog-auto-publish-checkbox" id="pub-dialog-auto-publish-checkbox-label">Automatically republish when changes are made</label>');
return R(c+"</div></div></div></div></div>")};function C_(a,b,c,d,e,f,h,k,l,m){Mp.call(this);this.kb=a||"";this.Pe=b;this.vd=c;this.Zc=d;this.Mc=l||"/publishsettings";this.C=new Y4c(e);this.Ab=new N4c([new S4c,new T4c,new R4c,new U4c]);this.Ha(this.Ab);this.qa=new mr(null,this.oa());this.Ha(this.qa);this.ea=new mr(null,this.oa());this.Ha(this.ea);this.Ra=new qq(void 0,this.oa());this.Ha(this.Ra);this.Aa=new qq(void 0,this.oa());this.Ha(this.Aa);this.Ta=0;this.Ob=new Z4c;this.Ha(this.Ob);this.wb=this.Bb=null;this.J=f||new B_;this.Ha(this.J);this.F=
h||new B_;this.Ha(this.F);this.Oa=k||new W4c;this.Ha(this.Oa);this.O=this.L=null;this.jb=new as(void 0,$4c,this.oa(),2);this.va(this.jb);this.He=this.zd=null;this.We=m||new N;this.$b=this.Ua=this.Db=null;this.ij=!0}y(C_,Mp);var $4c="Press "+((Pc?"\u2318+C":"Ctrl+C")+" to copy.");p=C_.prototype;p.show=function(){a5c(this,v(function(){this.setVisible(!0)},this))};
p.setVisible=function(a){C_.ma.setVisible.call(this,a);var b=Be(this.oa());a?this.getHandler().R(b,"resize",this.yd):this.getHandler().Rc(b,"resize",this.yd)};
p.xa=function(){C_.ma.xa.call(this);var a=this.oa(),b=P(X4c,{$Ib:!!this.C.domain,EP:this.C.EP(),Ws:this.C.Ws,domain:this.C.C,xJ:this.C.xJ,gSb:b5c(this),iSb:D_(this,c5c(this))?"Published":"Publish",hab:this.C.Jk?d5c(this,this.J.cY()):"",ffb:this.C.Jk?e5c(this,this.F.cY()):"",locale:"en",$Qa:$4c});a.appendChild(this.Ib(),b);np(this,"Publish to the web");yp(this,null);ah(this.Ib(),"pub-dialog-content")};
p.Ia=function(){var a=this.oa(),b=a.getElement("pub-dialog-sharing-services-links");this.Ab.render(b);b=a.getElement("pub-dialog-link-options");this.J.render(b);b=a.getElement("pub-dialog-embed-options");this.F.render(b);this.Db=a.getElement("pub-dialog-links-notice");this.We.render(this.Db);b=a.getElement("pub-dialog-published-content");this.Oa.render(b);C_.ma.Ia.call(this);b=this.getHandler();var c=a.getElement("pub-dialog-dom-signin-req");c&&(this.Ra.Va(c),Vp(this.Ra,a.getElement("pub-dialog-dom-signin-req-label")),
b.R(this.Ra,"change",this.uXb));this.C.EP()&&(this.Aa.Va(a.getElement("pub-dialog-auto-publish-checkbox")),Vp(this.Aa,a.getElement("pub-dialog-auto-publish-checkbox-label")),b.R(this.Aa,"change",this.qXb));this.Bb=a.getElement("pub-dialog-link-tab-content");this.L=a.getElement("pub-dialog-document-link");this.wb=a.getElement("pub-dialog-embed-tab-content");this.O=a.getElement("pub-dialog-embed-code");Zr(this.jb,this.L);this.Ob.Va(a.getElement("pub-dialog-links-tab-bar"));this.zd=a.getElement("pub-dialog-sharing-services");
this.He=a.getElement("pub-dialog-status-info");this.qa.Va(a.getElement("pub-dialog-publish-link-button"));this.ea.Va(a.getElement("pub-dialog-publish-button"));this.$b=new zP("pub-dialog-settings-header","pub-dialog-settings-content",this.C.Jk);this.va(this.$b);b.R(this.Ob,"select",this.PCb).R(this.L,"focus",this.ySa).R(this.O,"focus",this.ySa).R(this.ea,"action",this.kSb).R(this.getElement(),"keyup",this.r$a).R(this.J,"ne",this.Ira).R(this.F,"ne",this.Ira).R(this.qa,"action",this.SAb).R(this.Oa,
"oe",this.TAb).R(this.$b,"toggle",this.yd);f5c(this)};function f5c(a){if(a.Wb()){var b=a.oa(),c=a.C.Jk,d=a.C.xJ;a.Oa.H(a.C.Nm);a.Ra.Pa(!d);a.ea.setContent(b5c(a));a.ea.Pa(a.C.Jk||!a.C.Nm||!a.C.Nm.isEmpty());a.C.EP()&&a.Aa.Ec(a.C.Aw);a.Ira();b=b.Ki("pub-dialog-state-publishing");A(b,function(a){L(a,c)});qe(a.He,c?"This document is published to the web.":"This document is not published to the web.");a.yd()}}p.r$a=function(a){this.isVisible()&&27==a.keyCode&&a.stopPropagation()};
function g5c(a,b){var c=window.location.href,d=Dk(c);c=Gk(c);var e=Qb(c,"/"+a.Zc+"/")?"/"+a.Zc:"";a.C.Ws&&a.C.domain&&(e="/a/"+a.C.domain+e);c=d[1];var f=d[2],h=d[3];d=d[4];a=a.C.F||a.kb;b=hHa.test(b)?b:Uk("/d/"+a,b);return Ck(c,f,h,d,Uk(e,b))}
p.Ira=function(){var a=this.J.dK();if(a=D_(this,a)){var b=this.J.cY();b=this.C.Jk?d5c(this,b):"";this.L.value=b;this.Ab.F=[new J4c(b,this.Pe)]}L(this.L,a);L(this.zd,a&&!this.C.xJ);a=this.F.dK();if(a=D_(this,a))b=this.F.cY(),this.O.value=this.C.Jk?e5c(this,b):"";L(this.O,a);a=D_(this,c5c(this));L(this.Db,a);this.qa.Pa(!a);this.qa.setContent(D_(this,c5c(this))?"Published":"Publish")};
p.PCb=function(a){a=a.target;this.oa();$r(this.jb);"pub-dialog-link-tab"==a.getId()?(this.Ta=0,L(this.Bb,!0),L(this.wb,!1),Zr(this.jb,this.L)):"pub-dialog-embed-tab"==a.getId()&&(this.Ta=1,L(this.Bb,!1),L(this.wb,!0),Zr(this.jb,this.O));f5c(this)};p.ySa=function(a){wi(function(){a.target.select()},0)};p.uXb=function(){this.C.Jk?h5c(this,2,!1):this.C.Ws=!this.C.Ws};p.qXb=function(){this.C.Jk?h5c(this,0,!1):this.C.Aw=!this.C.Aw};function b5c(a){return a.C.Jk?"Stop publishing":"Start publishing"}
function a5c(a,b){Cq(a.vd.Ke(a.Mc).Ef("id",a.kb),v(function(a){this.C.Jk=!!fu(a,"published");this.C.Ws=!!fu(a,"requireSignin");this.C.xJ=!!fu(a,"domainClosed");this.C.domain=A1c(a,"domain");this.C.C=A1c(a,"domainDisplay");var c=this.C;var e=Number(fu(a,"revision"));c.Aw=!e;this.C.Nm=this.LGa(a.Xe());this.C.F=A1c(a,"publishedDocumentId");b()},a)).ue()}p.LGa=Je;p.rGa=Je;function i5c(a){return{Aw:a.C.Aw,Jk:a.C.Jk,Ws:a.C.Ws,Nm:a.C.Nm}}
function h5c(a,b,c){c=u(c)?c:!0;var d=i5c(a);switch(b){case 0:d.Aw=!d.Aw;break;case 1:d.Jk=!d.Jk;break;case 2:d.Ws=!d.Ws;break;default:throw Error("Unknown toggle op: "+b);}d.Jk||(d.Nm=a.rGa());j5c(a,d,c)}
function j5c(a,b,c){k5c(a,!1);Ot(Cq(Pt(Dq(a.vd.Ke(a.Mc).Ef("id",a.kb),l5c(a,b)),2),v(function(){this.C.Aw=b.Aw;this.C.Jk=b.Jk;this.C.Ws=b.Ws;this.C.Nm=b.Nm;this.C.Jk&&this.C.Nm&&(D_(this,this.J.dK())||this.J.Opa(this.C.Nm),D_(this,this.F.dK())||this.F.Opa(this.C.Nm));k5c(this,!0);f5c(this);if(c&&this.C.Jk)switch(this.Ta){case 0:this.L.focus();this.L.select();break;case 1:this.O.focus();this.O.select();break;default:throw Error("Cannot handle selected link type "+this.Ta);}},a)),v(function(){XAa("An error occurred while saving publishing settings.",
void 0,this.Wb()?this:void 0);k5c(this,!0);f5c(this)},a)).ue()}function l5c(a,b){var c={id:a.kb,requireSignin:b.Ws,published:b.Jk};a.C.EP()&&!b.Aw&&(c.revision=a.C.D);b.Nm&&(a=m5c(b.Nm),Cc(c,a));return c}function k5c(a,b){for(var c=[a.Aa,a.ea,a.qa,a.Ra],d=0;d<c.length;d++){var e=c[d];!b&&e.Qo()&&(a.Ua=e);e.Pa(b)}b&&a.Ua&&(a.isVisible()&&a.Ua.isVisible()&&(c=a.Ua.getElement())&&c.focus(),a.Ua=null);a.Oa.J(b)}
p.kSb=function(a,b){if(b||window.confirm(this.C.Jk?"Are you sure you want to stop publishing this document?":"Are you sure you want to publish this document?"))this.ea.setContent("Saving..."),h5c(this,1)};function c5c(a){switch(a.Ta){case 0:return a.J.dK();case 1:return a.F.dK();default:throw Error("Cannot handle selected link type "+a.Ta);}}
p.SAb=function(){if(window.confirm("Are you sure you want to publish this selection?")){var a=c5c(this),b=i5c(this);b.Jk=!0;a&&(b.Nm&&this.C.Jk?b.Nm=n5c(b.Nm,a):b.Nm=a);this.qa.setContent("Publishing...");j5c(this,b,!0)}};p.TAb=function(){var a=this.Oa.F();if(this.C.Jk)if(a&&a.isEmpty())h5c(this,1);else{var b=i5c(this);b.Nm=a;j5c(this,b)}else this.C.Nm=a,f5c(this)};function D_(a,b){return a.C.Jk&&(!b||!a.C.Nm||a.C.Nm.tJb(b))}
function Y4c(a){this.D=a;this.xJ=this.Ws=this.Jk=!1;this.Aw=!0;this.F=this.C=this.domain=""}Y4c.prototype.EP=function(){return!!this.D};function Z4c(){nV.call(this)}y(Z4c,nV);Z4c.prototype.Hj=function(a){return a.keyCode&&27==a.keyCode?!1:Z4c.ma.Hj.call(this,a)};function o5c(a){a='<span class="pub-dialog-chart-notice-emphasis">Note:</span> Viewers may be able to access the underlying data for published charts. '+('<a target="_blank" href="https://docs.google.com/support/bin/answer.py?hl='+E1c(a.locale)+'&answer=183965#publishcharts">Learn more</a>');return R(""+('<div class="pub-dialog-chart-notice">'+a+"</div>"))};function p5c(a,b,c,d){this.F=a;this.hh=b;this.C=c;this.D=d}function q5c(a,b){return new p5c(!1,null,new r5c(a,b||"interactive"),null)}function r5c(a,b){this.id=a;this.format=b};function E_(a,b,c){this.F=a;this.D=new Xq(b);this.C=c}p=E_.prototype;p.tJb=function(a){return this.F||!a.F&&$a(a.D.Cd(),this.J8,this)&&$a(a.C,this.x8,this)};p.J8=function(a){return this.F||this.D.contains(a)};function s5c(a,b){return Za(a.C,function(a){return a.id==b.id})}p.x8=function(a){return this.F||this.D.contains(a.hh)||s5c(this,a)};function t5c(a,b){a.C=Va(a.C,function(a){return a.hh!=b})}function u5c(a,b){s5c(a,b)&&(a.C=Va(a.C,function(a){return a.id!=b.id}))}
function n5c(a,b){var c=a.F||b.F;if(c)return new E_(c,[],[]);var d=a.clone();A(b.D.Cd(),function(a){d.D.contains(a)||(d.D.add(a),t5c(d,a))});A(b.C,function(a){d.x8(a)||d.C.push(a)});return d}function m5c(a){return a.F?{entireDocument:"true"}:{entireDocument:"false",sheets:a.D.Cd().join(","),charts:Wa(a.C,function(a){return a.id}).join(",")}}p.isEmpty=function(){return!this.F&&this.D.isEmpty()&&eb(this.C)};p.clone=function(){return new E_(this.F,this.D.Cd(),nb(this.C))};
p.equals=function(a){return this.F==a.F&&this.D.equals(a.D)&&xb(this.C,a.C,function(a,c){return a.id==c.id&&a.hh==c.hh})};function v5c(a,b){this.id=a;this.hh=b};function w5c(a,b,c,d){N.call(this,void 0);this.C=c||new p5c(!0,null,null,"html");this.J=d;this.O=a;this.L=b;this.D=new ON("",x5c(a,b));SR(this.D,!0);this.Ha(this.D,!0);a=new mk;a.Ha(new hk("Interactive","interactive"),!0);a.Ha(new hk("Image","image"),!0);this.H=new ON("",a);this.Ha(this.H,!0);a=new mk;a.Ha(new hk("Web page","html"),!0);a.Ha(new hk("Comma-separated values (.csv)","csv"),!0);a.Ha(new hk("Tab-separated values (.tsv)","tsv"),!0);a.Ha(new hk("PDF document (.pdf)","pdf"),!0);a.Ha(new hk("Microsoft Excel (.xlsx)",
"xlsx"),!0);a.Ha(new hk("OpenDocument spreadsheet (.ods)","ods"),!0);this.F=new ON("",a);this.Ha(this.F,!0);y5c(this)}y(w5c,B_);var z5c=["xlsx","ods"],A5c=["csv","tsv"];
function x5c(a,b){var c=new mk;c.Ha(new hk("Entire Document",new B5c("entireDocument",null)),!0);c.Ha(new lk,!0);var d=cob(b);A(a.D,function(a){c.Ha(new hk(a.pe(),new B5c("sheet",a.yb())),!0);if(a=d[a.yb()])for(var b={},e=0;e<a.length;b={$V:b.$V},e++){var k=a[e];6==k.getType()&&k.isSaved()&&(b.$V=new hk("",new B5c("chart",lJ(k))),Lnb(k).then(function(a){return function(b){a.$V.Cn(b.getTitle())}}(b)),c.Ha(b.$V,!0),ah(b.$V.Ib(),"pub-dialog-link-options-chart-menu-item"))}});return c}p=w5c.prototype;
p.Ia=function(){w5c.ma.Ia.call(this);ah(this.getElement(),"pub-dialog-link-options-container");ah(this.D.getElement(),"pub-dialog-link-options-document-part-menu-button");ah(this.D.Ib(),"pub-dialog-link-options-document-part-menu-button-content");ah(this.D.Bc().getElement(),"pub-dialog-link-options-document-part-menu");ei(this.D.Da,"Sheet or chart selection");ei(this.H.Da,"Chart format");ei(this.F.Da,"Sheet format");this.getHandler().R(this.D,"change",this.$qb).R(this.H,"change",this.Tnb).R(this.F,
"change",this.yDb).R(this.D,"afterhide",function(a){a.stopPropagation()}).R(this.H,"afterhide",function(a){a.stopPropagation()}).R(this.F,"afterhide",function(a){a.stopPropagation()})};p.$qb=function(){var a=this.D.jf().Sa();switch(a.type){case "entireDocument":this.C=new p5c(!0,null,null,this.C.D||"html");break;case "sheet":a=a.id;var b=this.C.D;b&&!C5c(this,a,b)&&(b=null);this.C=new p5c(!1,a,null,b||"html");break;case "chart":this.C=q5c(a.id,this.C.C?this.C.C.format:null)}y5c(this);V4c(this)};
p.Tnb=function(){var a=this.H.jf().Sa();this.C.C&&(this.C.C.format=a,V4c(this))};p.yDb=function(){var a=this.F.jf().Sa();this.C.D=a;V4c(this)};
function y5c(a){var b=nb(a.D.Pj.C);b=ab(b,function(a){a=a.Sa();if(!a)return!1;switch(a.type){case "entireDocument":return this.C.F;case "sheet":return null!=this.C.hh&&a.id==this.C.hh;case "chart":return null!=this.C.C&&a.id==this.C.C.id;default:return!1}},a);Br(a.D,b);b=!!a.C.C;L(a.H.getElement(),b);null!=a.C.C&&a.H.Qa(a.C.C.format);L(a.F.getElement(),a.J&&L0a&&!b);b||(D5c(a),a.F.Qa(a.C.D))}
function D5c(a){for(var b=a.F.Bc(),c=0;c<b.ej();c++){var d=b.Se(c),e=d.Ma();d.Pa(null==a.C.hh||C5c(a,a.C.hh,e))}}function C5c(a,b,c){if(db(z5c,c))return!1;a=YF(a.O,b);return null!=a&&1==a.getSheetType()&&db(A5c,c)?!1:!0}p.cY=g("C");p.dK=function(){if(this.C.F)return new E_(!0,[],[]);if(null!=this.C.hh)return new E_(!1,[this.C.hh],[]);var a=this.L.C(this.C.C.id);a=new v5c(this.C.C.id,a.yb());return new E_(!1,[],[a])};
p.Opa=function(a){if(!a.F){var b=a.D.Cd();0<b.length?this.C=new p5c(!1,b[0],null,"html"):(a=a.C,0<a.length&&(this.C=q5c(a[0].id)));y5c(this)}};function B5c(a,b){this.type=a;this.id=b};function F_(a,b){rr.call(this,void 0,void 0,new NN,void 0);this.Ga=a;this.ea=b;this.F=new E_(!0,[],[]);this.V=!1;this.H=new xP("Entire Document");this.Pd(this.H);this.Pd(new lk);E5c(this);SR(this,!0);F5c(this)}y(F_,rr);
function E5c(a){var b=cob(a.ea);A(a.Ga.D,function(c){var d=new xP(c.pe(),c);a.Pd(d);(c=b[c.yb()])&&A(c,function(b){if(6==b.getType()&&b.isSaved()){var c=new xP("",b);Lnb(b).then(function(a){c.Cn(a.getTitle())});a.Pd(c);ah(c.Ib(),"pub-dialog-published-content-chart-menu-item")}})})}
F_.prototype.Ia=function(){F_.ma.Ia.call(this);ah(this.getElement(),"pub-dialog-published-content-menu-button");ah(this.Ib(),"pub-dialog-published-content-menu-button-content");ah(this.Bc().getElement(),"pub-dialog-published-content-menu");this.getHandler().R(this,"afterhide",function(a){a.stopPropagation()})};
F_.prototype.Gs=function(a){if(a.target==this.H){a=this.H.isChecked();var b=this.F;if(b.F=a)b.D.clear(),b.C=[]}else b=a.target,a=b.isChecked(),b=b.Sa(),b instanceof oE?(b=b.yb(),a?(a=this.F,a.D.contains(b)||(a.D.add(b),t5c(a,b))):(a=this.F,a.D.contains(b)&&(a.D.remove(b),t5c(a,b)))):(b=new v5c(lJ(b),b.yb()),a?(a=this.F,a.x8(b)||a.C.push(b)):u5c(this.F,b));this.V=!0;F5c(this)};F_.prototype.qe=function(a,b){F_.ma.qe.call(this,a,b);!a&&this.V&&(this.V=!1,this.dispatchEvent(new E("oe")))};
function F5c(a){var b=a.F.F;a.H.Ec(b);A(auc(a.Bc()),function(c){var d=c.Sa();d&&(d instanceof oE?(c.Ec(a.F.J8(d.yb())),c.Pa(!b)):(d=new v5c(lJ(d),d.yb()),c.Ec(a.F.x8(d)),c.Pa(!a.F.J8(d.hh))))});G5c(a)}
function G5c(a){if(a.F.F)a.setContent("Entire Document");else{var b=Va(a.Ga.D,v(function(a){return this.F.J8(a.yb())},a)),c=Wa(b,function(a){return a.pe()});b=[];for(var d=a.F.C,e=0;e<d.length;e++){var f=a.ea.C(d[e].id);f&&b.push(Lnb(f))}z1c(b).then(function(b){for(var d=[],e=0;e<b.length;e++){var f=b[e];f.pFa&&d.push(f.value.getTitle())}b=mb(c,d);b=0<b.length?b.join(", "):"None";a.setContent(b)})}};function G_(a,b){N.call(this,void 0);this.C=new F_(a,b);this.Ha(this.C,!0);this.D=!1}y(G_,W4c);G_.prototype.Ia=function(){G_.ma.Ia.call(this);ah(this.getElement(),"pub-dialog-published-content-container")};G_.prototype.F=function(){return this.C.F};G_.prototype.H=function(a){var b=this.C;b.F=a.clone();F5c(b)};G_.prototype.J=function(a){!a&&this.C.Qo()&&(this.D=!0);this.C.Pa(a);a&&this.D&&(this.Wb()&&(a=this.C.getElement())&&a.focus(),this.D=!1)};function H5c(a,b,c,d,e,f,h){var k=null!=h?q5c(h):null;h=new w5c(c,d,k,!0);k=new w5c(c,d,k,!1);C_.call(this,a,b,e,n0a,f,h,k,new G_(c,d),"/publishingsettings",new I5c);this.Af=c;this.Ac=d}y(H5c,C_);
H5c.prototype.LGa=function(a){if(a.entireDocument)return new E_(!0,[],[]);var b=a.charts||"";a=Wa((a.sheets||"").split(","),function(a){return parseInt(a,10)});a=Va(a,function(a){return null!=YF(this.Af,a)},this);b=Wa(b.split(","),function(a){return parseInt(a,10)});b=Va(b,v(function(a){return!!this.Ac.C(a)},this));b=Wa(b,function(a){var b=this.Ac.C(a);return new v5c(a,b.yb())},this);return new E_(!1,a,b)};H5c.prototype.rGa=function(){return new E_(!0,[],[])};
function d5c(a,b){if(b.F||null!=b.hh){var c="html"==b.D;a=g5c(a,c?"/pubhtml":"/pub");null!=b.hh&&(a=Lk(a,"gid",b.hh,"single","true"));c||(a=Lk(a,"output",b.D))}else a=Lk(g5c(a,"/pubchart"),"oid",b.C.id,"format",b.C.format);return a}
function e5c(a,b){var c=d5c(a,b);if(b.F||null!=b.hh)c=Lk(c,"widget","true","headers","false");a=b.C?(a=a.Ac.C(b.C.id))?a.ad():null:null;return"<iframe "+(a?'width="'+a.width+'" height="'+a.height+'" seamless frameborder="0" scrolling="no" ':"")+'src="'+Ob(c)+'"></iframe>'}function I5c(){}y(I5c,N);I5c.prototype.xa=function(){this.Da=P(o5c,{locale:"en"})};function J5c(){B.call(this)}y(J5c,TA);p=J5c.prototype;p.pgb=function(){return I3c};p.Jgb=function(){return d3c};p.zMb=function(a,b,c,d){var e=new Bq;a=new xq(a,b,c,d,void 0,!0,void 0);yq(a,"ok");b=v(e.Va,e);a.jma=b;a.va(e);a.ij=!0;a.W6=xda(Jb);return a};p.tib=function(){return X2c};p.G7a=function(a,b,c,d,e,f){return new C3c(a,b,c,d,e,f,void 0)};p.Sgb=function(){return p2c};p.gGa=function(){return B2c};p.ihb=function(){return L2c};p.yib=function(){return u_};p.xib=function(){return H5c};p.eib=function(){return K3c};
p.wib=function(){return g3c};p.Ngb=function(){return h4c};p.uib=function(){return e4c};p.vib=function(){return F4c};p.Mgb=function(){return k_};aB("dialogs",J5c);
