xW.prototype.SSa=ER(212,function(a){this.J=pb(arguments,0)});var cHc=[2];function dHc(a){Sf(this,a,0,-1,cHc,null)}y(dHc,Rf);function LX(a){Sf(this,a,0,-1,null,null)}y(LX,Rf);var eHc=[1,2];function fHc(a){Sf(this,a,0,-1,eHc,null)}y(fHc,Rf);var gHc=[1];function hHc(a){Sf(this,a,0,-1,gHc,null)}y(hHc,Rf);var iHc=[1];function jHc(a){Sf(this,a,0,-1,iHc,null)}y(jHc,Rf);var kHc=[1];function lHc(a){Sf(this,a,0,-1,kHc,null)}y(lHc,Rf);var mHc=[3];function nHc(a){Sf(this,a,0,-1,mHc,null)}y(nHc,Rf);
nHc.prototype.getChartType=function(){return G(this,1)};function MX(a){Sf(this,a,0,-1,null,null)}y(MX,Rf);function oHc(a){Sf(this,a,0,-1,null,null)}y(oHc,Rf);function pHc(a){Sf(this,a,0,-1,null,null)}y(pHc,Rf);pHc.prototype.getChartType=function(){return G(this,1)};function qHc(a){Sf(this,a,0,-1,null,null)}y(qHc,Rf);qHc.prototype.nf=function(){return G(this,2)};function NX(a,b){return W(a,2,b)}
function rHc(a,b,c,d,e){return K4b(a,v(function(){return this.C.calculateArrayFormulaResultPreview(b,c,d,e,!1,this.J,!0)},a))}function sHc(a){var b=0;A(a,function(c,d){c.length>a[b].length&&(b=d)});return Wa(a[b],function(b,d){return Wa(a,function(a){return a[d]})})}function tHc(a){a=WI(a.D);return null!=a?a.toString():"0"}
function uHc(a,b){var c={row:0,sj:0};ritz_api.RitzModelApi.getActiveFilterId(a)&&b&&(b=b.rect,ritz_api.RitzModelApi.getNumberOfRows(a)>b.Uc()+1?c.row=b.Uc()+1:ritz_api.RitzModelApi.getNumberOfColumns(a)>b.Wc()+1&&(c.sj=b.Wc()+1));return c}function vHc(a,b,c,d){b="="!=b[0]?"="+b:b;var e=tHc(a);c=uHc(e,c);(a=rHc(a.C,b,e,c.row,c.sj))&&d&&a.length<a[0].length&&(a=sHc(a));return a}
function wHc(a){if(a)for(var b=1<a.length?1:0;b<a.length;b++){for(var c=!1,d=a[b],e=0;e<d.length;e++)if(!d[e]){c=!0;break}if(!c)return!0}return!1}function xHc(a,b){eh(a.Da,"waffle-autovis-lightbox-readonly",b);a.D.setVisible(!b)}var yHc={JCc:0,$xa:1,Bya:2};function zHc(a){return sc(Cvc,function(b){return b.match(a)}).getName()}
function OX(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){do var f=Math.floor(Math.random()*a);while(d[f]);d[f]=1;c.push(f)}else{for(d=0;d<a;d++)c.push(d);for(d=0;d<b;d++)e=Math.floor(Math.random()*(a-d)+d),f=c[d],c[d]=c[e],c[e]=f}return c.slice(0,b)}function PX(a){return a[OX(a.length,1)[0]]}function AHc(a){var b={};A(a,function(a){b[a]||(b[a]=0);b[a]++});qb(a);vb(a,function(a,d){return b[d]-b[a]})}
function BHc(){return R('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret" tabindex="0"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function CHc(a,b,c){b=c||b;return R(""+Q(lr({Ed:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:gq(""+Q(hs({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+Q(lr({Ed:"waffle-assistant-zoom-button",content:gq(""+Q(hs({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b))+"")}function QX(){}y(QX,ir);va(QX);QX.prototype.tc=n("waffle-assistant-button");function DHc(a,b,c){b=c||b;a=bq("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<div class="waffle-assistant-answers-search-icon">'+Q(hs({icon:"docs-icon-img docs-icon-search-this-document"},b))+'</div><input type="text" class="waffle-assistant-answers-input-box" placeholder="'+T(a)+'" aria-label="'+T(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');
a+='<div class="'+T("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+'">'+Q(hs({icon:"docs-icon-img docs-icon-cancel"},b))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="display:none"></div></div></form></div>';return R(a)};function RX(a){N.call(this,a);this.D=new kr("",new QX,this.oa());this.Ha(this.D);this.F=new qW(!1,"#4285f4");this.Ha(this.F);this.C=this.J=this.H=null}r(RX,N);RX.prototype.xa=function(){this.Ad(P(DHc))};RX.prototype.Ad=function(a){N.prototype.Ad.call(this,a)};
RX.prototype.Ia=function(){N.prototype.Ia.call(this);var a=this.oa();this.C=a.La("waffle-assistant-answers-query-box",this.Da);this.D.Va(a.La("waffle-assistant-answers-clear-query-button",this.C));this.H=a.La("waffle-assistant-answers-spinner-container",this.C);this.F.render(this.H);this.J=a.La("waffle-assistant-answers-input-box",this.C)};RX.prototype.setVisible=function(a){this.getElement()&&(L(this.getElement(),a),(a=ut)&&a.dispatchEvent("resize"))};function EHc(a,b,c,d,e,f){E.call(this,"sqc");this.$=a;this.F=f||"";this.V=b;this.J=d;this.Aa=e;this.C=c}y(EHc,E);function FHc(a,b,c,d,e,f,h){d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;h=void 0===h?null:h;E.call(this,"answers-submit-query");this.C=a;this.$=b;this.V=c;this.J=d;this.Aa=e;this.F=f;this.Ga=h}y(FHc,E);function GHc(){this.F=[];this.D={};this.J=null;this.C=new Kv}function HHc(a,b,c,d){function e(a){return a.toLowerCase()}qb(b,void 0,e);qb(c,void 0,e);qb(d,void 0,e);A(b,a.H,a);A(c,a.H,a);A(d,a.H,a)}GHc.prototype.H=function(a){var b=a.toLocaleLowerCase(),c=0;if(100>b.length)for(var d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,f=b.substr(d),h=this.C.get(f);h||(h=[],this.C.add(f,h));h.push(e)}};
function IHc(a,b){a.D[b.toLowerCase()]||(a.D[b.toLowerCase()]=b)}GHc.prototype.gH=function(a,b,c){if(Lb(a||"")){var d=this.J.Em();d=JHc(this,a.substring(0,d));var e=KHc(this,b-d.length,a);d=mb(d,e)}else d=KHc(this,b);d.length>b&&(d=pb(d,0,b));c(a,d)};
function KHc(a,b,c){var d=c||"";c=ic(a.D,function(a){return Fb(a,d)});var e=LHc(nc(c),d?1:2,1);a=Va(a.F,function(a){return Fb(a.query,d)&&!e[a.query.toLowerCase()]});b=LHc(a,b-mc(e),2);b=nc(b);var f=Wa(b,function(a,b){a.hra=b;return a.BUa});A(b,function(a){a.dra=f});return mb(b,nc(e))}
function JHc(a,b){for(var c=[],d=3,e={},f=b.toLowerCase(),h={},k=0;k<f.length&&0<d;h={Saa:h.Saa,y_:h.y_,pS:h.pS},++k)if(0==k||" "==f[k-1]&&" "!=f[k]){h.pS={};h.y_=0;h.Saa=f.substr(k);var l=a.C.Me(h.Saa);A(l,function(b){return function(c){var d=c.length-b.Saa.length;b.y_=Math.max(d,b.y_);c=a.C.get(c);b.pS[d]||(b.pS[d]=[]);ob(b.pS[d],c)}}(h));for(l=0;l<=h.y_&&0<d;++l){var m=h.pS[l];if(m)for(var q=0;q<m.length&&0<d;++q){var t=m[q];Qb(b.toLowerCase(),t.toLowerCase())||e[t]||(--d,c.push({text:t,Xm:"",
qA:0,oAa:f.length-k,BUa:void 0,dra:[],hra:-1}),e[t]=!0)}}}return c}function LHc(a,b,c){b=OX(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=na(b)?b:b.query;d[e.toLowerCase()]={text:e,Xm:na(b)?"":b.Xm,qA:c,oAa:0,BUa:na(b)?void 0:b.type,dra:[],hra:-1}});return d};function SX(){UN.call(this,"",null,!1)}y(SX,UN);SX.prototype.jD=function(a,b){if(2==a.qA||1==a.qA)return SX.ma.jD.call(this,a.text,b);var c=this.Ma(),d=this.Em(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var f=c.substring(0,d-a.oAa)+a.text;e||(f+=" ");a=SX.ma.jD.call(this,{toString:function(){return f+c.substring(d)}},b);b=this.gk;b.blur();b.focus();this.u0(f.length);return a};
SX.prototype.Vf=function(a){var b=SX.ma.Vf.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,fIb(b)&&b.gC()&&a.preventDefault(),b=!0);return b};function MHc(a,b,c){b=c||b;return R('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+Q(hs({icon:"docs-icon-img docs-icon-help"},b))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+Q(hs({icon:"docs-icon-img docs-icon-clock"},b))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+Q(hs({icon:"docs-icon-img docs-icon-arrow-tilted"},b))+
'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')};function NHc(a){this.pb=a||Kd()}
NHc.prototype.Bu=function(a,b,c){b=P(MHc);var d=this.pb.La("waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.pb.Te(d,a.text);d=this.pb.La("waffle-assistant-answers-ac-entity-icon",b);var e=this.pb.La("waffle-assistant-answers-ac-suggested-query-icon",b),f=this.pb.La("waffle-assistant-answers-ac-session-query-icon",b);L(d,0==a.qA);L(e,2==a.qA);L(f,1==a.qA);d="";switch(a.qA){case 0:d="waffle-assistant-answers-ac-row-entity";break;case 1:d="waffle-assistant-answers-ac-row-session-query";break;
case 2:d="waffle-assistant-answers-ac-row-suggested-query"}d&&ah(c,d);this.pb.appendChild(c,b)};function TX(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Lb(b),Oi(a,b,void 0),Zuc(a),a.setAttribute("data-tooltip-delay",500),Qac(a,u(c)?c:1))};function OHc(a){var b=a.type;switch(na(b)&&b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":b=[];for(var c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return null!=a.value?a.value:null}}
function PHc(a,b){var c=a.type;switch(na(c)&&c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(na(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":na(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,f=0;e=b[f];f++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}};function QHc(a,b,c,d){B.call(this);this.O=a;this.D=a.J;this.F=a.D;this.L=a.C;this.H=new SX;this.H.rFa=!0;this.H.Ga=!0;this.va(this.H);this.V=c;this.V.J=this.H;a=new TN(null,new NHc(a.oa()));this.C=new QN(this.V,a,this.H);this.va(this.C);this.ea=b;this.J=!1;this.$=jj(new ij,d).build();this.Ka=new hh(this);this.va(this.Ka);RHc(this)}r(QHc,B);
function RHc(a){SHc(a);a.H.C=a.C;a.C.tY=!1;a.C.m9=6;BIb(a.H,a.D);TX(a.F.getElement(),"Clear query");a.Ka.R(a.C,"update",a.Bmb).R(a.L,"submit",a.lLb).R(a.L,"focus",function(){return THc(a,!0)},!0).R(a.L,"blur",function(){return THc(a,!1)},!0).R(a.F,"action",a.I6a).R(a.D,"input",a.CVa).R(a.D,"focus",a.YRa);a.F.setVisible(!1)}p=QHc.prototype;p.Fa=function(){B.prototype.Fa.call(this);this.V.J=null};function UHc(a,b,c){c=void 0===c?!1:c;PHc(a.D,b);c&&a.D.focus();a.CVa()}
function SHc(a){a=a.C.Md();a.className="waffle-assistant-answers-ac-renderer";a.hM="waffle-assistant-answers-ac-row";a.U2="waffle-assistant-answers-ac-active";a.Pla="waffle-assistant-answers-ac-highlighted"}p.Bmb=function(a){a.row&&(a=a.row,2==a.qA?(VHc(this,1,a.dra,a.hra,a.Xm,2),this.ea.Xb(2652,this.$)):0==a.qA?(this.J=!0,this.ea.Xb(2651,this.$)):1==a.qA&&VHc(this,3))};function THc(a,b){eh(a.L,"waffle-assistant-answers-query-box-focused",b);RN(a.C)&&!b&&a.C.Th()}p.CVa=function(){this.F.setVisible(!!OHc(this.D))};
p.YRa=function(){this.C.fw(this.D);var a=Yb(OHc(this.D));this.H.u0(a.length);cIb(this.C,a||"  ");this.C.update(!0)};p.lLb=function(a){a.stopPropagation();a.preventDefault();VHc(this,2)};function VHc(a,b,c,d,e,f){c=void 0===c?null:c;d=void 0===d?null:d;e=void 0===e?null:e;f=void 0===f?null:f;var h=Lb(OHc(a.D));a.F.setVisible(!!h);WHc(a);a.O.dispatchEvent(new FHc(b,h,a.J,c,d,e,f));a.J=!1}p.I6a=function(){PHc(this.D,"");this.F.setVisible(!1)};function WHc(a){a.D.blur();RN(a.C)&&a.C.Th()};function XHc(a,b){N.call(this,b);this.F=a;this.H=new GHc;this.C=new RX(this.oa());this.Ha(this.C);this.D=null}r(XHc,N);XHc.prototype.Ad=function(a){N.prototype.Ad.call(this,a);this.C.render(a)};XHc.prototype.Ia=function(){N.prototype.Ia.call(this);this.D=new QHc(this.C,this.F,this.H,4);this.va(this.D);ah(this.C.Da,"waffle-assistant-answers-input-with-icon")};function UX(a,b,c,d,e,f){E.call(this,a,b);this.C=b;this.Aa=c;this.$=d||null;this.Ga=e||null;this.Ja=f||null}y(UX,E);UX.prototype.dj=g("Aa");function YHc(a,b,c,d,e,f,h){h=void 0===h?null:h;UX.call(this,"Ld",null,d,e,f);this.J=a;this.V=b;this.Fc=c;this.F=h}y(YHc,UX);YHc.prototype.Od=g("Fc");function ZHc(a,b,c){UX.call(this,"Od",null,2859);this.J=a;this.V=b;this.F=c}y(ZHc,UX);function $Hc(a,b,c,d,e,f,h,k){N.call(this,k);this.H=a;this.D=b;this.L=e;this.O=f;this.F=h;this.C=this.Fc=null;this.J=jj(new ij,10).build()}y($Hc,N);p=$Hc.prototype;p.Ia=function(){$Hc.ma.Ia.call(this);(new pV(dK,this.D.dg())).send(v(this.Vpb,this,this.D))};p.DJa=function(a,b){a=new YHc(this.H.clone(),this.L,this.Fc,2746,a,b);this.dispatchEvent(a)};p.Vpb=function(a,b){b&&(b.ai()?PJ.lE(this.Da,b):(b=b.Od(),a.sf(b),LV(a,b),QJ(a,"ready",v(this.d2b,this,a)),iW(a,this.Da,this.O,this.F,LA),this.Fc=b))};
p.d2b=function(a){a.Hl()&&(QJ(a.Hl(),"onmouseover",v(this.b2b,this)),QJ(a.Hl(),"onmouseout",v(this.c2b,this)))};p.b2b=function(){this.C=Ha()};p.c2b=function(){pa(this.C)&&500<Ha()-this.C&&this.F.Xb(2750,this.J);this.C=null};function aIc(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(Q(a.Q6a)+"</span>"),d=0==a.HEa.length;b+='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(d)c=R('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">';a=a.HEa;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';c=h?c+Q(h):c+"(empty)";c+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}c=R(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+(d?" waffle-assistant-facet-white-section":
"")+'">'+c+(GA?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return R(b)};function bIc(){return R('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function cIc(a,b){N.call(this,b);this.D=a;this.C=new kr("",new sW,this.oa());this.Ha(this.C)}y(cIc,N);p=cIc.prototype;p.xa=function(){this.Da=P(bIc)};p.Ia=function(){cIc.ma.Ia.call(this);var a=this.La("waffle-assistant-feedback-card-link");this.C.Va(a);this.getHandler().R(this.Da,"mousedown",this.s2b).R(this.C,"action",this.Dsb);this.show(!1)};p.s2b=function(a){a.stopPropagation()};
p.show=function(a){var b=this.Da,c=this.La("waffle-assistant-feedback-card-link");eh(b,"waffle-assistant-feedback-card-hidden",!a);se(c,a)};p.Dsb=function(){K.Ou.wc({source:this.D});this.show(!1);this.dispatchEvent(new E("feedback-dialog-opened"))};function dIc(a,b,c){b=c||b;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+Q(hs({icon:"docs-icon-img docs-icon-thumb-up"},b))+'</div><div class="waffle-assistant-thumbs-down-button">'+Q(hs({icon:"docs-icon-img docs-icon-thumb-down"},b))+"</div></div></div>");return R(a)};function VX(a){N.call(this,a);this.C=new kr("",new QX,this.oa());this.Ha(this.C);this.D=new kr("",new QX,this.oa());this.Ha(this.D)}y(VX,N);VX.prototype.xa=function(){this.Da=P(dIc)};VX.prototype.Ia=function(){VX.ma.Ia.call(this);var a=this.La("waffle-assistant-thumbs-down-button");this.C.Va(a);TX(a,"Not useful");a=this.La("waffle-assistant-thumbs-up-button");this.D.Va(a);TX(a,"Useful");this.getHandler().R(this.C,"action",this.F).R(this.D,"action",this.H)};
function eIc(a,b){a.oa().Te(a.La("waffle-assistant-thumbs-text"),b)}VX.prototype.F=function(){this.dispatchEvent(new E("thumbs-down"));L(this.Da,!1)};VX.prototype.H=function(){this.dispatchEvent(new E("thumbs-up"));L(this.Da,!1)};function fIc(a,b,c,d,e,f){N.call(this,f);this.J=a;this.Ja=b;this.Na=c;this.Aa=d;this.qa=e;this.L=Zv(this.J,23);this.Ga=W(this.J,22);this.C=W(this.J,26);this.ea=[];this.Sc=new dw;this.O=this.F=this.D=null;this.V=!1;this.$=new mr("",this.oa());this.Ha(this.$);this.H=null}y(fIc,N);p=fIc.prototype;p.xa=function(){fIc.ma.xa.call(this);this.Da=P(aIc,{Q6a:this.C,HEa:this.L});this.Da.style.visibility="hidden"};
p.Ia=function(){fIc.ma.Ia.call(this);var a=this.La("waffle-assistant-facet-toggle");this.$.Va(a);this.getHandler().R(this.Da,"mousedown",this.Z1b).R(this.$,"action",this.JFb);GA&&(this.O=new cIc("assistantAutovisFacetFeedback",this.oa()),this.O.render(this.La("waffle-assistant-facet-feedback-container")),this.D=new VX(this.oa()),this.Ha(this.D),this.D.render(this.La("waffle-assistant-facet-thumbs-container")),eIc(this.D,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().R(this.D,
"thumbs-up",this.a2b).R(this.D,"thumbs-down",this.$1b));gIc(this,$0a)};p.Gd=g("V");p.Z1b=function(a){a.stopPropagation()};p.JFb=function(){var a=$g(this.La("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");gIc(this,a);hIc(this,a?2647:2646)};
function gIc(a,b){var c=a.La("waffle-assistant-facet-toggle");qe(c,b?"HIDE":"SHOW");eh(a.La("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);A(a.Ki("waffle-assistant-faceted-chart"),function(a){se(a,b)});a.D&&L(a.D.Da,b);var d='Show chart broken down by "'+(a.C+'"');a='Hide chart broken down by "'+(a.C+'"');TX(c,b?a:d)}
function iIc(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function jIc(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function kIc(a){a.V||A(a.ea,v(function(a){var b=a.Da;if(!this.qa.contains(b)){var d=this.qa;a=new lIc(b,a);Ryb(d,a)}},a))}p.a2b=function(){hIc(this,2649)};p.$1b=function(){hIc(this,2648);this.O.show(!0)};function hIc(a,b){var c=a.Aa,d=new fW,e=a.H.getChartType();d.C=e;e=a.H.Od();d.F=e?e.clone():null;hW(c,b,d,10,a.H,a.H.dg())};function mIc(){return R('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function nIc(a,b,c){b=c||b;return R(""+Q(lr({Ed:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:gq(""+Q(hs({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+Q(lr({Ed:"waffle-assistant-zoom-button",content:gq(""+Q(hs({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b))+"")};var oIc={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}};function pIc(a){var b=new ZJ(Ac(oIc));return NAc(a,b)}
function qIc(a,b){a.setOption("legend.position","none");a.setOption("hAxis.slantedText",!1);a.setOption("hAxis.textStyle.fontSize",11);a.setOption("vAxes.0.textStyle.fontSize",11);a.setOption("vAxes.1.textStyle.fontSize",11);a.setOption("fontStyle.size",10);a.setOption("fontStyle.italic",!1);a.setOption("titleTextStyle.bold",!1);a.setOption("titleTextStyle.fontSize",12);a.setOption("async",40);!1!==a.xc("useFirstColumnAsDomain")&&a.Od()&&"number"===a.Od().dd(0)&&a.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==a.xc("useFirstColumnAsDomain")&&a.Od()&&"string"===a.Od().dd(0)){c=0;var d=Xd("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";b.appendChild(d);for(b=0;b<a.Od().getNumberOfRows();b++)qe(d,a.Od().Df(b,0)),c=Math.max(c,Ph(d).width);ge(d);c=Math.min(27,Math.max(15,10+100*c/271))}KA&&JA||LA||(a.setOption("chartArea.top","15%"),b=a.xc("hAxis.title"),a.setOption("chartArea.height",Jb(Yb(b))?"80%":"65%"),a.setOption("chartArea.left",c+"%"),a.setOption("chartArea.width",
95-c+"%"),"PieChart"==a.getChartType()&&(a.setOption("chartArea.top",Jb(Yb(a.xc("title")))?"12%":"15%"),a.setOption("chartArea.height","70%"),a.setOption("chartArea.left","0%"),a.setOption("chartArea.width","100%"),a.setOption("pieSliceText","none"),a.setOption("legend.position","labeled"),a.setOption("legend.textStyle.fontSize",10)));return a};function rIc(){return R('<div class="waffle-assistant-card" tabindex="0" role="region">'+(GA?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(GA?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function WX(a,b){var c=this;N.call(this,b);this.F=a;this.Ga=this.Aa=this.qa=null;this.Bb=new qW(!0,"#4285f4");this.Ha(this.Bb);this.Ob=this.Zc=this.we=!1;this.Ta=new zi(function(){c.Ta.stop();c.Da.parentNode.querySelector(":hover")==c.Da?c.Ta.start():c.fR()},100);this.va(this.Ta);this.Wf=this.Mc=!1}y(WX,N);p=WX.prototype;p.AA=He;p.c8=Ie;p.WB=Je;p.VB=Je;p.j6=Je;p.hja=Je;p.gja=Je;p.iy=da("Wf");p.Gd=g("Wf");p.xa=function(){this.Da=P(rIc)};
p.Ia=function(){WX.ma.Ia.call(this);var a=this.La("waffle-assistant-card-spinner-container");this.Bb.render(a);ph(this.La("waffle-assistant-card-inner"),"visibility","hidden");if(this.AA()){a=this.Da;var b=new kp(a);this.va(b);this.getHandler().R(b,"focusin",this.wnb).R(b,"focusout",this.vnb).R(a,"mouseenter",this.bZ).R(a,"mouseleave",this.fR)}sIc(this,!1);GA&&(this.Ga=new cIc(this.jz(),this.oa()),this.Ga.render(this.La("waffle-assistant-card-feedback-container")),this.getHandler().R(this.Ga,"feedback-dialog-opened",
this.Esb).R(this,"trigger_feedback",this.GXb),this.c8()?(this.Aa=new VX(this.oa()),this.Aa.render(this.La("waffle-assistant-thumbs-container")),tIc(this,!0),a=Yb(this.j6()),Jb(a)||eIc(this.Aa,a),a=Yb(this.hja()),Jb(a)||TX(this.Aa.La("waffle-assistant-thumbs-up-button"),a),a=Yb(this.gja()),Jb(a)||TX(this.Aa.La("waffle-assistant-thumbs-down-button"),a),this.getHandler().R(this.Aa,"thumbs-down",this.q2b).R(this.Aa,"thumbs-up",this.r2b)):tIc(this,!1));this.tA()};
function XX(a){return a.La("waffle-assistant-card-content-container")}function YX(a){a.AA();return a.La("waffle-assistant-card-options")}function tIc(a,b){GA&&L(a.La("waffle-assistant-thumbs-container"),a.c8()&&b)}p.eJ=function(){this.isDisposed()||(this.we=!0,uIc(this))};function vIc(a,b){!a.Zc&&b&&(a.Zc=!0,uIc(a))}function uIc(a){if(a.we&&a.Zc){var b=v(a.p2b,a);a.DA(b)}}p.bZ=function(){this.Ob||(sIc(this,!0),this.Ob=!0,this.Ta.start())};p.fR=function(){sIc(this,!1);this.Ob=!1};
p.wnb=function(){sIc(this,!0)};p.vnb=function(){var a=this,b=new zi(function(){oe(a.Da,document.activeElement)||a.Da.parentNode.querySelector(":hover")==a.Da||sIc(a,!1)},0);this.va(b);b.start()};p.q2b=function(){wIc(this,!0);tIc(this,!1);var a=this.VB();this.dispatchEvent(new UX("Qd",this,a))};p.r2b=function(){tIc(this,!1);var a=this.WB();this.dispatchEvent(new UX("Qd",this,a))};p.Esb=function(){wIc(this,!1)};p.GXb=function(){wIc(this,!0)};
function sIc(a,b){var c=a.La("waffle-assistant-card-options");a=a.AA();L(c,a&&b)}p.p2b=function(){rW(this.Bb,!1);L(this.Bb.Da,!1);ph(this.La("waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new E("content-rendered"))};function wIc(a,b){eh(a.La("waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.Ga.show(b)};function xIc(a,b,c){var d=a.Uc(),e=a.Wc();switch(b){case 0:d=Math.min(d,a.yc()+c);break;case 1:e=Math.min(e,a.rc()+c)}b=a.yb();c=a.yc();a=a.rc();return nA(b,c,a,d,e)}function yIc(a){var b=new ofa;H(b,1,""+a.ud);var c=a.rect.yc();H(b,2,c);c=a.rect.Uc();H(b,3,c);b.Gu(a.rect.rc());b.Rx(a.rect.Wc());return b}function zIc(a){var b=new fg;if(a){var c=new hg;a=yIc(a);Zf(c,7,a);Zf(b,58,c)}return b};function ZX(a,b,c,d,e,f,h,k){WX.call(this,a,k);this.C=W(a,8);this.Ab=b;this.wb=c;this.Db=d;this.L=e;this.Ra=f;this.$b=h;this.O=new mr("",this.oa());this.Ha(this.O);this.V=new mr("",this.oa());this.Ha(this.V);this.Sc=new dw;this.kb=null;this.Ja=!1;this.jb=[];this.Ua=[];this.Oa=[];this.Na=this.ea=this.D=this.H=this.$=null;a=zIc(this.$b);this.J=kj(jj(new ij,10),a).build()}y(ZX,WX);
var $X={ZWa:"waffle-assistant-after-chart-preview",vXa:"waffle-assistant-before-chart-preview",HXa:"waffle-assistant-card-draggable",h2:"waffle-assistant-chart-highlights",N_a:"waffle-assistant-insert-chart-button",twa:"waffle-assistant-chart-preview",s2a:"waffle-assistant-button-separator",c3a:"waffle-assistant-styled-border",d3a:"waffle-assistant-styled-rect",q4a:"waffle-assistant-zoom-button"};p=ZX.prototype;p.DA=function(a){this.kb=a;AIc(this)};
p.tA=function(){BIc(this,v(function(a){a=Dvc(this.Ab,a);ei(this.Da,a)},this),!1)};p.AA=Ie;p.jz=n("autovisFeedback");p.WB=n(2208);p.VB=n(2207);p.j6=n("Was this chart useful?");p.xa=function(){ZX.ma.xa.call(this);XX(this).appendChild(P(mIc));YX(this).appendChild(P(nIc));if(Uv(this.C,22)){this.D=new fIc(this.C,this.qa,this.Db,this.L,this.Ra,this.oa());this.Ha(this.D,!0);var a=this.D,b=this.Gd();a.V=b;kIc(a)}};
p.Ia=function(){ZX.ma.Ia.call(this);ah(this.Da,$X.HXa);var a=this.La($X.N_a);this.O.Va(a);TX(a,"Insert chart");a=this.La($X.q4a);this.V.Va(a);TX(a,"View full size");a=this.La($X.vXa);var b=this.La($X.ZWa);this.getHandler().R(this.Da,"keydown",this.W1b).R(a,"focus",this.$mb).R(b,"focus",this.Jlb).R(this.O,"action",this.fvb).R(this.O.Da,"mousedown",this.wsa).R(this.V,"action",this.uHb).R(this.V.Da,"mousedown",this.wsa).R(this.La($X.h2),"mousedown",this.wsa).R(aI(this.Ab),"rb",this.X1b);CIc(this);this.L.Xb(2790,
this.J);this.D&&this.L.Xb(2791,this.J)};p.iy=function(a){ZX.ma.iy.call(this,a);CIc(this);this.Wb()&&DIc(this)};function CIc(a){if(a.Wb()){var b=a.Gd();a.O.setVisible(!b);a=a.oa().La($X.s2a,YX(a));L(a,!b)}}p.W1b=function(a){13==a.keyCode&&a.target==this.Da&&(a.preventDefault(),a.stopPropagation(),EIc(this,2255))};
function FIc(a){var b=a.getChartType(),c=!!W(a.C,14),d=W(a.C,16),e=!!W(a.C,15),f="Histogram"==b;b="PieChart"==b;for(var h=svc(Zv(a.F,4)),k=1<h.length,l=[],m=0;m<h.length;m++){var q=h[m].rect;q=c!=b?duc(q,new Hd(q.width,1)):duc(q,new Hd(1,q.height));ob(l,q)}c=IG(a.wb).D;var t=[];for(w in Ox)t.push(ttb(c,Ox[w]));var w=Wa(l,function(a){return Wa(t,Fa(Yz,a))});f&&e&&(w=pb(w,1));a.Oa=GIc(w.length,b&&0<d||!f&&!b&&e,b&&k);d=IG(a.wb);for(e=0;e<w.length;e++)for(f=a.Oa[e],b=0;b<w[e].length;b++)w[e][b]&&jA(w[e][b])&&
(k=Juc(d,w[e][b],$X.d3a),a.va(k),AN(d.O,"default",k,!0),ph(k.Da,"background-color",f),k.setVisible(!0),a.jb.push(k),k=CN(d,w[e][b],$X.c3a,1,0),a.va(k),WCb(k,f),k.setVisible(!0),a.Ua.push(k))}function HIc(a){Cb(a.jb);Cb(a.Ua);a.jb=[];a.Ua=[];a.Oa=[]}p.X1b=function(){this.Ja&&(HIc(this),FIc(this))};p.bZ=function(){ZX.ma.bZ.call(this);this.ea=Ha();this.Ja||(FIc(this),this.Ja=!0)};
p.fR=function(){ZX.ma.fR.call(this);pa(this.ea)&&500<Ha()-this.ea&&this.L.Xb(2789,this.J);this.ea=null;HIc(this);this.Ja=!1};p.$mb=function(){var a=this.La($X.h2);Kh(a)?a.focus():this.Da.nextSibling&&this.Da.nextSibling.focus()};p.Jlb=function(){var a;if(a=this.Ga)a=this.Ga,a.xb("waffle-assistant-feedback-card-hidden")?a=!1:(a.La("waffle-assistant-feedback-card-link").focus(),a=!0);a||this.V.Da.focus()};p.fvb=function(){EIc(this,2255)};p.wsa=function(a){a.stopPropagation()};
p.uHb=function(){j3a.wc(this,this.J)};p.DJa=function(a,b){EIc(this,2257,a,b)};function EIc(a,b,c,d){BIc(a,v(function(a){a=new YHc(a,this.qa,this.H&&this.H.Od(),b,c,d,Aka(this.J));this.dispatchEvent(a)},a),!1)}
p.Y1b=function(a,b){if(b){var c=this.La($X.twa);if(b.ai())PJ.lE(c,b);else{a.sf(b.Od());LV(a,a.Od());UU(a,"ready",v(this.V1b,this,a));b=[];try{var d=new uz;d.setContext(a.toJSON());var e=!!W(this.C,14);X(d,3,e);var f=W(this.C,16);X(d,4,f);X(d,5,"ROWS"==(e?"ROWS":"COLS"));X(d,8,0);if(W(this.C,24)){var h=W(this.C,25);X(d,9,h)}var k=svc(Zv(this.F,4));for(e=0;e<k.length;e++)d.addRange(qA(k[e].rect,k[e].ud));var l=this.Sc.serialize(d);b=Wa(KAc(Fa(ritz_api.RitzModelApi.getVerbalHighlightsForProto,l),a).call(),
HAc)}catch(m){b=[]}d=this.La($X.h2);L(d,0<b.length);0<b.length&&(d.appendChild(b[0]),se(d,!0));this.H=a;iW(a,c,this.Db,this.L,LA)}}};p.V1b=function(a){null!==this.$&&(Cl(Al(),this.$),this.$=null);this.isDisposed()||(a.Hl()&&(QJ(a.Hl(),"onmouseover",v(this.T1b,this)),QJ(a.Hl(),"onmouseout",v(this.U1b,this))),this.kb(),DIc(this))};p.T1b=function(){this.Na=Ha()};p.U1b=function(){pa(this.Na)&&500<Ha()-this.Na&&this.L.Xb(2795,this.J);this.Na=null};
function DIc(a){if(!a.Gd()){var b=a.La($X.twa);if(!a.Ra.contains(b)){var c=a.Ra;a=new lIc(b,a);Ryb(c,a)}}}function IIc(a){a.Mc&&(a.$=Bl(Al(),uA.hta),a.Mc=!1);W(a.C,16);var b=pIc(a.C);b.caa(dK);var c=PAc(a.F);b.aj(c.toString());a.D&&(c=c.clone(),a.D.F=c);return b}
function AIc(a){var b=IIc(a);b=qIc(b,a.La("waffle-assistant-card-inner"));(new pV(dK,b.dg())).send(v(a.Y1b,a,b));a.D&&BIc(a,v(function(a){var c=this.D,e=b;a=new ZJ(a.toJSON());e=new ZJ(e.toJSON());var f=c.Ki("waffle-assistant-faceted-chart");if(1<f.length){jIc(a);var h=e;iIc(h);h.setOption("pieSliceText","percentage");h.setOption("axisFontSize",0);h.setOption("hAxis.title",null);h.setOption("hAxis.textPosition","none");h.setOption("vAxes.0.title",null);h.setOption("vAxes.0.textPosition","none");h.setOption("vAxes.1.title",
null);h.setOption("vAxes.1.textPosition","none");KA&&JA||LA||h.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"});h.setOption("legend","none");h.setOption("titleTextStyle.fontSize",0)}else h=a,jIc(h),h.setOption("applyAggregateData",void 0),h.setOption("legend","right"),iIc(e);h=svc(Zv(c.J,27));Gnb(c.F,h);h=W(c.J,25);for(var k=0;k<f.length;k++){var l=na(c.L[k])?c.L[k]:null,m=h.clone(),q=c.Ga,t=new zz;X(t,1,q);na(l)&&t.Qa(l);X(m,7,t);c.F.Cc("dt",encodeURIComponent(JSON.stringify(c.Sc.serialize(m))));
q=new ZJ(a.toJSON());q.aj(c.F.toString());m=e.clone();m.aj(c.F.toString());var w=c,x=q.xc("title");x||(x=zHc(q));t=x+(' when "'+(w.C+('" is "'+(l+'"'))));w=x+(' by "'+(w.C+'"'));t=l?t:w;q.setOption("title",t);m.setOption("title",t);w=new $Hc(q,m,c.C,l,c.Ja,c.Na,c.Aa,c.oa());c.Ha(w);t=f[k];w.Va(t);c.ea.push(w);w=c;x=zHc(q);q=x+(' broken down by "'+(w.C+('" for "'+(l+'"'))));w=x+(' broken down by "'+(w.C+'"'));ei(t,l?q:w);c.H=m}kIc(c);c.Da.style.visibility="visible"},a),!1)}
function BIc(a,b,c){var d=IIc(a);(new pV(dK,d.dg())).send(function(a){a?(a=a.Od(),c&&d.sf(a),LV(d,a),b(d)):b(null)})}p.getChartType=function(){return this.C.getChartType()};function GIc(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=hyc("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&ob(d,d);return d};function lIc(a){oM.apply(this,arguments)}r(lIc,oM);lIc.prototype.sja=g("element");function JIc(){mM.call(this);this.Ja.push(this);this.qa=this.Aa=!0;this.Ta="waffle-assistant-dragged-card"}y(JIc,Qyb);JIc.prototype.contains=function(a){return!!A(this.L,function(b){if(b.element==a)return!0})};JIc.prototype.qja=function(a){var b=JIc.ma.qja.call(this,a);if(KA&&JA||LA){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=Wa(b.querySelectorAll("clippath"),function(a){return a.id}),KIc(b,a);return b};
function KIc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];na(c)&&Qb(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=je(a);for(c=0;c<a.length;c++)KIc(a[c],b)};function LIc(){return R('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function MIc(a,b){WX.call(this,a,b);this.C=W(a,8)}y(MIc,WX);p=MIc.prototype;p.tA=ua;p.jz=n("assistantWordCloudFeedback");p.WB=n(2634);p.VB=n(2633);p.xa=function(){MIc.ma.xa.call(this);XX(this).appendChild(P(LIc));ah(XX(this),"waffle-assistant-word-cloud-content-container")};
p.DA=function(a){for(var b=Zv(this.C,19),c=Zv(this.C,20),d=this.La("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(NIc(this,b,c,e),120<d.clientHeight){NIc(this,b,c,e-1);break}b=this.oa();c=W(this.C,2);c=Ce(b,c);d=this.La("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function NIc(a,b,c,d){var e=a.La("waffle-assistant-word-cloud-words-container");for(a=a.oa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Ce(a," "));var l=a.createElement("SPAN");a.appendChild(l,Ce(a,b[k]));a.appendChild(e,l);ah(l,"waffle-assistant-word-cloud-word");var m=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-f)/(h-f)*15+9+"px"}};function OIc(){var a=R;var b=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content">'+Q(x3b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div></div></div>');
b=R(b);return a('<div class="waffle-assistant-scroll-pane" style="display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">'+b+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}
function PIc(a,b,c){b=c||b;return R('<div class="waffle-assistant-panel-title-bar">'+Q(lr({Ed:"waffle-assistant-panel-back-button",content:gq(""+Q(hs({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"},b))),style:4},b))+'<div class="waffle-assistant-title-text" role="heading">'+Q(a.title)+"</div></div>")};function aY(a){N.call(this,a);this.Ac=new qW(!1,"#4285f4");this.Ha(this.Ac);this.H=new N(this.oa());this.Ha(this.H);this.C=[];this.we=this.$b=!1;this.vd=this.Zc=this.Ta=this.ea=null;this.Db=new mr("",a,4);Ti(this.Db,2,!1);this.Ha(this.Db)}y(aY,N);var QIc={defaultHelpArticleId:"6280499"};p=aY.prototype;p.xa=function(){aY.ma.xa.call(this);this.Da=P(OIc);this.Zc=this.La("waffle-assistant-panel-content-container");this.vd=this.La("waffle-assistant-empty-list")};
p.Ia=function(){aY.ma.Ia.call(this);var a=this.La("waffle-assistant-spinner-container");this.Ac.render(a);this.H.Va(this.La("waffle-assistant-panel-card-holder"));this.Db.Va(this.La("waffle-assistant-empty-list-learn-more"));this.getHandler().R(this.Db,"action",this.t2b).R(this.Da,"scroll",Xuc(this.Aba,10,this))};p.setVisible=function(a){var b=this;L(this.Da,a);A(this.C,function(a){if(!a.Wb()){var c=b.H.cd();a.qa=c;b.H.Ha(a,!0);a.eJ()}});this.$b=a};
p.opa=function(a,b){var c=this.oa();this.ea&&this.c4();this.ea=new N;this.Ha(this.ea);a=Rp(a,PIc,{title:b});this.Ta=new mr("",this.oa());this.ea.Ha(this.Ta);this.Ta.Va(c.La("waffle-assistant-panel-back-button",a));TX(this.Ta.Da,"Back");this.ea.getHandler().R(this.Ta,"action",this.Rmb)};p.c4=function(){this.ea.dispose();this.ea=null};function RIc(a,b){rW(a.Ac,b);L(a.La("waffle-assistant-panel-pane"),!b)}p.rH=function(a){L(this.vd,a);L(this.Zc,!a)};
function SIc(a,b){kb(a.C,b);a.H.removeChild(b);a.H.jh(b,0);a.C.push(b)}p.dH=function(a){kb(this.C,a);-1!=Xh(this.H,a)&&this.H.removeChild(a,!0)};p.cW=function(){this.H.Id(!0);Cb(this.C);this.C=[]};p.Aba=function(){var a=this.Da;a=a.scrollTop+Hh(a).height;for(var b=0,c=0;c<this.C.length;c++){var d=this.C[c];b<a?(vIc(d,!0),b+=Hh(d.Da).height):vIc(d,!1)}};function TIc(a,b){a.we=b;A(a.C,function(a){a.iy(b)})}p.Gd=g("we");p.t2b=function(){K.ao.wc(QIc)};p.Rmb=function(){this.dispatchEvent("Id")};function UIc(a,b,c){b=c||b;c="";var d=" "+(T(a.title)+" Section ");c+='<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title" tabindex="0" aria-label="'+jq(d)+'">'+Q(a.title)+"</div>"+Q(lr({Ed:"waffle-assistant-section-more-button",content:gq("More"),style:4},b))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>';return R(c)};function bY(a,b,c,d){N.call(this,d);this.$=a;this.Ta=b;this.ea=new mr("",this.oa());this.Ha(this.ea);this.L=new N(this.oa());this.Ha(this.L);this.C=null;this.Ra=[];this.Oa=this.Na=!1;this.V=c}y(bY,N);p=bY.prototype;p.XLa=He;p.qqa=Ie;p.xa=function(){bY.ma.xa.call(this);this.Da=P(UIc,{title:this.getTitle()})};
p.Ia=function(){bY.ma.Ia.call(this);this.L.Va(this.La("waffle-assistant-section-card-holder"));this.ea.Va(this.La("waffle-assistant-section-more-button"));this.getHandler().R(this.ea,"action",this.qxb);this.C=this.hBa();this.va(this.C);L(VIc(this),this.XLa());this.setVisible(!1)};p.setVisible=function(a){if(this.Wb()&&this.isVisible()!=a&&(L(this.Da,a),a)){L(this.ea.Da,this.ITa());a=new hg;H(a,4,this.G1());var b=new fg;Zf(b,58,a);a=kj(jj(new ij,10),b).build();this.V.Xb(2774,a)}};
p.isVisible=function(){return this.Wb()&&Kh(this.Da)};p.ITa=function(){return this.Ra.length>this.$};p.hBa=function(){return new aY(this.oa())};p.qN=function(a){this.Oa=a;A(WIc(this),function(b){b.iy(a)});TIc(this.C,a)};p.Gd=g("Oa");p.Jf=ua;
p.pN=function(a){this.Ra=a;for(var b=0;b<a.length;b++){if(this.L.cd()<this.$){var c=this.bP(a[b]);c.iy(this.Oa);var d=this.L.cd();c.qa=d;this.L.Ha(c,!0)}if(this.qqa()&&(this.C.rH(!1),c=this.C,d=this.bP(a[b]),c.C.push(d),c.$b)){RIc(c,!1);var e=c.H.cd();d.qa=e;c.H.Ha(d,!0);d.eJ()}}};function WIc(a){var b=[];a.L.Cf(function(a){b.push(a)});return b}function VIc(a){return a.La("waffle-assistant-section-content")}p.Dla=function(){return this.L.W7()};
p.gU=function(){this.Ra=[];Cb(this.L.Id(!0));this.setVisible(!1);this.qqa()&&(this.C.cW(),this.C.rH(!0))};function XIc(a){a.L.Cf(function(a,c){c<this.$&&a.eJ()},a)}p.J1=function(a){var b=0;if(this.Na)this.C.Aba();else if(this.Dla()){this.setVisible(!0);b=Hh(this.La("waffle-assistant-section-header")).height+Hh(VIc(this)).height;for(var c=WIc(this),d=0;d<c.length;d++)b<a&&d<this.$?(this.$Ia(c[d]),vIc(c[d],!0),b+=Hh(c[d].Da).height):vIc(c[d],!1)}else this.setVisible(!1);return a-b};p.$Ia=ua;
p.I1=function(a){(this.Na=a)||this.C.c4()};p.Qb=g("Na");p.zWa=function(a){this.C&&RIc(this.C,a)};function YIc(a,b){a.C.opa(b,a.getTitle())}p.qxb=function(){this.I1(!0);this.dispatchEvent("Nd")};function cY(a,b,c,d,e,f){bY.call(this,20,e,d,f);this.qa=a;this.J=b;this.Aa=c;this.D=new JIc;this.va(this.D);this.F=null;this.H=0;this.O=null}y(cY,bY);p=cY.prototype;p.Ia=function(){cY.ma.Ia.call(this);this.D.Ie();this.getHandler().R(this.D,"drag",this.S1b).R(this.D,"dragend",this.R1b)};p.getTitle=n("Analysis");p.RV=function(a){return 0==a};p.bP=function(a){return"WordCloud"==W(a,8).getChartType()?new MIc(a,this.oa()):new ZX(a,this.qa,this.J,this.Aa,this.V,this.D,this.O,this.oa())};
p.qN=function(a){cY.ma.qN.call(this,a);a&&oyb(this.D)};p.$Ia=function(a){this.getHandler().Vc(a,"content-rendered",this.Q1b);this.H++};p.pN=function(a,b){this.O=b||null;cY.ma.pN.call(this,a,b)};p.Q1b=function(){0==--this.H&&this.dispatchEvent("Kd")};p.S1b=function(){this.F=Dh(this.D.fd.target)};p.R1b=function(a){var b=this.F,c=IG(this.J).C;if(mh(hL(c,"page",!1,!1)).contains(b)){var d=gL(c,b.x,b.y,"page");c=kL(c,d,"page");b=new Dd(b.x-c.left,b.y-c.top);a.C.getData().DJa(d,b)}this.F=null};p.G1=n(2);var ZIc={N3a:0,xda:1,Tba:2,Sca:3,c4a:4,Z2a:5,Nva:6,pU:7,P2a:8,Q2a:9},$Ic={UNKNOWN_ERROR:0,nDc:1,ztc:2,cfc:3},aJc={WCc:0,xfc:1,Yba:2,dk:3,OCc:4,z5b:5,Sgc:6},bJc={TCc:0,XA:1,Ftc:2,ltc:3,fwc:4},cJc={PCc:0,Btc:1,hE:2,Fqc:3},dJc={FCc:0,mCc:1,Cjc:2,gBc:3,fBc:4,a9b:5,trc:6},eJc={kAc:0,iE:1,aYa:2,fCc:3,czc:4,t1a:5,lDc:6,vva:7,eta:8,Ota:9,xU:10},fJc={UNKNOWN:0,i5b:1,h5b:2,g5b:3,C6b:4,p8b:5,V8b:6,Ebc:7,$fc:8,gsc:9,twc:10,Ewc:11,xAc:12,yAc:13,KBc:14,Qvc:15};var gJc={DEFAULT:0,RIGHT:1,LEFT:2,fB:3,JA:4},hJc={Y2a:0,jrc:1};function iJc(){V.call(this)}y(iJc,V);var jJc=null;function dY(){V.call(this)}y(dY,V);var kJc=null;dY.prototype.getTitle=function(){return W(this,1)};function eY(){V.call(this)}y(eY,V);var lJc=null;eY.prototype.getPosition=function(){return W(this,1)};eY.prototype.setPosition=function(a){X(this,1,a)};function fY(){V.call(this)}y(fY,V);var mJc=null;function gY(){V.call(this)}y(gY,V);var nJc=null;
gY.prototype.getTitle=function(){return W(this,3)};iJc.prototype.Ca=function(){var a=jJc;a||(jJc=a=aw(iJc,{0:{name:"ChartScale",qb:"virtualanalyst.sheets.ChartScale"},1:{name:"custom_scale",Ba:14,defaultValue:0,type:hJc},2:{name:"factor",Ba:1,type:Number}}));return a};iJc.Ca=iJc.prototype.Ca;dY.prototype.Ca=function(){var a=kJc;a||(kJc=a=aw(dY,{0:{name:"ChartTitle",qb:"virtualanalyst.sheets.ChartTitle"},1:{name:"title",Ba:9,type:String}}));return a};dY.Ca=dY.prototype.Ca;
eY.prototype.Ca=function(){var a=lJc;a||(lJc=a=aw(eY,{0:{name:"ChartLegend",qb:"virtualanalyst.sheets.ChartLegend"},1:{name:"position",Ba:14,defaultValue:0,type:gJc}}));return a};eY.Ca=eY.prototype.Ca;fY.prototype.Ca=function(){var a=mJc;a||(mJc=a=aw(fY,{0:{name:"ChartAxis",qb:"virtualanalyst.sheets.ChartAxis"},1:{name:"scale",Ba:11,type:iJc}}));return a};fY.Ca=fY.prototype.Ca;
gY.prototype.Ca=function(){var a=nJc;a||(nJc=a=aw(gY,{0:{name:"ChartOptions",qb:"virtualanalyst.sheets.ChartOptions"},1:{name:"h_axis",Ba:11,type:fY},2:{name:"v_axis",Ba:11,type:fY},3:{name:"title",Ba:11,type:dY},4:{name:"subtitle",Ba:11,type:dY},5:{name:"legend",Ba:11,type:eY},6:{name:"chart_conversation",Ba:8,type:Boolean}}));return a};gY.Ca=gY.prototype.Ca;function hY(){V.call(this)}y(hY,V);var oJc=null;hY.prototype.gj=function(){return W(this,1)};function iY(){V.call(this)}y(iY,V);var pJc=null;iY.prototype.getText=function(){return W(this,1)};iY.prototype.gr=function(){return Uv(this,1)};function jY(){V.call(this)}y(jY,V);var qJc=null;jY.prototype.getStatus=function(){return W(this,1)};jY.prototype.getError=function(){return W(this,9)};function kY(){V.call(this)}y(kY,V);var rJc=null;function sJc(){V.call(this)}y(sJc,V);var tJc=null;
function lY(){V.call(this)}y(lY,V);var uJc=null;lY.prototype.Gz=function(){return Uv(this,1)};lY.prototype.getType=function(){return W(this,3)};lY.prototype.setType=function(a){X(this,3,a)};function vJc(){V.call(this)}y(vJc,V);var wJc=null;function xJc(){V.call(this)}y(xJc,V);var yJc=null;
hY.prototype.Ca=function(){var a=oJc;a||(oJc=a=aw(hY,{0:{name:"Error",qb:"ritz.assistant.Error"},1:{name:"message",Ba:9,type:String},2:{name:"code",Ba:14,defaultValue:0,type:$Ic},3:{name:"unsupported_op_reason",Ba:14,defaultValue:0,type:aJc}}));return a};hY.Ca=hY.prototype.Ca;
iY.prototype.Ca=function(){var a=pJc;a||(pJc=a=aw(iY,{0:{name:"AnswerQueryPhrase",qb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Ba:9,type:String},2:{name:"start_byte",Ba:5,type:Number},3:{name:"num_bytes",Ba:5,type:Number}}));return a};iY.Ca=iY.prototype.Ca;
jY.prototype.Ca=function(){var a=qJc;a||(qJc=a=aw(jY,{0:{name:"AnswerResponse",qb:"ritz.assistant.AnswerResponse"},1:{name:"status",Ba:5,type:Number},10:{name:"parse_status",Ba:14,defaultValue:0,type:bJc},11:{name:"answer_status",Ba:14,defaultValue:0,type:cJc},2:{name:"formula",Ba:9,type:String},3:{name:"debug_parse_response",Ba:9,type:String},4:{name:"interpretation",Ba:9,type:String},5:{name:"debug_interpretation_response",Ba:9,type:String},6:{name:"unused_phrase",Hc:!0,Ba:11,type:iY},7:{name:"used_entity_phrase",
Hc:!0,Ba:11,type:iY},8:{name:"unused_entity_phrase",Hc:!0,Ba:11,type:iY},9:{name:"error",Ba:11,type:hY},12:{name:"alternate_suggestion",Hc:!0,Ba:11,type:lY},14:{name:"deprecated_formula_builder_used",Ba:9,type:String},15:{name:"answer_visualization_type",Hc:!0,Ba:14,defaultValue:0,type:eJc},16:{name:"formula_builder_used",Ba:14,defaultValue:0,type:fJc},17:{name:"charting_info",Ba:11,type:sJc},18:{name:"answer_field_info",Hc:!0,Ba:11,type:kY},19:{name:"charting_formula",Ba:9,type:String},21:{name:"parse_info",
Hc:!0,Ba:11,type:vJc},22:{name:"answer_field_info_for_ranges",Hc:!0,Ba:11,type:kY},23:{name:"va_query",Ba:9,type:String},24:{name:"pivot_table_def",Ba:11,type:Ay}}));return a};jY.Ca=jY.prototype.Ca;kY.prototype.Ca=function(){var a=rJc;a||(rJc=a=aw(kY,{0:{name:"AnswerFieldInfo",qb:"ritz.assistant.AnswerFieldInfo"},1:{name:"cell_data_type",Ba:14,defaultValue:0,type:yUa},2:{name:"range_ref",Ba:9,type:String}}));return a};kY.Ca=kY.prototype.Ca;
sJc.prototype.Ca=function(){var a=tJc;a||(tJc=a=aw(sJc,{0:{name:"ChartingInfo",qb:"ritz.assistant.ChartingInfo"},1:{name:"suggested_type",Hc:!0,Ba:14,defaultValue:0,type:eJc},2:{name:"recommended",Ba:8,type:Boolean},3:{name:"user_requested_type",Hc:!0,Ba:14,defaultValue:0,type:eJc},4:{name:"show_only_chart",Ba:8,type:Boolean},5:{name:"chart_options",Ba:11,type:gY}}));return a};sJc.Ca=sJc.prototype.Ca;
lY.prototype.Ca=function(){var a=uJc;a||(uJc=a=aw(lY,{0:{name:"QuerySuggestion",qb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Ba:9,type:String},2:{name:"formula",Ba:9,type:String},3:{name:"type",Ba:14,defaultValue:0,type:dJc},4:{name:"deprecated_formula_builder_used",Ba:9,type:String},5:{name:"formula_builder_used",Ba:14,defaultValue:0,type:fJc}}));return a};lY.Ca=lY.prototype.Ca;
vJc.prototype.Ca=function(){var a=wJc;a||(wJc=a=aw(vJc,{0:{name:"ParseInfo",qb:"ritz.assistant.ParseInfo"},1:{name:"intent_info",Hc:!0,Ba:11,type:xJc}}));return a};vJc.Ca=vJc.prototype.Ca;xJc.prototype.Ca=function(){var a=yJc;a||(yJc=a=aw(xJc,{0:{name:"IntentInfo",qb:"ritz.assistant.IntentInfo"},1:{name:"intent_type",Ba:14,defaultValue:0,type:ZIc}}));return a};xJc.Ca=xJc.prototype.Ca;function zJc(){this.D=this.J="";this.L=!1;this.F=0;this.O=!1;this.H=0;this.C=""}zJc.prototype.getTitle=g("J");var AJc="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this;how does this".split(";"),BJc=[{Vj:["Thank you","Thankyou","Thanks"],wq:"No problem"},{Vj:["you are amazing","This is great","omg"],wq:"Happy to help"},{Vj:["I love you"],wq:"Must be in the air"},{Vj:["How do you know","How are you so smart"],wq:"It's all in the data"},{Vj:["Are you sure"],wq:"Send feedback if this doesn't seem correct to help improve accuracy"},{Vj:["How are you"],wq:"Pretty good, thanks"},
{Vj:["Hi","Hello","Hey"],wq:"Hi, there. Try asking a question about your data."},{Vj:["You are stupid","This is dumb","You are wrong"],wq:"Help improve this experience by sending feedback"},{Vj:["How smart are you"],wq:"Pretty smart"}];function CJc(a){for(var b=0;b<BJc.length;++b)if(-1!=cb(BJc[b].Vj,function(b){return Fb(a,b)}))return b;return-1};function DJc(a,b,c,d){var e=new lHc;H(e,2,c);A(b,function(a){Vf(e,1).push(a)});H(e,3,d);d=new MX;H(d,1,a);H(d,3,b[c]);Zf(d,11,e);return d}function EJc(a,b,c,d){var e=new hHc;H(e,2,c);A(b,function(a){Vf(e,1).push(a)});H(e,3,d);d=new MX;H(d,1,a);H(d,2,b[c]);Zf(d,10,e);return d}function FJc(a){var b=new fHc;A(a,function(a){var c=a.type;Vf(b,1).push(c);a.nFa&&(a=a.nFa,Vf(b,2).push(a))});return b}function GJc(a){var b=new jHc;A(a,function(a){a=a.type;Vf(b,1).push(a)});return b}
function HJc(a,b,c,d){var e=new nHc;a&&H(e,1,a);b&&H(e,2,b);for(a=0;a<c.length;a++)b=c[a],Vf(e,3).push(b);H(e,4,d);return e};function mY(a,b){this.D=a;this.C=b}mY.prototype.getChartType=g("D");var nY={2:new mY("ColumnChart","Column chart"),3:new mY("LineChart","Time series"),4:new mY("ScatterChart","Scatter chart"),5:new mY("PieChart","Pie chart"),10:new mY("Histogram","Histogram"),7:new mY("LineChart","Line chart")};function oY(a,b,c,d,e,f,h){this.D=a;this.jB=b;this.H=(void 0===h?null:h)||b;this.C=d;this.Xm=c;this.Ga=d?Zv(d,6):[];this.Ja=d?Zv(d,7):[];this.Aa=d?Zv(d,8):[];this.error=e||1;this.interpretation=d&&Uv(d,4)?W(d,4):null;this.xWa=new zJc;this.O=d?Zv(d,12):[];this.qa=d?Zv(d,21):[];this.ea=f;this.F=null;this.$=this.J=!1;this.L=[];this.V=null;IA&&IJc(this)}function JJc(a){return 1==a.error&&null!=a.Xm}
function KJc(a){return{aM:LJc(a),interpretation:a.interpretation,jB:a.jB,Xm:a.Xm,nL:1<a.jB.length&&1<a.jB[0].length,Rj:a.Rj(),Eqa:a.$,Pv:a.Pv(),p8:a.L}}oY.prototype.Rj=function(){return IA&&null!=this.F&&(this.F in nY?!0:!1)&&2<this.H.length};oY.prototype.Pv=function(){return HA&&J(I(),"feapt")&&null!==this.C&&Uv(this.C,24)};oY.prototype.getChartType=function(){if(!this.Rj())return null;var a=this.F;if(a in nY)return nY[a].getChartType();throw Error("Unknown chart type.");};
function MJc(a){a.Rj();return a.H[0][0]}function NJc(a){return Wa(Zv(a.C,22),function(b){if(W(b,2)){var c=a.ea.C;b=W(b,2);return PF(b,c)}},a)}function OJc(a){return{aM:LJc(a),error:PJc(a)}}function QJc(a,b,c){var d=c.length;if(0==d)return a;1<d&&kb(a,10);c=W(c[0],1);2<d&&9==c&&kb(a,4);2<d&&kb(a,5);2!=c&&3!=c&&12!=c&&kb(a,3);db(b,10)&&db(a,10)&&Baa(a,function(a){return 10!=a});return a}
function IJc(a){var b=null;a.J=!1;a.F=null;if(a.C&&Uv(a.C,17)){var c=W(a.C,17);a.$=W(c,4)||!1;var d=Zv(c,3),e=QJc(Zv(c,1),d,Zv(a.C,18));0<d.length&&(0==e.length||1>=a.H.length||1>a.H[0].length)?a.L.push("Charts for this question are not supported."):(0<d.length?(b=Va(e,function(a){return db(d,a)}),c=Va(d,function(a){return!db(e,a)}),kb(c,6),0<b.length?(a.J=!0,a.F=b[0],b=a.F):db(d,10)&&db(e,2)?(a.J=!0,a.F=2,kb(c,10),b=a.F):(b=0<c.length?c[0]:6,a.J=!0,a.F=RJc(a,e)),0<c.length&&a.L.push("Requested chart type is not supported for this question.")):
0<e.length&&1<a.H.length&&1<a.H[0].length&&(a.F=RJc(a,e),a.J=W(c,2)||!1,20<=a.H.length||3<=a.H[0].length)&&(a.J=!0),a.V=HJc(a.F,b,e,a.J))}}function RJc(a,b){if(!Zv(a.C,18).length)return b[0];a=SJc(a);a=ritz_api.AssistantApi.getAnswersChartsRecommedation(a.toJSON());for(var c=0;c<a.length;c++)if(db(b,a[c]))return a[c];return b[0]}function TJc(a,b,c){var d={};null!=b?(d.v=UJc(a,b,c),d.f=b):d.v=null;return d}
function SJc(a){for(var b=new HJ,c=a.H[0],d=pb(a.H,1),e=Zv(a.C,18),f=[],h=0;h<c.length;h++)null!=e[h]&&Uv(e[h],1)?f.push(VJc(W(e[h],1))):f.push(0==h?"string":"number"),b.Es({type:f[h],label:c[h]||"",id:"Axis"+h});for(e=0;e<d.length;++e){h=[];for(var k=0;k<c.length;k++)h.push(TJc(a,d[e][k],f[k]));b.Vu(h)}return b}
function UJc(a,b,c){switch(c){case "boolean":return"true"==b.toLowerCase()||"1"==b;case "number":return a=a.ea.L.H,b=(b||"0").replace(new RegExp("[^-0-9"+a+"]","g"),""),b=b.replace(a,"."),dc(b);case "date":case "datetime":return new Date(b);case "timeofday":if(b){a=b.replace(/[^a-zA-Z0-9]/g," ").split(" ");c=[0,0,0,0];if(!(2>a.length)&&Kb(a[0])&&Kb(a[1])&&(Kb(a[a.length-1])||"am"==a[a.length-1].toLowerCase()||"pm"==a[a.length-1].toLowerCase())){for(var d=0;d<b.length&&4>d;d++)Kb(a[d])&&(c[d]=dc(a[d]));
"am"==a[a.length-1].toLowerCase()&&12==c[0]&&(c[0]=0);"pm"==a[a.length-1].toLowerCase()&&12!=c[0]&&(c[0]+=12)}b=c}else b=[0,0,0,0];return b;default:return b||""}}function VJc(a){switch(a){case 1:return"boolean";case 9:return"number";case 2:return"date";case 3:return"datetime";case 12:return"timeofday";default:return"string"}}
function WJc(a){if(!Uv(a.C,9))return"";if(Uv(a.C.getError(),3))switch(W(a.C.getError(),3)){case 1:return"Sorry, questions related to formatting are not supported at this time.";case 2:return"Answers provides formulas based on your data. Charts are currently not supported. Please use the menus to create a chart.";case 3:return"Sorry, this action is not supported at this time.";case 4:return"Sorry, this function is not supported at this time.";case 5:return"Sorry, your question is too generic. Please ask a more specific question.";
default:return"Sorry, this function is not supported at this time."}return a.C.getError().gj()||""}
function PJc(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer at this time. Please try again later.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about your data.";case 6:return WJc(a)||"Sorry, couldn't understand your question.";case 7:return a=CJc(a.D),-1!=a?BJc[a].wq:""}return""}
function LJc(a){var b=[];if(JJc(a)){var c=[];A(mb(a.Ga,a.Aa),function(a){c.push(XJc(a,"waffle-assistant-answercard-question-unused-phrase"))});A(a.Ja,function(a){c.push(XJc(a,"waffle-assistant-answercard-question-used-entity"))});vb(c,function(a,b){return a.JT>b.JT?1:-1});var d=0;A(c,function(c){var e=c.length,h=c.JT;h>d?b.push({text:a.D.substring(d,h),className:null}):(e-=d-h,h=d);0<e&&(d=h+e,b.push({text:a.D.substring(h,d),className:c.Ck}))});d<a.D.length&&b.push({text:a.D.substring(d),className:null})}else b.push({text:a.D,
className:null});return b}function XJc(a,b){return{JT:W(a,2),length:W(a,3),Ck:b}};function YJc(a){this.C=a}function ZJc(a,b){var c=new LX;H(c,3,b);H(c,8,j1a);b=new vU;Zf(b,4,c);c=new fg;Zf(c,46,b);c=kj(jj(new ij,10),c).build();a.C.Xb(2753,c)};function $Jc(a,b,c){return R('<div class="waffle-assistant-answers-card-remove">'+Q(hs({icon:"docs-icon-img docs-icon-trash"},c||b))+"</div>")}
function aKc(a,b){var c=a.error;a=a.showHelp;b='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+Q(hs({icon:"docs-icon-img docs-icon-unsupported-black"},b))+'</div><div class="waffle-assistant-errorcard-content">';a?(c=Q(c)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',b+='<div class="waffle-assistant-errorcard-text">'+c+"</div>"):b+='<div class="waffle-assistant-errorcard-text">'+Q(c)+"</div>";
return R(b+"</div></div>")};function bKc(a,b,c){b=c||b;c=R;var d='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+cKc({aM:a.kB.aM}),e={jB:a.kB.jB,Xm:a.kB.Xm,interpretation:a.kB.interpretation,nL:a.kB.nL,Rj:a.kB.Rj,Pv:a.kB.Pv,Eqa:a.kB.Eqa,p8:a.kB.p8};null==e.jB||za(e.jB);var f=e.jB;a=e.Xm;var h=e.nL,k=e.Rj,l=e.Pv,m=e.Eqa;za(e.p8);var q=e.p8;e=e||{};e=e.interpretation;e=""+('<div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+jq("Answer")+'"><span aria-hidden="true">Answer</span></div>'+
(e?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+Q(e)+"</div></div>":"")+"");var t='<div class="waffle-assistant-answercard-answer-container">'+R(e)+'<div class="waffle-assistant-answercard-answer-content">';if(f){if(!m)if(k&&(t+='<div class="waffle-assistant-answercard-tabs"><div class="waffle-assistant-answercard-formula-tab">FORMULA</div><div class="waffle-assistant-answercard-pivot-tab">PIVOT TABLE</div><div class="waffle-assistant-answercard-chart-tab" id="waffle-assistant-answercard-chart-tab">CHART</div></div>'),
l)t+='<div class="waffle-assistant-answercard-pivot-content"></div>';else{t+='<div class="waffle-assistant-answercard-answer">';if(h){t+='<div class="waffle-assistant-answercard-answer-rowheader">';m=f[0];e=m.length;for(var w=0;w<e;w++)t+='<span class="waffle-assistant-answercard-answer-col">'+Q(m[w])+"</span>";t+="</div>"}t+='<div class="waffle-assistant-answercard-answer-rows">';m=bq("waffle-assistant-answercard-answer-row"+(h?" waffle-assistant-answercard-answer-list-row":""));e=f.length;for(w=
0;w<e;w++){var x=f[w];if(h&&0==w)x="";else{var z=m;za(x);z='<div class="'+T(z)+'">';for(var C=x.length,M=0;M<C;M++){var O=x[M];z=O?z+('<span class="waffle-assistant-answercard-answer-col">'+Q(O)+"</span>"):z+('<span class="'+T("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}x=R(z+"</div>")}t+=x}t+="</div></div>"}t+=k?'<div class="waffle-assistant-answercard-chart-container"><div class="waffle-assistant-answercard-chart-type-select"></div><div class="waffle-assistant-answercard-chart"></div></div>':
""}if(0<q.length){t+='<div class="waffle-assistant-answercard-info-msgs">';f=q.length;for(h=0;h<f;h++)t+='<div class="waffle-assistant-answercard-info-msg">* '+Q(q[h])+"</div>";t+="</div>"}t+='<div class="waffle-assistant-answercard-footer">';l&&(t+='<div class="waffle-assistant-answercard-insert-pivot">INSERT PIVOT TABLE</div>');k&&(t+='<div class="waffle-assistant-answercard-insert-chart">INSERT CHART</div>');l||(t+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-help">Click to copy or drag to insert</div><div class="waffle-assistant-answercard-formula-display"><div class="waffle-assistant-answercard-formula-icon">'+
Q(hs({icon:"docs-icon-img docs-icon-insert-formula"},b))+'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+Q(a)+"</div></div></div></div></div>");b=R(t+"</div></div></div>");return c(d+b+"</div></div>")}
function cKc(a){za(a.aM);a=a.aM;var b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+jq("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+T(e.className)+'">'+Q(e.text)+"</span>":Q(e.text)}return R(b+"</div></div></div>")}
function dKc(a,b,c){b=c||b;a=a.Pv;return R(""+Q($Jc(null,b))+(a?'<div class="waffle-assistant-button-separator"></div>'+Q(lr({Ed:"waffle-assistant-zoom-button",content:gq(""+Q(hs({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)):"")+"")};function eKc(a,b,c,d){F.call(this);this.$=a;this.V=b;this.ea=c;this.Ja=d;this.Ka=new hh(this);this.va(this.Ka);this.C=new xW;this.va(this.C);this.O="";this.L=[];this.F=this.D=this.J=null;this.H=!1;gBc(this.C,this.$);this.C.qa=10;this.C.Ra=!0;this.C.V=!1;this.C.SSa("waffle-assistant-visible");this.C.L=Lb("waffle-assistant-dragged-formula").split(" ");this.C.Ie();this.Ka.R(this.C,$Ac,this.Aa).R(this.C,cBc,this.Ga).R(this.C,dBc,this.qa)}y(eKc,F);
eKc.prototype.Aa=function(a){a=Sa(this.$.childNodes,a.C);this.O=this.L[a]};
eKc.prototype.Ga=function(a){var b=a.event instanceof jp?a.event.xm:a.event;this.H?(a.J.sz(b,!0),a.preventDefault()):(vh(a.F,a.event.clientX,a.event.clientY),a=wh(a.F),b=IG(this.V).C,mh(hL(b,"page",!1,!1)).contains(a)?(a=gL(b,a.x,a.y,"page"),(b=nI(zK(this.ea),a.y,a.x))?a=new Dd(b.rc(),b.yc()):b=Vz(a),this.J=a,this.D&&this.D.getRect().equals(b)||(a=IG(this.V),D(this.D),this.D=Juc(a,b,"waffle-assistant-formula-insertion-rect"),this.va(this.D),AN(a.O,"default",this.D),D(this.F),this.F=CN(a,b,"waffle-assistant-formula-insertion-border",
2,0),this.va(this.F),WCb(this.F,"#000"),this.F.setVisible(!0))):fKc(this))};eKc.prototype.qa=function(a){if(this.J){hO(IG(this.V),!1);var b=this.J,c=zK(this.ea);b=new vO(c,b,this.O);this.Ja.C(b);this.dispatchEvent(new E("formula_inserted"))}a.J.sz(null,!0);a.preventDefault();this.O="";fKc(this)};function fKc(a){a.J=null;D(a.D);a.D=null;D(a.F);a.F=null};function pY(a,b,c,d,e,f,h,k,l,m,q,t,w){WX.call(this,new uG,w);this.D=a;this.Rh=NJc(a);this.Ua=a.Rj();this.Na=a.Pv();this.Af=q;this.$=this.C=this.wb=null;this.Ra=a.Rj()&&a.J;this.Xd=a.$;this.Db=!1;this.Eg=b;this.gf=c;this.Pe=d;this.Ui=l;this.xi=h;this.V=e;this.ah=f;this.Qg=k;this.We=m;this.He=jj(new ij,10).build();this.Hd=new kr("",new QX,this.oa());this.Ha(this.Hd);this.Eh=t;this.jb=new kr("",new QX,this.oa());this.Ha(this.jb);this.Ab=new kr("",new QX,this.oa());this.Ha(this.Ab);this.ea=null;this.O=
new kr("",new sW,this.oa());this.Ha(this.O);this.H=a.xWa;this.Oa=new kr("",new sW,this.oa());this.Ha(this.Oa);this.kb=new kr("",new QX,this.oa());this.Ha(this.kb);this.L=new nV;this.Ha(this.L);this.Ja=new ON("");this.Ha(this.Ja);this.J=null;this.$b=2;this.Fc=SJc(this.D);this.vd=new uW(b,"waffle-assistant-answers-range-styled-border","waffle-assistant-answers-range-styled-rect");this.va(this.vd);this.zd=!1}y(pY,WX);p=pY.prototype;p.qia=g("Qg");
p.xa=function(){pY.ma.xa.call(this);YX(this).appendChild(P(dKc,{Pv:this.Na}))};
p.Ia=function(){pY.ma.Ia.call(this);var a=this.La("waffle-assistant-answers-card-remove");this.Hd.Va(a);TX(a,"Remove card",0);this.getHandler().Vc(this.Hd,"action",this.g2b);if(this.D.Pv()){a=zK(this.gf).kc();var b=this.D;b.Pv();b=b.C?W(b.C,24):null;var c=RAc(this.Eh,b);this.wb=new UAc(c,b,this.Ui.L.C,this.Af,a,this.Pe)}else this.getHandler().R(this.O,"action",this.MCb).R(this.Oa,"action",this.iub).Vc(this.O,"action",this.YNa).Vc(this.Oa,"action",this.qKb)};
function gKc(a){function b(b,d,e,f){var c=new lV("");c.Va(a.La(b));a.L.Ha(c);a.getHandler().Vc(c,"action",v(a.nKb,a,d));f||c.setVisible(!1);e&&f&&a.L.vM(c)}a.L.Va(a.La("waffle-assistant-answercard-tabs"));a.getHandler().R(a.L,"select",a.iFb);b("waffle-assistant-answercard-formula-tab",0,!a.Ra,!a.Na);b("waffle-assistant-answercard-pivot-tab",1,!a.Ra,a.Na);b("waffle-assistant-answercard-chart-tab",2,a.Ra,!0)}
function hKc(a){var b=W(a.D.C,17);b=Zv(b,1);for(var c=0;c<b.length;c++)a.Ja.Pd(iKc(b[c]));a.Ja.Va(a.La("waffle-assistant-answercard-chart-type-select"));Br(a.Ja,iKc(a.D.F));b=a.La("waffle-assistant-answercard-insert-chart");a.kb.Va(b);jKc(a);a.getHandler().R(a.kb,"action",a.e2b).R(a.Ja.Bc(),"action",a.eob)}
p.DA=function(a){XX(this).appendChild(P(bKc,{kB:KJc(this.D)}));if(this.D.Pv()){this.Ua&&(gKc(this),hKc(this));var b=this.La("waffle-assistant-answercard-insert-pivot");this.jb.Va(b);b=this.La("waffle-assistant-zoom-button");this.Ab.Va(b);TX(b,"Preview Pivot Table");this.getHandler().R(this.jb,"action",this.f2b).R(this.Ab,"action",this.yWa);kKc(this);this.C=this.oa().xa("CANVAS","waffle-pivottable-pivot-canvas-border");se(this.C,!0);b=this.La("waffle-assistant-answercard-pivot-content");this.oa().appendChild(b,
this.C);this.getHandler().Pg(this.C,ff,this.yWa);WAc(this.wb,this.C);this.$b=this.Ra?1:3}else this.O.Va(this.La("waffle-assistant-answercard-see-formula-link")),this.Oa.Va(this.La("waffle-assistant-answercard-hide-formula-link")),this.ea=new eKc(this.La("waffle-assistant-answercard-formula-text-container"),this.Eg,this.gf,this.Pe),b=this.Gd(),this.ea.H=b,this.ea.L=[this.D.Xm],this.va(this.ea),b=this.La("waffle-assistant-answercard-formula-text"),ei(b,"Formula: "+(this.D.Xm+". Click/Press ENTER to copy or drag to insert on to sheet.")),
this.getHandler().Vc(this.ea,"formula_inserted",this.pKb).Pg(this.La("waffle-assistant-answercard-formula-text"),ff,this.ttb),lKc(this,this.We),mKc(this),this.We&&(nKc(this,!0),this.getHandler().Rc(this.O,"action",this.YNa)),this.Ua&&(this.Xd?(oKc(this,this.D.getChartType()),this.Db=!0):gKc(this),hKc(this),this.$b=1);a()};p.QM=function(){return this.Ua&&!this.Xd&&!this.Ra};function iKc(a){if(a in nY)return new hk(nY[a].C,a);throw Error("Unknown chart type.");}
p.eob=function(a){a=a.target.Sa();if(a in nY)oKc(this,nY[a].getChartType());else throw Error("Unknown chart type model.");};function pKc(a,b){a.H.D&&b.setOption("subtitle",a.H.D);b.setOption("hAxis.logScale",a.H.L);b.setOption("vAxis.logScale",a.H.O);a.H.C&&b.setOption("legend.position",a.H.C);a.H.F&&b.setOption("hAxis.formatOptions.scaleFactor",a.H.F);a.H.H&&b.setOption("vAxis.formatOptions.scaleFactor",a.H.H)}
function oKc(a,b){a.J=new mG;X(a.J,1,b);X(a.J,2,a.D.interpretation||"");if("Histogram"===b)b=MJc(a.D),X(a.J,3,b),X(a.J,6,"Count");else if("LineChart"===b||"ColumnChart"===b)b=0,"number"!=a.Fc.dd(0)&&(b=a.Fc.Of(0),X(a.J,3,b),b=1),1==a.Fc.getNumberOfColumns()-b?(b=a.Fc.Of(b),X(a.J,6,b)):X(a.J,6,"Values");else{b=a.J;var c=MJc(a.D);X(b,3,c);c=a.D;c.Rj();X(b,6,c.H[0][1]||"")}b=pIc(a.J);b.sf(a.Fc);c=a.La("waffle-assistant-answercard-chart");b=qIc(b,c);LV(b,b.Od());pKc(a,b);b.setOption("title",a.H.getTitle());
iW(b,c,a.Af.C,a.V,LA);a.Db=!0}p.f2b=function(){VAc(this.wb);this.dispatchEvent("close-sidebar");this.V.C(35619,jj(new ij,67).build())};p.yWa=function(){var a=jj(new ij,67).build();this.V.C(35620,a);D(this.$);this.$=new YAc(this.wb,this.Ab,this.D.interpretation||"",this.V,a,35621,this.oa());this.$.render();this.va(this.$);xHc(this.$,this.Gd())};
p.e2b=function(){if(this.J){var a=pIc(this.J);a.sf(this.Fc);pKc(this,a);this.H.getTitle()&&a.setOption("title",this.H.getTitle());LV(a,a.Od());var b=this.qa,c=this.Fc,d=this.D.F,e=new pHc;H(e,1,d);d=new LX;Zf(d,11,e);e=new vU;Zf(e,4,d);d=new fg;Zf(d,46,e);this.dispatchEvent(new YHc(a,b,c,2874,void 0,void 0,d))}};p.tA=function(){ei(this.Da,"Answer Card for question: "+this.D.D)};p.AA=Ie;p.jz=n("assistantAnswersFeedback");p.WB=n(2628);p.VB=n(2627);p.j6=n("Was this answer correct?");p.hja=n("Correct");
p.gja=n("Incorrect");p.oN=g("D");p.iy=function(a){pY.ma.iy.call(this,a);this.ea&&(this.ea.H=a);this.$&&xHc(this.$,a);mKc(this);jKc(this);kKc(this)};p.bZ=function(){pY.ma.bZ.call(this);if(!this.zd){var a=this.vd,b=this.Rh;wW(a);for(var c=0;c<b.length;c++)SAc(a,b[c]);this.zd=!0}};p.fR=function(){pY.ma.fR.call(this);wW(this.vd);this.zd=!1};p.iFb=function(){switch(oV(this.L)){case 0:qKc(this,!1);break;case 1:qKc(this,!1);kKc(this);break;case 2:qKc(this,!0);kKc(this);break;default:oV(this.L)}};
function qKc(a,b){L(a.La("waffle-assistant-answercard-chart-container"),b);a.Na?L(a.La("waffle-assistant-answercard-pivot-content"),!b):(L(a.La("waffle-assistant-answercard-answer"),!b),L(a.La("waffle-assistant-answercard-formula-holder"),!b));jKc(a);!a.Db&&b&&oKc(a,a.D.getChartType())}function mKc(a){var b=a.xb("waffle-assistant-answercard-formula-help");b&&L(b,!a.Gd())}function jKc(a){var b=(a.Xd||2==oV(a.L))&&!a.Gd();a.kb.setVisible(b)}
function kKc(a){var b=a.Na&&!a.Gd()&&(!a.Ua||1==oV(a.L));a.jb.setVisible(b)}function lKc(a,b){a.O.setVisible(!b);a.Oa.setVisible(b);L(a.La("waffle-assistant-answercard-formula"),b);b?a.La("waffle-assistant-answercard-formula-text").focus():(a.O.Da.focus(),a.O.Mp(!0))}p.g2b=function(){ZJc(this.ah,!0);this.dispatchEvent(new E("rc"))};p.MCb=function(){lKc(this,!0)};p.iub=function(){lKc(this,!1)};p.YNa=function(){nKc(this,!0)};p.qKb=function(){nKc(this,!1)};
function nKc(a,b){var c=new LX;H(c,9,b);b=new vU;Zf(b,4,c);c=new fg;Zf(c,46,b);c=kj(jj(new ij,10),c).build();a.V.Xb(2849,c)}p.nKb=function(a){var b=this.D.V,c=new oHc;Zf(c,1,b);switch(a){case 0:H(c,2,2);break;case 1:H(c,2,3);break;case 2:H(c,2,1);break;default:H(c,2,0)}a=new LX;Zf(a,10,c);c=new vU;Zf(c,4,a);a=new fg;Zf(a,46,c);c=kj(jj(new ij,10),a).build();this.V.Xb(2850,c)};p.pKb=function(){this.V.Xb(2709,this.He)};
p.ttb=function(){var a=this.oa().Eb(),b=a.createElement("textarea");b.textContent=this.D.Xm;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&(rKc(this.xi,"Formula copied to clipboard",this.oa()),this.V.C(35534,this.He))};function sKc(a,b,c){b=c||b;return R('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+Q(cKc({aM:a.tEa.aM}))+Q(aKc({error:a.tEa.error,showHelp:a.showHelp},b))+"</div></div>")}function tKc(){return R('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')};function qY(a,b,c,d,e){WX.call(this,new uG,e);this.H=a;this.O=b;this.L=d;this.V=c;this.J=new kr("",new QX,this.oa());this.Ha(this.J);this.C=new kr("",new sW,this.oa());this.Ha(this.C);this.D=new kr("",new sW,this.oa());this.Ha(this.D)}y(qY,WX);p=qY.prototype;p.tA=function(){ei(this.Da,"Error Card for question: "+this.H.D)};p.jz=n("assistantAnswersFeedback");p.AA=Ie;p.c8=He;p.xa=function(){qY.ma.xa.call(this);YX(this).appendChild(P($Jc))};
p.Ia=function(){qY.ma.Ia.call(this);var a=this.La("waffle-assistant-answers-card-remove");this.J.Va(a);this.D.setVisible(this.L);TX(a,"Remove card",0);this.getHandler().Vc(this.J,"action",this.m2b).Vc(this.C,"action",this.YCb).R(this.D,"action",this.l2b)};
p.DA=function(a){XX(this).appendChild(P(sKc,{tEa:OJc(this.H),showHelp:this.L}));if(GA){var b=P(tKc);this.oa().appendChild(this.Da,b);this.C.Va(this.La("waffle-assistant-answercard-feedback-link"))}this.L&&this.D.Va(this.La("waffle-assistant-answers-helpcenter-link"));a()};p.qia=g("O");p.oN=g("H");p.YCb=function(){this.C.setVisible(!1);L(this.La("waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new E("trigger_feedback"))};p.m2b=function(){ZJc(this.V,!1);this.dispatchEvent(new E("rc"))};
p.l2b=function(){K.ao.wc()};function uKc(a){WX.call(this,new uG,a);this.C=this.oa().createElement("div");qe(this.C,"Previous")}y(uKc,WX);p=uKc.prototype;p.tA=function(){ei(this.Da,"Previous questions below")};p.xa=function(){uKc.ma.xa.call(this);ch(this.Da,"waffle-assistant-card");ah(this.Da,"waffle-assistant-answers-previousheadercard")};p.DA=function(a){0<this.oa().Oh(XX(this)).length||XX(this).appendChild(this.C);a()};p.c8=He;p.jz=n("assistantAnswersFeedback");function vKc(a,b,c){b=c||b;c=""+(""+(a.e5?Q(aKc({error:a.e5,showHelp:a.showHelp},b)):"")+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+Q(a.title)+"</div>":""));var d=bq("Suggested question");c+='<div class="waffle-assistant-suggested-questions">';a=a.lw;for(var e=a.length,f=0;f<e;f++){var h=a[f];c+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+T(d)+'">'+Q(hs({icon:"docs-icon-img docs-icon-help"},
b))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+Q(h)+"</div></div></div>"}return R(c+"</div>")};function rY(a,b,c,d,e,f){WX.call(this,a,f);this.C=e||null;this.O=b;this.D=d;this.V=c;this.L=this.C?5==this.C.error:!1;this.H=new kr("",new sW,this.oa());this.Ha(this.H);this.J=new kr("",new QX,this.oa());this.Ha(this.J)}y(rY,WX);p=rY.prototype;p.xa=function(){rY.ma.xa.call(this);this.AA()&&YX(this).appendChild(P($Jc))};
p.Ia=function(){rY.ma.Ia.call(this);ah(this.Da,"waffle-assistant-answers-suggestioncard");this.H.setVisible(this.L);this.getHandler().R(this.H,"action",this.n2b);if(this.AA()){var a=this.La("waffle-assistant-answers-card-remove");this.J.Va(a);TX(a,"Remove card",0);this.getHandler().Vc(this.J,"action",this.o2b)}};p.WB=function(){return db([wKc,xKc],this.D)?2799:db([yKc,zKc],this.D)?2801:null};p.VB=function(){return db([wKc,xKc],this.D)?2798:db([yKc,zKc],this.D)?2800:null};p.j6=n("Were these interesting?");
p.hja=n("Interesting");p.gja=n("Not interesting");p.jz=n("assistantAnswersFeedback");p.AA=function(){return this.C?!JJc(this.C):!1};p.tA=function(){var a=this.D.title;a&&this.C?(a=(PJc(this.C)||"")+(" "+(a+(" for question : "+this.C.D))),ei(this.Da,a)):ei(this.Da,"Suggested questions")};
p.DA=function(a){var b=this;this.V.then(function(c){if(b.Wb()){if(0==c.length)L(b.Da,!1);else{var d=b.oa(),e=XX(b);if(0==d.Oh(e).length){var f=P(vKc,{title:b.D.title,lw:Wa(c,function(a){return a.query}),e5:b.C?PJc(b.C):"",showHelp:b.L});e.appendChild(f);var h=Wa(c,function(a){return a.type});e=b.Ki("waffle-assistant-answercard-question-container");A(e,function(a,e){var f=new kr("",new QX,d);b.Ha(f);f.Va(a);b.getHandler().R(f,"action",v(b.TEb,b,c[e],h,e))});b.L&&b.H.Va(b.La("waffle-assistant-answers-helpcenter-link"))}}a()}})};
p.o2b=function(){ZJc(this.O,!1);this.dispatchEvent(new E("rc"))};p.TEb=function(a,b,c){this.dispatchEvent(new EHc(this.D.R0,a.Xm||null,b,c,this.D.YV,a.query))};p.n2b=function(){K.ao.wc()};var AKc={title:"",YV:0,R0:null},wKc={title:"",YV:5,R0:1},xKc={title:"Suggested questions",YV:5,R0:1},zKc={title:"Did you mean?",YV:2,R0:4},yKc={title:"Related questions",YV:4,R0:4};function BKc(a){var b=[];if(Uv(a,25)&&(a=W(a,25)))for(var c=0;c<Vv(a,1);c++){var d=W(a,1,c);if(Uv(d,2)){var e=W(d,2);e&&b.push(CKc(e,DKc(d)))}}return b}function EKc(a){var b=BKc(a);Uv(a,6)&&(a=W(a,6))&&b.push(CKc(a,0));return b}function DKc(a){return(a=Uv(a,4)?W(a,4):0)?a:0}function CKc(a,b){return{name:a,M4a:b}};function FKc(a,b,c){this.qa=a;this.Aa=b;this.L=[];this.O=[];this.H=[];this.J=[];this.$=[];this.ea=[];this.C={};this.F={};this.V={};this.D={};GKc(this,c)}function HKc(a,b){return a[b]?a[b].values.Cd():[]}
function GKc(a,b){for(var c=new Xq,d=new Xq,e=0;e<b.length;e++){for(var f=EKc(b[e]),h=[],k=[],l=0;l<f.length;l++){var m=f[l].name.toLowerCase();if(void 0!=a.qa[m]){var q=a.qa[m];c.add(q);h.push(q)}void 0!=a.Aa[m]&&(m=a.Aa[m],d.add(m),k.push(m))}IKc(a,h,k)}a.L=c.Cd();a.O=d.Cd();vb(a.L);vb(a.O);a.H=Wa(nc(a.C),function(a){return a.key});vb(a.H);a.J=Wa(nc(a.F),function(a){return a.key});vb(a.J);a.$=Wa(nc(a.V),function(a){return a.key});vb(a.$);a.ea=Wa(nc(a.D),function(a){return a.key});vb(a.ea)}
function IKc(a,b,c){for(var d=0;d<b.length;d++)for(var e=d+1;e<b.length;e++)b[d]!=b[e]&&(JKc(a.C,b[d],b[e]),JKc(a.C,b[e],b[d]));for(d=0;d<b.length;d++)for(e=0;e<c.length;e++)JKc(a.F,b[d],c[e]),JKc(a.V,c[e],b[d]);for(b=0;b<c.length;b++)for(d=b+1;d<c.length;d++)c[b]!=c[d]&&(JKc(a.D,c[b],c[d]),JKc(a.D,c[d],c[b]))}function JKc(a,b,c){var d;a[b]?d=a[b].values:d=new Xq;d.add(c);a[b]={key:b,values:d}};function KKc(a,b){this.C=a;for(var c={},d=0;d<a.Lj();d++)c[a.ld(d).getName().toLowerCase()]=d;this.O=c;c={};for(d=0;d<Vv(a,1);d++)c[W(a,1,d).getName().toLowerCase()]=d;this.V=c;c={};for(d=0;d<this.C.Lj();d++)c[W(this.C.ld(d),11)]=d;this.ea=c;c={};for(d=0;d<Vv(this.C,1);d++)c[W(W(this.C,1,d),4)]=d;this.qa=c;c=[];for(d=0;d<a.Lj();d++)sY(a.ld(d).getName())&&c.push(d);this.J=c;c=[];for(d=0;d<Vv(a,1);d++)sY(W(a,1,d).getName())&&c.push(d);this.L=c;c=[];for(d=0;d<Vv(a,1);d++){for(var e=W(a,1,d).getName(),
f=!0,h=0;h<LKc.length;h++)if(-1!=e.search(new RegExp("(\\b|_)"+LKc[h]+"(\\b|_)","i"))){f=!1;break}f&&c.push(d)}this.Ga=c;this.Na=MKc(a,0);this.$=MKc(a,1);c=[];for(d=0;d<a.Lj();d++).8<=W(a.ld(d),6)&&c.push(d);this.Aa=c;c=[];for(d=0;d<a.Lj();d++)e=a.ld(d),.95<=Zv(e,2).length/W(e,8)&&c.push(d);this.Oa=c;c=[];for(d=0;d<Vv(a,3);d++){e=a.ld(W(a,3,d));a:if(.5<Zv(e,2).length/W(e,8)||.3>Vv(e,3)/Vv(e,2))e=!1;else{for(f=0;f<Vv(e,10);f++)if(.95<W(e,10,f)/W(e,8)){e=!1;break a}e=!0}e&&c.push(W(a,3,d))}vb(c);this.Ja=
c;this.F=NKc(a.Lj());this.H=NKc(Vv(a,1));this.D=new FKc(this.O,this.V,b)}function NKc(a){for(var b=[],c=0;c<a;c++)b.push(c);return b}function MKc(a,b){for(var c=[],d=0;d<a.Lj();d++)a.ld(d).getType()==b&&c.push(d);return c}function OKc(a,b){if(0==a.length&&0==b.length)return[];for(var c=0<a.length?a[0]:b[0],d=1;d<a.length;d++)c=PKc(c,a[d]);for(a=0;a<b.length;a++)d=PKc(c,b[a]),c=0<d.length?d:c;return c}
function tY(a,b,c,d,e,f,h,k){var l=[a.J,a.D.L],m=[a.F];c&&(m.push(a.Na),m.push(a.Aa));d&&m.push(a.Ja);e&&m.push(a.Oa);null!=h&&-1!=h?l.push(HKc(a.D.V,h)):f&&l.push(a.D.J);k&&l.push(a.D.H);a=OKc(m,l);b=PKc(a,b);return 0<b.length?{index:PX(b),vB:3}:0<a.length?{index:PX(a),vB:1}:QKc()}
function uY(a,b,c,d,e,f){var h=[a.L,a.D.O],k=[a.H];c&&k.push(a.Ga);null!=e&&-1!=e?h.push(HKc(a.D.F,e)):d&&h.push(a.D.$);f&&h.push(a.D.ea);a=OKc(k,h);b=PKc(a,b);return 0<b.length?{index:PX(b),vB:3}:0<a.length?{index:PX(a),vB:1}:QKc()}function RKc(a,b){for(var c=5;;){var d=a.C.ld(b),e=OX(Vv(d,2),1)[0];c--;if(sY(NX(d,e))||0==c)return e}}function SKc(a,b){for(var c=5;;){var d=a.C.ld(b),e=OX(Vv(d,3),1)[0];e=W(d,3,e);c--;if(sY(NX(d,e))||0==c)return e}}
function vY(a,b){b=a.C.ld(b);a=b.getName();sY(a)||(b=TKc(Zv(b,7)),a=null==b?a:b);return a}function wY(a,b){b=W(a.C,1,b);a=b.getName();sY(a)||(b=TKc(Zv(b,2)),a=null==b?a:b);return a}function TKc(a){for(var b=0;b<a.length;b++)if(sY(a[b]))return a[b];return null}function sY(a){return null==a?!1:50>=a.length}function UKc(a,b){return b.toLowerCase()in a.O?a.O[b.toLowerCase()]:-1}function QKc(){return{index:-1,vB:0}}
function VKc(a){for(var b=OX(a.length,2),c=[],d=0;d<b.length;d++)c.push({index:a[b[d]],vB:1});return c}function PKc(a,b){vb(a);vb(b);for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}var LKc=["average","total","sum","mean","median"];function xY(a){this.Na=a;this.lw=[];this.C=this.qa=this.ea=this.ZK=this.wH=null;this.V=[];this.Ja=[];this.O=new Xq;this.Aa=new Xq;this.$=!1;this.D=[];this.F=[]}p=xY.prototype;p.Ie=function(a,b,c,d,e,f){this.reset();this.wH=b;this.ZK=c;this.ea=d;this.qa=a;this.Ja=f;this.V=V0a?e:[];this.C=new KKc(a,e)};
p.A9=function(){WKc(this);var a=[];if(V0a)for(var b=0;b<this.V.length;b++){var c=this.V[b];switch(c.getChartType()){case "BarChart":if(this.wk(13)||this.wk(2)){var d=W(c,6);if(d&&-1!=UKc(this.C,d)){var e=XKc(this,c);1<e.length&&(IA&&this.wk(23)?yY(this,a,"Scatter chart of "+e[0].name+" vs "+e[1].name,23,2):this.wk(2)&&yY(this,a,"Correlation of "+e[0].name+" and "+e[1].name,2,1.5))}}break;case "ScatterChart":var f=XKc(this,c);1<f.length&&(IA&&this.wk(23)?yY(this,a,"Scatter chart of "+f[0].name+" vs "+
f[1].name,23,2):this.wk(2)&&yY(this,a,"Correlation of "+f[0].name+" and "+f[1].name,2,1.5));break;case "PieChart":for(var h=void 0,k=[],l=BKc(c),m=0;m<l.length&&-1!=UKc(this.C,l[m].name);m++)k.push(l[m]);h=k;1==h.length&&4==h[0].M4a&&(IA&&this.wk(20)?yY(this,a,"Chart of distribution of "+h[0].name,20,2):this.wk(14)&&yY(this,a,"Distribution of "+h[0].name,14,1.5))}}if(this.wk(26))for(var q=ja(this.Ja),t=q.next();!t.done;t=q.next()){var w=t.value;Uv(w,3)&&yY(this,a,w.hg(),26,2)}if(this.wk(1)){var x=
this.C.C,z=uY(this.C,this.F,!1,!0),C=z.index,M=tY(this.C,this.D,!0,!1,!0,!0,C),O=M.index;if(-1!=O&&-1!=C){var S=10<=Vv(x.ld(O),2)?"5 ":"",ha=vY(this.C,O),ca=wY(this.C,C);if(ha!=ca){var qa=zY(1,[z],[M]);yY(this,a,this.bHa(1)+" "+S+ha+" by "+ca,1,qa)}}}if(this.wk(2)&&1<Vv(this.C.C,1)){a:{var sa=this.C,wa=this.F;if(2>sa.H.length)var ya=[QKc(),QKc()];else{var Xa=uY(sa,wa,!1,!1,void 0,!0),bb=Xa.index;if(-1!=bb){var Ua=HKc(sa.D.D,bb);if(0<Ua.length){var ub=[Xa],wc=PX(Ua),Xb=2,Qc=PKc(Ua,wa);0<Qc.length&&
(wc=PX(Qc),Xb=3);ub.push({index:wc,vB:Xb});ya=ub;break a}}ya=VKc(2<=sa.L.length?sa.L:sa.H)}}var Kc=ya,ie=wY(this.C,Kc[0].index),yd=wY(this.C,Kc[1].index);if(ie!=yd){var Rb=zY(1,Kc,[]);yY(this,a,"Correlation of "+ie+" and "+yd,2,Rb)}}if(this.wk(3)){var vf=this.C.C,sb=uY(this.C,this.F,!0),ae=sb.index;if(-1!=ae){var be=zY(1,[sb],[]);yY(this,a,this.XP(Zv(W(vf,1,ae),3),3)+" of "+wY(this.C,ae),3,be)}}if(this.wk(5)){var Ef=this.C.C,Tf=uY(this.C,this.F,!0,!0),gj=Tf.index,Pi=tY(this.C,this.D,!0,!0,!1,!0,gj),
$h=Pi.index;if(-1!=gj&&-1!=$h){var Qi=wY(this.C,gj),Pk=Ef.ld($h),Qk=vY(this.C,$h);if(0<Vv(Pk,3)&&Qk!=Qi){var Rl=zY(1,[Tf],[Pi]),Uj=SKc(this.C,$h);yY(this,a,this.XP(Zv(W(Ef,1,gj),3),5)+" of "+Qi+" when "+Qk+" is "+NX(Pk,Uj),5,Rl)}}}if(this.wk(9)){var Ng=uY(this.C,this.F,!1,!0),Ri=Ng.index,Sl=tY(this.C,this.D,!0,!1,!0,!0,Ri),ol=Sl.index;if(-1!=ol&&-1!=Ri){var Vj=wY(this.C,Ri),An=vY(this.C,ol);if(An!=Vj){var hj=zY(1,[Ng],[Sl]);yY(this,a,An+" with "+this.Wia(9)+" "+Vj,9,hj)}}}if(this.wk(10)&&0<Vv(this.C.C,
1)){var ai=uY(this.C,this.F),Wj=zY(1,[ai],[]),yj=wY(this.C,ai.index);yY(this,a,this.Wia(10)+" "+yj,10,Wj)}if(this.wk(11)){var ui=this.C.C,Tl=tY(this.C,this.D,!0,!0,!1,!1,-1),Bn=Tl.index;if(-1!=Bn){var zj=vY(this.C,Bn);if(0<Vv(ui.ld(Bn),3)){var Ap=zY(1,[],[Tl]);yY(this,a,"Most frequent "+zj,11,Ap)}}}if(this.wk(12)){var lo=this.C.C,Cn=uY(this.C,this.F,!0),Bp=Cn.index;a:{var Lm=this.C;if(1==Lm.$.length){var mo=Lm.$[0];if(!W(Lm.C.ld(mo),5)){var Ft=mo;break a}}Ft=-1}var Aj=Ft;if(-1!=Aj&&-1!=Bp){var br=
wY(this.C,Bp),Cp=lo.ld(Aj);if(0<Vv(Cp,2)){var ns=zY(1,[Cn],[]),cr=RKc(this.C,Aj);yY(this,a,this.XP(Zv(W(lo,1,Bp),3),12)+" of "+br+" "+PX(YKc)+" "+NX(Cp,cr),12,ns)}}}if(this.wk(15)){var pl=this.C.C,Dp=uY(this.C,this.F,!0),no=Dp.index,Dn=tY(this.C,this.D,!1,!0,!1,!0,no),Mm=Dn.index;if(-1!=no&&-1!=Mm){var Bj=wY(this.C,no),oo=vY(this.C,Mm);if(oo!=Bj){var Xj=pl.ld(Mm);if(2<=Vv(Xj,3)){var po=zY(1,[Dp],[Dn]),Ul=OX(Vv(Xj,3),2);yY(this,a,"Compare "+this.XP(Zv(W(pl,1,no),3),15)+" "+Bj+" for "+oo+" "+NX(Xj,
W(Xj,3,Ul[0]))+" and "+NX(Xj,W(Xj,3,Ul[1])),15,po)}}}}if(this.wk(16)){var En=tY(this.C,this.D,!0,!0,!1,!1),Ep=En.index;if(-1!=Ep){var Fn=vY(this.C,Ep),Vl=zY(1,[],[En]);yY(this,a,"List unique values in "+Fn,16,Vl)}}if(this.wk(17)){var vk=this.C.C,ql=tY(this.C,this.D,!0,!0,!1,!1),Wl=ql.index;if(-1!=Wl){var Xl=vk.ld(Wl),Nm=vY(this.C,Wl);if(!(1>Vv(Xl,3))){var Fp=SKc(this.C,Wl),dr=zY(1,[],[ql]);yY(this,a,"What percentage of "+Nm+" is "+NX(Xl,Fp),17,dr)}}}if(this.wk(13)){var Gp=this.C.C,os=uY(this.C,this.F,
!0,!0),qo=os.index,ps=tY(this.C,this.D,!0,!0,!1,!0,qo),Hp=ps.index;if(-1!=qo&&-1!=Hp){var Gt=wY(this.C,qo),er=vY(this.C,Hp);if(er!=Gt){var As=zY(1,[os],[ps]);yY(this,a,this.XP(Zv(W(Gp,1,qo),3),13)+" of "+Gt+" by "+er,13,As)}}}if(IA&&this.wk(18)){var Tt=uY(this.C,this.F),sl=Tt.index;if(-1!=sl){var I0=zY(2,[Tt],[]);yY(this,a,"Histogram of "+wY(this.C,sl),18,I0)}}if(this.wk(24)){var IR=tY(this.C,this.D,!0,!0),J0=IR.index;if(-1!=J0){var kK=zY(1,[IR],[]);yY(this,a,"Count of "+vY(this.C,J0),24,kK)}}if(this.wk(25)){var K0=
this.C.C,rF=tY(this.C,this.D,!0,!0),fB=rF.index;if(-1!=fB){var bw=K0.ld(fB),lK=RKc(this.C,fB),JR=zY(1,[rF],[]);yY(this,a,"Count when "+vY(this.C,fB)+" is "+NX(bw,lK),25,JR)}}var L0=3>a.length;if((L0||0==OX(5,1)[0])&&this.wk(7)){var KR=this.C.C,sF=uY(this.C,this.F,!1,!0),mK=tY(this.C,this.D,!1,!1,!1,!0,sF.index);if(-1!=mK.index&&-1!=sF.index){var cq=KR.ld(mK.index),LR=vY(this.C,mK.index),gB=wY(this.C,sF.index);if(0<Vv(cq,2)&&LR!=gB){var nK=zY(1,[sF],[mK]),oK=RKc(this.C,mK.index);yY(this,a,"Show "+
gB+" for "+LR+" "+NX(cq,oK),7,nK)}}}if((L0||0==OX(5,1)[0])&&this.wk(8)){var tF=this.C.C;a:{var Js=this.C,hB=this.D;if(2>Js.F.length)var pK=[QKc(),QKc()];else{var uF=tY(Js,hB,!0,!1,!1,!1,void 0,!0),dq=uF.index;if(-1!=dq){var qK=HKc(Js.D.C,dq);if(0<qK.length){var MR=[uF],Dda=PX(qK),NR=2,OR=PKc(qK,hB);0<OR.length&&(Dda=PX(OR),NR=3);MR.push({index:Dda,vB:NR});pK=MR;break a}}var eq=VKc(2<=Js.J.length?Js.J:Js.F);eq[0].index!=dq&&(eq[1]=eq[0],eq[0]=uF);pK=eq}}var zy=pK,PR=zy[0].index;if(1<tF.Lj()&&-1!=PR){var vF=
zy[1].index,QR=tF.ld(vF),Ks=vY(this.C,vF),fq=vY(this.C,PR);if(0<Vv(QR,2)&&Ks!=fq){var M0=zY(1,[],zy),wF=RKc(this.C,vF);yY(this,a,"What is "+fq+" where "+Ks+" is "+NX(QR,wF),8,M0)}}}this.lw=ZKc(a)};function WKc(a){if(a.$){var b=zK(a.Na).Dj(),c=$v(a.C.C,4);A(b,function(b){var d=b.left,f=b.width;c&&(d=b.top,f=b.height);for(b=0;b<f;b++){var h=a.C.ea[d+b],k=a.C.qa[d+b];h&&0<=h&&gb(a.D,h);k&&0<=k&&gb(a.F,k)}})}}p.reset=function(){this.lw=[];this.F=[];this.D=[];this.Aa=new Xq;this.O=new Xq};p.B9=function(){return ni(this.lw.slice())};
function ZKc(a){vb(a,function(a,c){return c.weight-a.weight});return Wa(a,function(a){return a.gra})}function yY(a,b,c,d,e){e=a.$Ga(d,e);a.Aa.contains(c)||(b.push({gra:{query:c,Xm:void 0,type:d},weight:e}),a.O.add(d),a.Aa.add(c))}p.wk=function(a){return!this.O.contains(a)};function $Kc(a,b){return a.B9().then(function(a){return a.length<=b?a:pb(a,0,b)},null,a)}function zY(a,b,c){A(b,function(b){3==b.vB&&a++});A(c,function(b){3==b.vB&&a++});return a}
function XKc(a,b){var c=[];b=BKc(b);for(var d=0;d<b.length;d++){var e=a.C,f=b[d].name;if(-1==(f.toLowerCase()in e.V?e.V[f.toLowerCase()]:-1))break;c.push(b[d])}return c}p.XP=function(a){a:{if(0<a.length)for(var b=0;b<a.length;b++)switch(a[b]){case 5:a=aLc;break a;case 4:a=bLc;break a}a=cLc}return PX(a)};p.bHa=function(){return PX(dLc)};p.Wia=function(){return PX(eLc)};
var cLc=["Average","Median"],aLc=["Total","Average","Median"],bLc=["Median"],eLc="Minimum Maximum Most Least Highest Lowest".split(" "),dLc=["Top","Bottom"],YKc=["before","after"];var fLc={};hc({N3a:{type:0,sA:"",pA:[]},xda:{type:1,sA:"Sum",pA:[3,5,13,12,15]},Tba:{type:2,sA:"Average",pA:[3,5,13,12,15]},Sca:{type:3,sA:"Mode",pA:[3]},c4a:{type:4,sA:"Variance",pA:[3]},Z2a:{type:5,sA:"Standard deviation",pA:[3]},Nva:{type:6,sA:"Median",pA:[3,5,13,12]},pU:{type:7,sA:"Count",pA:[24,25]},P2a:{type:8,sA:"Bottom",pA:[1,10,14]},Q2a:{type:9,sA:"Top",pA:[1,11,10,14]}},function(a){fLc[a.type]=a});function gLc(a){if(a=fLc[a])return a};function hLc(a){xY.call(this,a);this.H=[]}r(hLc,xY);p=hLc.prototype;p.reset=function(){xY.prototype.reset.call(this);this.H=[]};p.$Ga=function(a,b){return 1+b};p.wk=function(a){return!this.O.contains(a)&&0<iLc(this,a).length};p.bHa=function(a){return jLc(this,a)};p.XP=function(a,b){return jLc(this,b)};p.Wia=function(a){return jLc(this,a)};function kLc(a,b){a.reset();A(b,function(b){A(Zv(b,1),function(b){a.H.push(W(b,1))},a)},a);AHc(a.H);a.A9();return $Kc(a,3)}
function iLc(a,b){return Va(a.H,function(a){return db(gLc(a).pA,b)},a)}function lLc(a,b){a=ab(a.H,function(a){return gLc(a).type==b},a);return gLc(a)}function jLc(a,b){b=iLc(a,b);return lLc(a,PX(b)).sA};function AY(a,b,c,d,e,f,h,k,l,m,q,t,w,x){aY.call(this,x);this.He=c;this.Xd=d;this.We=e;this.Mc=a;this.jb=new hLc(this.Xd);this.Ra=h;this.$=m;this.gf=q;this.Pe=t;this.J=this.V=this.O=this.Bb=this.D=null;this.Ua="";this.Ga=new GHc;this.L=f;this.Ja=this.Ob=this.Oa=this.F=null;this.Na=k;this.Hd=!1;this.Ab=jj(new ij,10).build();this.Sc=new dw;this.wb=l;this.qa={};this.zd=Al();this.kb="";this.Aa=null;this.Af=w}y(AY,aY);p=AY.prototype;p.Ia=function(){AY.ma.Ia.call(this);this.rH(null==this.F)};
p.opa=function(a,b){AY.ma.opa.call(this,a,b);b=this.oa();var c=this.ea;this.O=new RX(b);c.Ha(this.O,!0);b.appendChild(a,this.O.Da);this.O.Ia();this.V=new QHc(this.O,this.L,this.Ga,10);c.va(this.V);c.getHandler().R(this.O,"answers-submit-query",v(this.i2b,this))};p.c4=function(){AY.ma.c4.call(this);this.V=this.O=null};
p.rH=function(a){var b=this;this.O&&this.O.setVisible(!a);a?(this.Aa&&this.Aa.dispose(),this.Aa=new zi(function(){AY.ma.rH.call(b,a)},300,this),this.va(this.Aa),this.Aa.start()):(this.Aa&&this.Aa.stop(),AY.ma.rH.call(this,a))};p.Jf=da("Bb");
function mLc(a,b,c,d,e,f,h){h=void 0===h?[]:h;var k=void 0===k?[]:k;a.jb.Ie(c,b,d,e,h,k);h=Wa(Zv(c,1),function(a){return a.getName()});var l=[],m=[];A(Zv(c,2),function(a){l.push(a.getName());m=m.concat(Zv(a,2))});HHc(a.Ga,h,l,m);a.Mc.B9().then(function(a){this.Ga.F=a;this.V&&(a=this.V,Fe(a.O.oa())==a.D&&a.YRa())},null,a);a.F=b;a.Oa=d;a.Ob=e;a.Ja=c;a.Ab=kj(jj(new ij,10),nLc(a)).build();if(f&&QA)for(c=Wa(a.C,function(a){if(a instanceof pY||a instanceof qY)return a.oN().D}),a.cW(),d=0;d<c.length;d++)if(e=
c[d])f=new MX,H(f,1,5),oLc(a,e,f);a.rH(null==b)}p.reset=function(){MU(this.qa);MU(this.Ga.D);var a=this.Ga;a.F=[];a.C.clear();this.J=null;this.KBa()};
function oLc(a,b,c,d,e){d=void 0===d?null:d;e=void 0===e?!1:e;H(c,13,a.$.L.F);var f=new LX;Zf(f,5,c);WHc(a.V);if(!a.Bb||a.Bb.getStatus().getState().Ch())if(a.qa[b])pLc(a,b,!1);else{d=new oY(b,null,null,null,2,a.$);qLc(a,d,!0,f);return}else{var h=a.qa[b];h&&h instanceof qY&&2==h.oN().error&&delete a.qa[b]}if(b&&a.F)if(a.qa[b])a.L.Xb(2681,a.Ab),pLc(a,b,!0);else{h=nLc(a);var k=Xf(Xf(h,vU,46),LX,4);H(k,2,e);e=kj(jj(new ij,10),h).build();a.L.Xb(2635,e);e=RF(a.F.rect);f=wv(Pt(ts(Ot(Cq(a.Bb.Ke("/answers/parse").Ef("q",
b,"qt",G(c,1),"gid",a.F.ud,"range",e,"context",a.Ua),v(a.Zk,a,b,f)),v(a.h2b,a,b,f)),"POST"),2));QA&&a.Oa&&null!=a.Ob&&(b=0==a.Oa.rect.width||0==a.Oa.rect.height?"":RF(a.Oa.rect),f.Ef("headerRange",b,"tableRecordDimension",""+a.Ob));d&&f.Ef("sgfml",d);f.ue();a.kb=Bl(a.zd,uA.dta);rLc(a,!0)}else UHc(a.V,"")}function pLc(a,b,c){var d=a.qa[b];d!=Ra(a.C)&&(1<a.C.length&&sLc(a),c&&tLc(a,d.oN()).then(function(a){uLc(this,d,a)},null,a),SIc(a,d))}
p.i2b=function(a){var b=a.C;var c=a.Ga;var d=a.J,e=a.Aa;c?c=DJc(b,d,e,c):(c=new MX,H(c,1,b));oLc(this,a.$,c,a.F,a.V)};p.h2b=function(a,b){if(this.F){var c=G(Xf(b,MX,5),1);c=1==c||4==c?yHc.$xa:yHc.Bya;var d=nLc(this),e=Xf(Xf(d,vU,46),LX,4);H(e,1,c);H(b,1,c);c=kj(jj(new ij,10),d).build();this.L.Xb(2640,c);vLc(this,a,b)}};function vLc(a,b,c){rLc(a,!1);b=new oY(b,null,null,null,3,a.$);qLc(a,b,!1,c);wLc(a)}
p.Zk=function(a,b,c){this.F&&this.Na.C.D.C.then(function(){var d=null,e=null,f=!1,h=Xf(b,MX,5),k=G(h,1),l=nLc(this);k=1==k||4==k?yHc.$xa:yHc.Bya;var m=Xf(Xf(l,vU,46),LX,4);H(m,1,k);H(b,1,k);k=kj(jj(new ij,10),l).build();if(c.bl()){e=this.Sc.xd(jY.Ca(),c.Xe());if(f=e.getStatus()){switch(f){case 1:var q=2639;break;case 2:q=2643;break;case 3:q=2644;break;case 4:q=2638;break;case 5:q=2707;break;case 6:q=2706}q&&this.L.Xb(q,k)}q=W(e,10);H(h,4,q);q=W(e,11);H(h,5,q);Uv(e,16)&&(q=W(e,16),H(h,16,q));if(1==
f){vLc(this,a,b);return}if(2==f){e=-1!=xLc(a);h=-1!=CJc(a);f=4;d=Xf(b,MX,5);e?(f=5,H(d,8,2)):h&&(f=7,H(d,8,1));h=new oY(a,null,null,null,f,this.$);e?(e=new qY(h,!0,this.wb,!0,this.oa()),yLc(this,h,e,b)):qLc(this,h,!0,b);rLc(this,!1);wLc(this);return}l=Uv(e,2)?W(e,2):null;f=!0;if(l){q="";d=vHc(this.Na,l,this.F,!!this.Ja&&!!W(this.Ja,4));H(h,14,!!d);if(!d){if(m=l.match(/([A-Z]*)\(/)){var t=Xf(Xf(Aka(k),vU,46),LX,4);H(t,7,m[1]);H(b,7,m[1])}this.L.Xb(2645,k)}d&&wHc(d)||(q=this.Na,t=this.F,k="="!=l[0]?
"="+l:l,m=tHc(q),t=uHc(m,t),q=i1b(q.C,k,m,t.row,t.sj));k=Uv(e,19)?vHc(this.Na,W(e,19)||"",this.F,!!this.Ja&&!!W(this.Ja,4)):d;d=new oY(a,d,"="!=l[0]?"="+l:l,e,null,this.$,k);if(Uv(e,23)&&d.Rj()){if(Uv(e,17)&&Uv(W(e,17),5)){k=d;l=W(W(e,17),5);k=k.xWa;if(Uv(l,5))switch(W(l,5).getPosition()){case 1:k.C="right";break;case 2:k.C="left";break;case 3:k.C="top";break;case 4:k.C="bottom"}Uv(l,1)&&Uv(W(l,1),1)&&Uv(W(W(l,1),1),1)&&1==W(W(W(l,1),1),1)&&(k.L=!0);Uv(l,2)&&Uv(W(l,2),1)&&Uv(W(W(l,2),1),1)&&1==W(W(W(l,
2),1),1)&&(k.O=!0);Uv(l,1)&&Uv(W(l,1),1)&&Uv(W(W(l,1),1),2)&&(m=W(W(W(l,1),1),2),k.F=m);Uv(l,2)&&Uv(W(l,2),1)&&Uv(W(W(l,2),1),2)&&(m=W(W(W(l,2),1),2),k.H=m);Uv(l,3)&&(m=l.getTitle().getTitle(),k.J=m);Uv(l,4)&&(l=W(l,4).getTitle(),k.D=l)}this.Ua=$v(e,23)}else this.Ua="";q&&d.L.push(q);d.Rj()&&Zf(h,15,d.V);d.Pv()&&Uv(e,24)&&(q=qBc($v(e,24)),Zf(h,17,q))}else!d&&Uv(e,24)?(d=new oY(a,[[]],"",e,null,this.$,[[]]),this.Ua=$v(e,23),q=qBc($v(e,24)),Zf(h,17,q)):Uv(e,9)&&(q=e.getError(),d=new oY(a,null,null,
e||null,6,this.$),l=W(q,2),H(h,6,l),Uv(q,3)&&(q=W(q,3),H(h,12,q)))}else this.L.Xb(2640,k);d||(d=new oY(a,null,null,e||null,4,this.$));rLc(this,!1);JJc(d)?zLc(this,d,f,b):qLc(this,d,f,b);wLc(this)},function(){vLc(this,a,b)},this)};function wLc(a){""!=a.kb&&(Cl(a.zd,a.kb),a.kb="")}function ALc(a){if(null!=a.Xm)return yKc;switch(a.error){case 4:case 6:return 0<a.O.length?zKc:xKc;case 5:return xKc}return AKc}
function nLc(a){var b=new LX;H(b,8,j1a);var c=new vU;Zf(c,4,b);a=zIc(a.F);Zf(a,46,c);return a}function xLc(a){return cb(AJc,function(b){return Fb(a,b)})}function BLc(a,b){var c=[];b=b.O;for(var d=0;d<b.length&&3>c.length;++d){var e=a.Na;var f=W(b[d],2);var h=!!a.Ja&&!!W(a.Ja,4);f=vHc(e,f,a.F,h);wHc(f)&&(f={query:W(b[d],1),Xm:W(b[d],2),type:b[d].getType()},Uv(b[d],5)&&(f.nFa=W(b[d],5)),c.push(f))}return ni(c)}
function zLc(a,b,c,d){c=new pY(b,a.He,a.Xd,a.We,a.L,a.wb,a.Ra,c,a.$,a.Hd,a.Af,a.Na,a.oa());yLc(a,b,c,d)}function CLc(a,b,c){if(a.D&&a.D.isVisible())PQ(a.D);else{var d=a.gf.D.C["ritz-ap"]||null;c.QM()&&(a.D=C_b(a.Pe,a.oa(),d,void 0,"answersChartsPromo"),a.D&&(a.D.show(),a.va(a.D),a.getHandler().Vc(a,"Id",a.KBa)));b.Rj()&&dJa(d,"answersChartsPromo")}}p.Aba=function(){AY.ma.Aba.call(this);this.D&&this.D.isVisible()&&this.D.C.yd()};p.KBa=function(){this.D&&this.D.isVisible()&&PQ(this.D)};
function qLc(a,b,c,d){c=new qY(b,c,a.wb,!1,a.oa());yLc(a,b,c,d)}function yLc(a,b,c,d){sLc(a);var e=tLc(a,b,d);DLc(a,c);c instanceof pY&&CLc(a,b,c);ELc(a);JJc(b)&&IHc(a.Ga,b.D);e.then(function(a){if(d){if(c instanceof pY){var b=Xf(d,MX,5);H(b,18,c.$b)}b=nLc(this);var e=Xf(b,vU,46);Zf(e,4,d);b=kj(jj(new ij,10),b).build();this.L.Xb(2781,b)}uLc(this,c,a)},null,a);c.qia()&&(a.qa[b.D]=c);a.getHandler().R(c,"rc",a.fLa)}
function uLc(a,b,c){b instanceof qY&&null!=c&&Kh(c.getElement())&&(b=b.getElement(),L(b,!1),a.getHandler().R(c,"rc",a.fLa))}function sLc(a){FLc(a);A(a.C,function(a){a instanceof qY&&(a=a.getElement(),L(a,!0))});GLc(a)}function GLc(a){0!=a.C.length&&(a.J?SIc(a,a.J):(a.J=new uKc(a.oa()),DLc(a,a.J)))}function FLc(a){A(a.C,function(b){b instanceof pY||b instanceof qY||b==a.J||a.dH(b)})}
function HLc(a,b){var c=ni([]);b=b.qa;0<b.length&&(c=kLc(a.jb,b));return c=c.then(function(b){var c=3-b.length;return 0<c?$Kc(a.Mc,c).then(function(a){return mb(b,a)}):ni(b)})}
function tLc(a,b,c){var d=ALc(b),e=null;d==yKc||d==zKc?0<b.O.length&&(e=BLc(a,b)):d==xKc&&(e=HLc(a,b));var f=null;return e?(f=new rY(new uG,a.wb,e,d,b,a.oa()),DLc(a,f),a.L.Xb(2769,a.Ab),a.getHandler().R(f,"sqc",v(a.SEb,a)),e.then(function(a){if(c){var b=Xf(c,MX,5);db([yKc,zKc],f.D)?(a=FJc(a),Zf(b,7,a)):db([wKc,xKc],f.D)&&(a=GJc(a),Zf(b,9,a))}return f},null,a)):ni(f)}p.SEb=function(a){UHc(this.V,a.F,!0);var b=a.$;b=1==b?DJc(b,a.C,a.J,3):EJc(b,a.C,a.J,a.Aa);oLc(this,a.F,b,a.V);this.L.Xb(2762,this.Ab)};
function rLc(a,b){a.O&&(a=a.O,L(a.H,b),L(a.oa().La("waffle-assistant-answers-button-container",a.C),!b),rW(a.F,b))}function DLc(a,b){b.iy(a.Gd());a.C.push(b);if(a.$b){RIc(a,!1);var c=a.H.cd();b.qa=c;a.H.jh(b,0,!0);b.eJ()}vIc(b,!0)}function ELc(a){for(var b=a.C;5<b.length;)a.dH(b[0])}p.cW=function(){AY.ma.cW.call(this);this.reset()};
p.fLa=function(a){var b=this,c=this.oa();a=a.target;if(a instanceof pY)this.dH(a),rKc(this.Ra,"Answer removed",c,v(this.HBb,this,a));else if(a instanceof qY)this.dH(a),rKc(this.Ra,"Card removed",c);else if(a instanceof rY&&a.C&&!JJc(a.C)){var d=a.C.D;A(this.C,function(a){a instanceof qY&&a.oN().D==d&&(b.dH(a),rKc(b.Ra,"Card removed",c))})}a=this.C;!this.J||a[0]!=this.J&&a[a.length-1]!=this.J||(this.dH(this.J),this.J=null)};
p.HBb=function(a){zLc(this,a.oN(),a.qia());rKc(this.Ra,"Remove answer undone",this.oa())};p.dH=function(a){if(a.Wb()){if(a instanceof pY||a instanceof qY)delete this.qa[a.oN().D],a==Ra(this.C)&&FLc(this);AY.ma.dH.call(this,a)}D(a)};function ILc(a,b,c){b=c||b;a=""+(""+R('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input waffle-assistant-answers-input-with-icon"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
Q(hs({icon:"docs-icon-img docs-icon-search-this-document"},b))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+jq("Ask a question about your data")+'"/></div></form></div>');return R(a)};function JLc(a,b,c){xY.call(this,a);this.J=[];this.L=this.H=null;this.Ga=b;this.Ra=c;this.Oa=jj(new ij,10).build()}r(JLc,xY);p=JLc.prototype;p.A9=function(){this.reset();xY.prototype.A9.call(this);U0a&&KLc(this)};p.reset=function(){xY.prototype.reset.call(this);this.J=[];this.H&&(this.H.cancel(),this.H=null)};p.B9=function(){return U0a&&this.H?this.H.then(function(){return this.J.slice()},null,this):xY.prototype.B9.call(this)};p.$Ga=function(a,b){return Math.pow(Math.random(),1/(LLc(a)*b))};
p.Jf=da("L");function LLc(a){switch(a){case 13:return.34;case 3:return.37;case 12:return.25;case 5:return.3;case 15:return.34;case 2:return.43;case 8:return.76;case 9:return.35;case 14:return.47;case 11:return.4;case 7:return.37;case 10:return.36;case 17:return.41;case 1:return.42;case 16:return.3;case 26:return.5;default:return.3}}
function KLc(a){var b=null;a.H=new li(function(a){if(!this.L||this.L.getStatus().getState().Ch())this.J=this.lw,a();var c=RF(this.wH.rect),e=Wa(this.lw,function(a){return a.query});c=ts(wv(Pt(Ot(Cq(this.L.Ke("/answers/parsesuggestions").Ef("gid",this.wH.ud,"range",c),v(function(b){MLc(this,b).then(a)},this)),v(function(b){8==b.errorCode&&this.Ra.Xb(2833,this.Oa);this.J=this.lw;a()},this)).setContent(["queries",$n(e)]).setTimeout(2E3),1)),"POST");QA&&this.ZK&&null!=this.ea&&(e=0==this.ZK.rect.width||
0==this.ZK.rect.height?"":RF(this.ZK.rect),c.Ef("headerRange",e,"tableRecordDimension",""+this.ea));b=c.ue()},a);si(a.H,function(){b&&b.dispose()})}function MLc(a,b){return a.Ga.C.D.C.then(function(){var a=[];if(b.bl())for(var d=b.Xe(),e=0;e<d.length;e++){var f;if(f=d[e]){f=this.Ga;var h=!!this.qa&&!!W(this.qa,4);f=vHc(f,d[e],this.wH,h);f=wHc(f)}f&&(this.lw[e].Xm=d[e],a.push(this.lw[e]))}this.J=a},function(){this.J.length=0},a)};function BY(a,b,c,d,e,f,h,k,l,m,q){bY.call(this,1,f,e,q);this.kb=c;this.Ja=null;this.qa=new kr("",new sW,this.oa());this.Ha(this.qa);this.Aa=new kr("",new sW,this.oa());this.Ha(this.Aa);f=new J4b(a,!0,!0);f=new QAc(f,c);this.Ua=new YJc(e);this.O=new JLc(this.kb,f,e);this.H=new AY(this.O,a,b,c,d,e,this.Ta,f,this.Ua,h,k,l,m,q);a=NLc;this.D=new uW(b,a.Aca,a.Bca);this.va(this.D);this.F=this.J=null;this.jb=jj(new ij,10).build();this.Ga=!1}y(BY,bY);
var NLc={Aca:"waffle-assistant-answers-styled-border",Bca:"waffle-assistant-answers-styled-rect",M_a:"waffle-assistant-answers-input-box",J1a:"waffle-assistant-answers-query-box",Uwc:"waffle-assistant-answers-query-box-focused",b0a:"waffle-assistant-answers-learn-more",mrc:"waffle-assistant-answers-logging-message-container",e1a:"waffle-assistant-answers-logging-opt-out"};p=BY.prototype;p.xa=function(){BY.ma.xa.call(this);var a=P(ILc);this.oa().appendChild(VIc(this),a)};
p.Ia=function(){BY.ma.Ia.call(this);var a=NLc,b=this.La(a.J1a),c=this.La(a.M_a);this.Aa.Va(this.La(a.e1a));this.qa.Va(this.La(a.b0a));this.getHandler().R(b,"focus",this.WAb,!0).R(b,"blur",this.UAb,!0).R(b,"mouseover",this.YAb).R(b,"mouseout",this.XAb).R(b,"click",this.VAb).R(c,"input",this.j2b).R(this.Aa,"action",this.$yb).R(this.qa,"action",this.Mvb).R(aI(this.kb),"rb",Xuc(this.k2b,25,this));this.setVisible(null!=this.J);OLc(this,T0a&&W0a&&RA("showAnswersLoggingOptOut"))};p.ITa=He;p.XLa=Ie;
p.qqa=He;p.getTitle=n("Answers");p.G1=n(1);p.RV=function(a){return 3==a||0==a||1==a};p.pN=function(a,b){vb(a,function(a,b){return W(b,2)-W(a,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=$v(a[f],1);3==h?e=a[f]:0==h?c.push(W(a[f],8)):1==h&&d.push(a[f])}if(e&&W(e,2)){f=b||null;h=Uv(e,11)?W(e,11):null;var k=null==h?null:zU(W(e,10));0<Vv(e,4)?PLc(this,zU(AU(e)),W(e,9),k,h,c,d):PLc(this,f,W(e,9),k,h,c,d);this.F||(BY.ma.pN.call(this,a,b),this.getHandler().R(this.F,"sqc",this.QEb))}else this.gU(!0)};
p.bP=function(a){if(!this.F){var b=$Kc(this.O,3);this.F=new rY(a,this.Ua,b,wKc,void 0,this.oa())}return this.F};p.hBa=g("H");p.Dla=function(){return this.isVisible()};
p.gU=function(a,b,c){this.O.reset();(a||b)&&this.F&&(BY.ma.gU.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(BY.ma.gU.call(this,a,b,c),this.F.dispose(),this.F=null),this.Wb()&&(this.O.reset(),this.J=null,a=this.H,a.Wb()&&(b=a.Ga,b.F=[],b.C.clear(),a.V&&(b=a.V,b.O.Wb()&&(PHc(b.D),b.F.isDisposed()||b.F.setVisible(!1),b.J=!1)),a.cW(),a.jb.reset(),a.F=null,a.rH(!0)),this.setVisible(!1),this.Qb()&&wW(this.D));c&&this.H.reset()};p.zWa=function(a,b){b||RIc(this.H,a)};
p.Jf=function(a){this.Ja=a;this.H.Jf(a);this.O.Jf(a)};p.I1=function(a){BY.ma.I1.call(this,a);a?vW(this.D,this.J):wW(this.D)};function QLc(a,b){a.Qb()&&(b?wW(a.D):vW(a.D,a.J))}function OLc(a,b){L(a.La("waffle-assistant-answers-logging-message-container"),b)}function RLc(a,b){a=a.La("waffle-assistant-answers-query-box");eh(a,"waffle-assistant-answers-query-box-focused",b)}p.k2b=function(){this.Qb()&&vW(this.D,this.J)};p.WAb=function(){RLc(this,!0);vW(this.D,this.J)};
p.UAb=function(){RLc(this,!1);this.Qb()||wW(this.D)};p.YAb=function(){vW(this.D,this.J)};p.XAb=function(){this.Qb()||wW(this.D)};p.VAb=function(){SLc(this,"")};p.j2b=function(){var a=this.La("waffle-assistant-answers-input-box");SLc(this,a.value);a.value=""};p.QEb=function(a){var b=this,c=a.F;SLc(this,c);var d=DJc(1,a.C,a.J,1),e=new zi(function(){oLc(b.H,c,d,a.V)},300);this.va(e);e.start();this.V.Xb(2652,this.jb)};function SLc(a,b,c){a.I1(!0);a.dispatchEvent("Nd");TLc(a,b,c)}
function TLc(a,b,c){c=void 0===c?!1:c;var d=new zi(function(){UHc(a.H.V,b,!0);var d=a.H,f=c||!1;d.Hd=f;d.Mc.$=f;d.jb.$=f},300);a.va(d);d.start()}function PLc(a,b,c,d,e,f,h){c=c||new pG;a.J=b;a.O.Ie(c,b,d,e,f,h);a.O.A9();a.setVisible(null!=b);mLc(a.H,b,c,d,e,a.Ga,f);a.Ga=!1;a.Qb()&&vW(a.D,a.J)}p.$yb=function(a){a.stopPropagation();a.preventDefault();this.Ja&&(ts(Ot(Cq(this.Ja.Ke("/answers/logoptout"),v(this.twb,this)),v(this.rwb,this)),"POST").ue(),this.V.Xb(2663,this.jb))};
p.Mvb=function(a){a.stopPropagation();a.preventDefault();co("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.twb=function(a){a.bl()&&OLc(this,!1)};p.rwb=ba();function ULc(a,b,c){b=c||b;a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+Q(lr({content:bq("INSERT CHART"),style:4,Ed:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b))+Q(lr({Ed:"waffle-autovis-lightbox-close",content:gq(""+Q(hs({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:bq("Close")},b))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">'+
Q(lr({content:gq("&#10094;"),style:4,Ed:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:hq('aria-label="'+jq("Previous chart")+'"')},b))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+Q(lr({content:gq("&#10095;"),style:4,Ed:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:hq('aria-label="'+jq("Next chart")+'"')},b))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
Q(a.SMb)+"</div></div></div>");return R(a)}function VLc(){return R('<div class="waffle-autovis-lightbox-chart"></div>')};function WLc(a,b,c,d,e){N.call(this,e);this.F=a;this.D=b;this.$=c;this.V=d;this.H=[];this.C=new mr("",this.oa());this.Ha(this.C);this.O=new mr("",this.oa());this.Ha(this.O);this.L=new mr("",this.oa());this.Ha(this.L);this.J=new mr("",this.oa());this.Ha(this.J)}y(WLc,N);p=WLc.prototype;p.xa=function(){WLc.ma.xa.call(this);this.Da=P(ULc,{SMb:this.F.length})};
p.Ia=function(){WLc.ma.Ia.call(this);var a=EB.isEnabled();XLc(this,!a);a=this.La("waffle-autovis-lightbox-close");this.C.Va(a);a=this.La("waffle-autovis-lightbox-insert");this.O.Va(a);var b=this.La("waffle-autovis-lightbox-previous");this.L.Va(b);b=this.La("waffle-autovis-lightbox-next");this.J.Va(b);YLc(this);ZLc(this,this.D,!1);this.getHandler().R(document.body,Xe,this.yYb).R(this.Da,"keydown",this.AYb).R(Ud(),"resize",this.DYb).R(this.C,"action",this.close).R(this.O,"action",this.zYb).R(this.L,
"action",this.CYb).R(this.J,"action",this.BYb);b=new eN(this.Da,this.oa());fN(b);this.va(b);a.focus()};function YLc(a){var b=a.La("waffle-autovis-lightbox-content"),c=a.La("waffle-autovis-lightbox-content-inner");a=a.La("waffle-autovis-lightbox-page-count");var d=Sd();a=Hh(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Eh(c,d,e);Eh(b,d,e+a.height+35)}function XLc(a,b){eh(a.Da,"waffle-autovis-lightbox-readonly",b)}
function ZLc(a,b,c){c&&iB("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?$Lc(a,b):a.F[b]&&BIc(a.F[b],v(a.hob,a,b),!0)}p.hob=function(a,b){if(!this.isDisposed()&&b){var c=this.La("waffle-autovis-lightbox-container"),d=P(VLc);c.appendChild(d);this.H[a]=d;iW(b,d,this.$,this.V,LA);$Lc(this,a)}};function $Lc(a,b){L(a.H[a.D],!1);L(a.H[b],!0);a.L.Pa(0!=b);a.J.Pa(b!=a.F.length-1);var c=a.La("waffle-autovis-lightbox-page-number");qe(c,b+1);a.D=b}p.yYb=function(a){!oe(this.Da,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
p.AYb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&ZLc(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||aMc(this);a.stopPropagation()};p.DYb=function(){var a=this.La("waffle-autovis-lightbox-container");de(a);this.H=[];YLc(this);ZLc(this,this.D,!0)};p.zYb=function(){this.close();EIc(this.F[this.D],2256)};p.CYb=function(){0!=this.D&&ZLc(this,this.D-1,!0);0==this.D&&this.J.Da.focus()};p.BYb=function(){aMc(this);this.D==this.F.length-1&&this.L.Da.focus()};
function aMc(a){a.D!=a.F.length-1&&ZLc(a,a.D+1,!0)}p.close=function(){this.dispose()};p.hd=function(){WLc.ma.hd.call(this);var a=this.F[this.D];a&&a.Da&&a.Da.focus()};function bMc(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+T(a.title)+'">'+Q(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+jq("Press enter to insert formula")+'"></span></div>');return R(a)};function CY(a,b){N.call(this);this.C=a;this.D=b}y(CY,N);p=CY.prototype;p.xa=function(){this.Da=P(bMc,{name:this.C,title:this.D})};p.Ia=function(){CY.ma.Ia.call(this);var a=this.La("waffle-assistant-quicksum-entry-name");TX(a);this.getHandler().R(this.Da,"keypress",this.P1b);L(this.Da,!1)};p.getFunctionName=g("C");p.Qa=function(a){qe(this.La("waffle-assistant-quicksum-entry-value"),a||"");L(this.Da,!!a)};p.isVisible=function(){return Kh(this.Da)};
p.P1b=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new E("insert",this)))};function cMc(a,b,c,d,e){N.call(this,e);this.Ja=a;this.Aa=b;this.O=c;this.J=d;this.D=a.C;this.Ga=new dw;this.$=jj(new ij,17).build();this.V=jj(new ij,2).build();this.L=!1;this.F=[];this.C=null;this.H=[]}y(cMc,N);
cMc.prototype.Ia=function(){cMc.ma.Ia.call(this);this.jh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.jh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.jh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.jh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.jh(new CY(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new eKc(this.Da,
this.Aa,this.D,this.O);this.C.H=this.L;this.va(this.C);this.getHandler().R(this,"insert",this.ea).R(this.C,"formula_inserted",this.qa)};
function dMc(a){function b(a){return l?ritz_api.RitzModelApi.renderNumberAsFormattedString(a,m):null}if(JG(a.D)){var c=zK(a.D),d=c.Dj(),e=yK(a.D);if($a(d,c.vt,c)){c=[];a.F=[];for(var f=0;f<d.length;f++){var h=d[f],k=nA(e+"",h.yc(),h.rc(),h.Uc(),h.Wc());c.push(a.Ga.serialize(k));a.F.push(h)}if(d=ritz_api.RitzModelApi.quickSum(c)){L(a.Da,!0);e=d.count;c=d.countNumberFormat;var l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.kd(0).Qa(b(d.sum));a.kd(1).Qa(b(d.average));a.kd(2).Qa(b(d.min));a.kd(3).Qa(b(d.max));
1<e?a.kd(4).Qa(ritz_api.RitzModelApi.renderNumberAsFormattedString(e,c)):L(a.Da,!1);if(a.C){a.C.L=[];a.H=[];for(d=0;d<a.cd();++d)e=a.kd(d),a.H.push(eMc(a,e.getFunctionName()));a.C.L=a.H}}else L(a.Da,!1)}else L(a.Da,!1)}else L(a.Da,!1)}cMc.prototype.ea=function(a){var b=a.target;a=this.F[0];a=new Dd(a.left,a.Uc());b=b.getFunctionName();b=eMc(this,b);a=new vO(zK(this.D),a,b);this.O.C(a);this.J.Xb(2624,this.V)};cMc.prototype.qa=function(){this.J.Xb(2624,this.$)};
function eMc(a,b){var c=a.Ja.L.D;a=Wa(a.F,function(a){return RF(a)});return"="+b+"("+a.join(c)+")"};function fMc(a,b,c){F.call(this);this.C=tbb(xG.getInstance(),a,b,c);this.D=tl()}y(fMc,F);fMc.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!ab(c,function(a){return MZa(a,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].kh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&juc(this.C),this.D=gMc(),this.D.addCallback(function(){return uuc(d.C,b,!0)}))};fMc.prototype.Jf=function(a){this.C.Jf(a)};
function gMc(){var a=null,b=new il(function(){null===a||xi(a)});a=wi(function(){b.Mb()});return b};function DY(a,b,c,d,e,f,h){tW.call(this,h);this.We=a;this.zd=b.C;this.Na=c;this.gf=d;this.H=f;this.Af=e;this.Ua=new cMc(b,c,d,f,this.oa());this.Ha(this.Ua);this.V=new qW(!1,"#4285f4");this.Ha(this.V);this.O=null;this.vd=this.Zc=!1;this.Db=!0;this.Bb=Al();this.wb=this.kb="";this.Ac=null;this.Oa=jj(new ij,10).build()}y(DY,tW);p=DY.prototype;p.xa=function(){DY.ma.xa.call(this);this.Da=P(hMc,{RM:HA})};
p.Ia=function(){DY.ma.Ia.call(this);var a=this.La("waffle-assistant-quicksum-panel");this.Ua.Va(a);a=this.La("waffle-assistant-spinner-container");this.V.render(a);a=this.We.C;this.getHandler().R(this,"close-sidebar",this.pla).R(a,"recommender-load-started",this.ela).R(a,"recommender-load-ended",this.dla).R(a,"recommender-calc-started",this.Dka).R(a,"recommender-calc-ended",this.Cka).R(this.La("waffle-assistant-scroll-pane"),"scroll",Xuc(this.Cba,10,this));a=EB.isEnabled();this.Bba(!a)};
p.resize=function(){var a=this.La("waffle-assistant-sidepane-content");a=Hh(a).height;var b=this.La("waffle-assistant-spinner-container");ph(b,"margin-top",a/2-16+"px");this.Cba()};p.Jf=ua;function iMc(a,b){var c=jMc(a);0!=c.length&&(D(a.O),c=c.filter(function(a){return a instanceof ZX}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new WLc(c,b,a.Af,a.H,a.oa()),a.O.render(),a.va(a.O),XLc(a.O,a.vd)))}
p.Bba=function(a){this.vd=a;eh(this.Da,"waffle-assistant-readonly",a);var b=this.Ua;b.L=a;b.C&&(b.C.H=a);eh(b.Da,"waffle-assistant-quicksum-panel-readonly",a);this.O&&!this.O.isDisposed()&&XLc(this.O,a)};
p.setVisible=function(a){var b=this.isVisible();DY.ma.setVisible.call(this,a);if(a&&!b){var c=tuc(this.We.C,a);c?(b=new qHc,H(b,1,gA(c,"r")),H(b,2,gA(c,"c")),H(b,3,c.kh()),c=new ej,Zf(c,4,b),b=mj(nj(this.Oa),c).build()):b=this.Oa;this.wb=Bl(this.Bb,uA.Eua,!1,b);rW(this.V,!0);kMc(this)}a||lMc(this,!0)};p.ela=function(){this.isVisible()&&(lMc(this,!0),rW(this.V,!0),kMc(this))};p.dla=function(){this.isVisible()&&(rW(this.V,!1),kMc(this))};
p.Dka=function(a){this.isVisible()&&(this.H.C(2775,this.Oa),lMc(this,void 0,a.C,a.F),mMc(this)||rW(this.V,!0),kMc(this),this.Db=!1)};
p.Cka=function(a){if(this.isVisible()){this.H.C(2776,this.Oa);var b=a.C;0<b.length&&(this.kb=Bl(this.Bb,uA.Cua));lMc(this,!1);rW(this.V,!1);a=a.F;for(var c=ja(this.D),d=c.next();!d.done;d=c.next()){d=d.value;for(var e=[],f=ja(b),h=f.next();!h.done;h=f.next()){h=h.value;var k=$v(h,1);d.RV(k)&&e.push(h)}0<e.length?d.pN(e,a):d.gU(!0)}if(QA)for(b=ja(b),a=b.next();!a.done;a=b.next())if(a=a.value,5==$v(a,1)){this.y3();this.Aa=W(a,12);this.ea=AU(a);this.Ga=W(a,11);nMc(this);a=this.ea;c=!1;for(d=this.Ra.length-
1;0<=d;d--)qvc(this.Ra[d],a)&&(c=!0,this.Ra.splice(d,1));this.Ra.push(a);a=c;2!=this.Aa||a||oMc(this,!0)}b=jMc(this);0<b.length&&this.Zc&&(b[b.length-1].Mc=!0);this.Zc=!1;kMc(this);pMc(this);this.Cba()}};function kMc(a){var b=mMc(a),c=Kh(a.La("waffle-assistant-quicksum-panel")),d=a.V.Qb();b=b||c||d;a=a.La("waffle-assistant-empty-list");L(a,!b)}p.Jc=ua;p.vpa=ua;p.Gd=g("vd");p.pla=ua;
p.JKb=function(){""!=this.kb&&(Cl(this.Bb,this.kb),this.kb="");""!=this.wb&&(Cl(this.Bb,this.wb),this.wb="");this.Ac=Ha();this.Db||(this.H.Xb(2777,this.Oa),this.Db=!0)};function hMc(a,b,c){b=c||b;a=a||{};c=R;var d=gq('<div class="waffle-assistant-replaceable-title">'+qMc(null,b)+"</div>");var e=e=a||{};var f=""+('<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+Q(x3b({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');f=e.RM?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=R(f+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');e=R(""+('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(""+Q(zW($p({title:d,Tk:gq(""+e),id:bq("autovis"),sH:bq("waffle-assistant-sidepanel"),Paa:bq("waffle-assistant-title"),lW:bq("waffle-assistant-sidepane-content")},a),b))+"")}
function qMc(){return R('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+Q(x3b({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+Q("Explore")+"</div></div>")};function rMc(a,b,c){a=R;b=""+Q(lr({Ed:"waffle-assistant-datavalidation-apply-button",content:bq("Apply"),style:4},c||b));b=R(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function sMc(a){return R('<div class="waffle-assistant-datavalidation-detail-chip">'+Q(a.c8a)+"</div>")};function tMc(a,b,c,d){WX.call(this,a,d);this.D=new uW(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.va(this.D);this.C=new mr("",this.oa());this.Ha(this.C);this.H=AU(a);this.J=c}r(tMc,WX);p=tMc.prototype;p.xa=function(){WX.prototype.xa.call(this);XX(this).appendChild(P(rMc))};
p.Ia=function(){WX.prototype.Ia.call(this);var a=this.La("waffle-assistant-datavalidation-apply-button");this.C.Va(a);TX(a,"Apply data validation");this.getHandler().R(this.C,"action",this.nmb).R(this.Da,"mouseenter",this.mLb).R(this.Da,"mouseleave",this.nLb);a=new hg;var b=Jw(W(W(this.F,13),3));Xtc(a,sBc(b));b=new fg;Zf(b,58,a);a=kj(jj(new ij,10),b).build();this.J.C(35577,a)};
p.DA=function(a){var b=RF(sA(this.H)),c=W(W(this.F,13),3);switch(Jw(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=Kw(c).map(function(a){return W(W(a,5).Ma(),2)});break;case 1:d="Numeric validation";c=["Greater than "+W(W(Kw(c)[0],5).Ma(),3)];break;case 7:d="Numeric validation";c=Kw(c);c=["Between "+(W(W(c[0],5).Ma(),3)+(" and "+W(W(c[1],5).Ma(),3)))];
break;default:d="unrecognized",c=[]}var e=new Zn,f=e.text(d)+(" for "+(e.le("SPAN".toString(),{tE:"waffle-assistant-datavalidation-range"})+e.text(b)+e.re("SPAN".toString())));rd(this.La("waffle-assistant-datavalidation-description"),e.format(f));var h=this.La("waffle-assistant-datavalidation-details");A(c,function(a){a=P(sMc,{c8a:a});h.appendChild(a)});b="Suggested data validation: "+(d+(" "+(c.join()+(" for "+b))));ei(this.Da,b);a()};p.tA=ba();p.jz=n("assistantDataValidationFeedback");p.WB=n(35551);
p.VB=n(35550);p.nmb=function(){this.dispatchEvent(new UX("Hd",this,35549))};p.mLb=function(){vW(this.D,zU(this.H))};p.nLb=function(){wW(this.D)};function EY(a,b,c,d){ms.call(this,a,b,c,d,void 0,void 0,!0)}y(EY,ms);EY.prototype.xa=function(){EY.ma.xa.call(this);ah(this.Da,"waffle-assistant-toast");ah(this.La("docs-ui-toast-content"),"waffle-assistant-toast-content")};EY.prototype.hB=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=Uh(this,b);EY.ma.hB.call(this,a,b,c)};EY.prototype.Gg=function(a,b,c,d){this.hB(a,b,d);a=Wh(this,b);this.getHandler().Pg(a,ff,v(function(){this.setVisible(!1);c()},this))};function uMc(){this.C=null}y(uMc,B);uMc.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function rKc(a,b,c,d){a.clear();a.C=new EY(b,c,!1,5E3);a.C.render();d&&a.C.Gg("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}uMc.prototype.Fa=function(){uMc.ma.Fa.call(this);this.clear()};function vMc(a,b,c,d){bY.call(this,1,b,a,d);this.D=c}r(vMc,bY);p=vMc.prototype;p.getTitle=n("Data Validation");p.RV=function(a){return 6==a};p.bP=function(a){var b=W(a,1);switch(b){case 6:return new tMc(a,this.D,this.V,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};p.qN=function(a){bY.prototype.qN.call(this,a);this.setVisible(!a)};p.J1=function(a){return this.Gd()?(this.setVisible(!1),a):bY.prototype.J1.call(this,a)};p.G1=n(4);function wMc(a,b,c){a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+xMc(c||b)+"</div>");return R(a)}
function yMc(a,b,c){return R('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+xMc(c||b)+"</div>")}function xMc(a){a=""+Q(lr({Ed:"waffle-assistant-formatting-edit-button",content:bq("Edit"),style:4},a));return R(a)};function zMc(a,b,c){WX.call(this,a,c);a=Wa(Zv(this.F,7),uBc);this.C=new FBc(!1,a,7);this.Ha(this.C);this.J=new mr("",this.oa());this.Ha(this.J);this.L=b;this.H=!1;this.D=-1}y(zMc,WX);var AMc={XXa:"waffle-assistant-banding-color-picker-container",qca:"waffle-assistant-formatting-edit-button",mI:"waffle-assistant-banding-range"};p=zMc.prototype;p.xa=function(){zMc.ma.xa.call(this);XX(this).appendChild(P(wMc))};
p.Ia=function(){zMc.ma.Ia.call(this);this.getHandler().R(this.J,"action",this.Nrb).R(this.C,"vd",this.Umb);this.L.C(2768)};p.DA=function(a){var b=this.La(AMc.XXa);this.C.render(b);GBc(this.C);b=this.La(AMc.mI);var c=AU(this.F);var d=sA(c);qe(b,RF(d));BMc(this,c);b=this.La(AMc.qca);this.J.Va(b);a()};p.tA=function(){ei(this.Da,"Suggested alternating background colors");Qj(this.C,"Choose a color scheme")};p.jz=n("assistantBandingFeedback");p.WB=n(2672);p.VB=n(2671);
p.Nrb=function(a){dB.dispatchEvent({type:"show-banding-pane-recommendation",DRa:this.F,J7a:IBc(this.C)});a.stopPropagation()};p.Umb=function(a){if(!this.H&&HBc(this.C)){var b=this.D;this.D=this.C.Wg();this.D==b?this.dispatchEvent(new UX("Md",this,2797)):this.dispatchEvent(new UX("Fd",this,2673));a.stopPropagation()}};
function BMc(a,b){a.H=!0;var c=b.yb();b=sA(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.yc(),b.rc(),b.Uc(),b.Wc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new dw).xd(kx.Ca(),c),c=uBc(c)):c=null;c?(c=JBc(a.C,c),OL(a.C,c?c.getElement():null)):OL(a.C,null);a.D=a.C.Wg();a.H=!1};function CMc(a,b){WX.call(this,a,b);this.C=new mr("",this.oa());this.Ha(this.C);this.Ac=Zv(a,6)}y(CMc,WX);var FY={qca:"waffle-assistant-formatting-edit-button",e_a:"waffle-assistant-conditionalformat-format-preview",j2a:"waffle-assistant-conditionalformat-rule-holder",FN:"waffle-assistant-conditionalformat-description",b1a:"one-rule",J3a:"two-rules",w3a:"three-rules",F1a:"waffle-assistant-conditionalformat-format-preview-label"};p=CMc.prototype;p.xa=function(){CMc.ma.xa.call(this);XX(this).appendChild(P(yMc))};
p.Ia=function(){CMc.ma.Ia.call(this);var a=this.La(FY.qca);this.C.Va(a);TX(a,"Apply and edit conditional format rules");this.getHandler().R(this.C,"action",this.lmb)};p.DA=function(a){qe(this.La(FY.FN),$v(this.F,3));var b=this.La(FY.j2a),c=new DMc(this,this.oa());this.Ha(c);c.Va(b);TX(b,"Apply conditional format rules");a()};p.tA=ua;p.jz=n("assistantConditionalFormatFeedback");p.WB=n(2630);p.VB=n(2629);
p.lmb=function(){this.dispatchEvent(new UX("Gd",this,2563));this.dispatchEvent(new UX("Jd",this,2670,void 0,void 0,sA(W(this.Ac[0],1,0))));n2a()};function DMc(a,b){Oj.call(this,void 0,void 0,b);this.C=a}y(DMc,Oj);
DMc.prototype.Ad=function(a){DMc.ma.Ad.call(this,a);var b=this.C.Ac;switch(b.length){case 0:break;case 1:var c=FY.b1a;break;case 2:case 4:c=FY.J3a;break;default:c=FY.w3a}for(var d=0;d<b.length;d++){var e=b[d],f=Vd("DIV");bh(f,[FY.e_a,c]);var h=Vd("DIV");ah(h,FY.F1a);f.appendChild(h);qe(h,"123");if(Uv(e,2)){var k=W(W(e,2),1);switch(Jw(W(k,1))){case 9:case 13:k=Kw(W(k,1))[0];var l=Zv(e,1)[0];qe(h,HH(k,$v(l,1),$v(l,2),$v(l,4)))}}Tvc(e,f);a.appendChild(f)}};
DMc.prototype.Dh=function(){var a=this.C;a.dispatchEvent(new UX("Gd",a,2563));return!0};function EMc(a,b,c){bY.call(this,2,b,a,c)}y(EMc,bY);p=EMc.prototype;p.getTitle=n("Formatting");p.RV=function(a){return J(I(),"feecfr")&&2==a||4==a};p.bP=function(a){var b=W(a,1);switch(b){case 2:return new CMc(a,this.oa());case 4:return a=new zMc(a,this.V,this.oa()),this.getHandler().R(a,"Fd",this.qVb).R(a,"Md",this.LHb),a;default:throw Error("Unsupported recommendation type: "+b);}};p.qVb=function(a){rKc(this.Ta,"Alternating colors applied",this.oa(),v(this.Vmb,this,a.C))};p.LHb=function(){this.Ta.clear()};
p.Vmb=function(a){this.dispatchEvent(new UX("Rd",a,2796))};p.qN=function(a){EMc.ma.qN.call(this,a);this.setVisible(!a)};p.J1=function(a){return this.Gd()?(this.setVisible(!1),a):EMc.ma.J1.call(this,a)};p.G1=n(3);function FMc(a,b,c,d,e,f,h,k,l,m){WX.call(this,k,m);this.Na=b;this.Oa=c;this.ea=d;this.Ra=l;this.V=e;this.$=f;this.H=new kr("",new QX,this.oa());this.Ha(this.H);this.L=new kr("",new QX,this.oa());this.Ha(this.L);this.J=this.D=null;this.C=Vd("CANVAS","waffle-pivottable-pivot-canvas-border");this.Ja=this.Oa.L.C;this.O=jj(new ij,66).build()}r(FMc,WX);p=FMc.prototype;p.AA=n(!0);p.xa=function(){WX.prototype.xa.call(this);XX(this).appendChild(P(BHc));YX(this).appendChild(P(CHc))};
p.Ia=function(){WX.prototype.Ia.call(this);var a=W(this.F,5);var b=RAc(this.$,a),c=zK(this.Na).kc();this.J=new UAc(b,a,this.Ja,this.Ra,c,this.ea);a=this.La("waffle-assistant-insert-pivottable-button");this.H.Va(a);TX(a,"Insert Pivot Table");a=this.La("waffle-assistant-zoom-button");this.L.Va(a);TX(a,"Preview Pivot Table");this.getHandler().R(this.H,"action",this.oLb).R(this.L,"action",this.IOa);this.iy(this.Gd())};
p.DA=function(a){qe(this.La("waffle-assistant-answercard-interpret"),$v(this.F,3));this.C=Vd("CANVAS","waffle-pivottable-pivot-canvas-border");se(this.C,!0);this.La("waffle-assistant-answercard-pivot-content").appendChild(this.C);this.getHandler().Pg(this.C,ff,this.IOa);WAc(this.J,this.C);a()};p.iy=function(a){WX.prototype.iy.call(this,a);if(this.H&&this.Wb()){this.H.setVisible(!a);var b=this.oa().La("waffle-assistant-button-separator",YX(this));L(b,!a)}this.D&&xHc(this.D,this.Gd())};
p.tA=function(){ei(this.Da,"Suggested Pivot Table")};p.jz=n("assistantPivotTableFeedback");p.WB=n(2632);p.VB=n(2631);p.oLb=function(){VAc(this.J);this.dispatchEvent("close-sidebar");this.V.C(35619,this.O)};p.IOa=function(){this.V.C(35620,this.O);D(this.D);this.D=new YAc(this.J,this.L,$v(this.F,3),this.V,this.O,35621,this.oa());this.D.render();this.va(this.D);xHc(this.D,this.Gd())};function GMc(a,b,c,d,e,f,h,k){bY.call(this,1,f,e,k);this.O=d;this.D=b;this.qa=c;this.Aa=h;this.H=jj(new ij,10).build();a=new J4b(a,!0,!0);this.J=new QAc(a,this.D);this.F=null}r(GMc,bY);p=GMc.prototype;p.getTitle=n("Pivot Table");p.RV=function(a){return 1==a};p.bP=function(a){var b=W(a,1);switch(b){case 1:return new FMc(this.F,this.D,this.qa,this.O,this.V,this.J,this.H,a,this.Aa,this.oa());default:throw Error("Unsupported recommendation type: "+b);}};
p.pN=function(a,b){W(a[0],5)&&(this.F=b?b:null,bY.prototype.pN.call(this,a,b))};p.G1=n(5);function GY(a,b,c,d,e){N.call(this);this.O=a;this.Oa=b;this.ea=c;this.H=d;this.D=e}r(GY,N);GY.prototype.getTableRange=g("ea");GY.prototype.C9=function(a,b,c){this.ea=a;this.H=b;this.D=c};GY.prototype.Ia=function(){N.prototype.Ia.call(this);this.getHandler().R(this.O.C,"Ba",this.Ra)};GY.prototype.Ra=function(){this.Oa.wc()};function HMc(a,b){B.call(this);this.F=a;this.H=b;this.C=new uW(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.va(this.C);this.D=new uW(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.va(this.D)}r(HMc,B);HMc.prototype.Fa=function(){wW(this.C);wW(this.D);B.prototype.Fa.call(this)};
function IMc(a,b,c,d,e,f){bYb(b);var h=sA(d);h=new Tz(h.yc(),h.rc(),Math.min(h.Uc(),h.yc()+6),Math.min(h.Wc(),h.rc()+6));var k=iQ(b),l=IG(a.F).C,m=l.Xf(new Bu(h.yc(),h.Uc()),"r",!0,!1,!0,!0)-1,q=l.Xf(new Bu(h.rc(),h.Wc()),"c",!0,!1,!0,!0)-1;l.jc()&&--q;m=Math.min(200,m);q=Math.min(c.offsetWidth-2,q);jQ(b,k,q,m);c=xIc(d,e,f);a.H.render(b,h,c);b=a.C;h=d.yc();k=d.rc();switch(e){case 0:h=Math.min(d.Uc(),d.yc()+f);break;case 1:k=Math.min(d.Wc(),d.rc()+f)}d=nA(d.yb(),h,k,d.Uc(),d.Wc());vW(b,zU(d));vW(a.D,
zU(c))};function JMc(a){var b=a.TQa,c=a.SQa,d=a.sPa;a=a.aAa;return R('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+T(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+Q(b)+'</div></div><div class="waffle-tables-popup-content">'+Q(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+
Q(d)+'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+Q(a)+"</div></div></div></div>")}
function KMc(){var a=bq("Edit data range");var b=R('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper">Headers<div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+(""+JMc({TQa:a,SQa:gq(""+b),sPa:bq("Update"),aAa:bq("Cancel")})+"");return R(a)}function LMc(){var a=""+(""+JMc({TQa:bq("Improve suggestions"),SQa:gq('<div class="waffle-tables-popup-header-message"></div>'),sPa:bq("No"),aAa:bq("Yes")})+"");return R(a)}function MMc(a){a='For <span class="waffle-assistant-table-bar-range">'+(Q(a.wH)+"</span>");return R(""+(""+a+""))}
function NMc(a){a='Is <span class="waffle-assistant-table-first-header">'+(Q(a.ZK)+"</span> a header row, containing titles that describe the columns below?");return R(""+(""+a+""))};function OMc(a,b,c,d,e,f,h){GY.call(this,a,e7a,d,e,f);this.C=(new yk).build();this.va(this.C);this.J=new kr("",new QX,this.oa());this.Ha(this.J);Yi(this.C,this.J,f7a);this.F=new kr("",new QX,this.oa());this.Ha(this.F);Yi(this.C,this.F,e7a);this.V=new HMc(b,c);this.va(this.V);this.L=new Re(this);this.va(this.L);this.qa=h}r(OMc,GY);OMc.prototype.xa=function(){this.Da=P(LMc)};
OMc.prototype.Ia=function(){GY.prototype.Ia.call(this);this.J.Va(this.La("waffle-tables-popup-done"));this.F.Va(this.La("waffle-tables-popup-cancel"));var a=xIc(this.getTableRange(),this.D,1);a=RF(sA(a));a=P(NMc,{ZK:a});this.La("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(f7a,"action",this.Aa).subscribe(e7a,"action",this.$);a=this.La("waffle-assistant-table-canvas");var b=this.La("waffle-assistant-canvas-container");IMc(this.V,a,b,this.getTableRange(),this.D,this.H);a=this.La("waffle-tables-popup");
eh(a,"waffle-tables-popup-answers-enabled",this.qa);b=new eN(a,this.oa());this.va(b);fN(b);a.focus()};OMc.prototype.$=function(){this.dispatchEvent("Pd")};OMc.prototype.Aa=function(){var a=sA(this.getTableRange());switch(this.D){case 0:a=AZa(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=AZa(a.top,a.left+1,a.top+a.height,a.left+a.width)}a=RF(a);this.dispatchEvent(new ZHc(a,this.H-1,this.D));this.dispatchEvent("Pd")};function PMc(a,b,c,d,e,f,h,k,l){GY.call(this,a,a7a,d,e,f);var m=this;this.Ta=b;this.Na=d;this.kb=e;this.wb=f;a=sA(d);this.F=RF(a);this.Ja=new HMc(b,c);this.va(this.Ja);this.C=null;this.qa=h;this.J=(new yk).build();this.va(this.J);this.$=new kr("",new QX,this.oa());this.Ha(this.$);Yi(this.J,this.$,c7a);this.V=new kr("",new QX,this.oa());this.Ha(this.V);Yi(this.J,this.V,a7a);b=this.O.C.C.pe();this.L=new jW(this.Ta,function(a,b,c){QMc(m,a,b,c)},!1,"e.g., A2:D5",!0,b,this.oa());this.Ha(this.L);this.Aa=
null;this.Ga=new Re(this);this.va(this.Ga);this.Ua=k;this.jb=l}r(PMc,GY);p=PMc.prototype;p.xa=function(){this.Da=P(KMc)};
p.Ia=function(){GY.prototype.Ia.call(this);this.$.Va(this.La("waffle-tables-popup-done"));this.V.Va(this.La("waffle-tables-popup-cancel"));this.L.render(this.La("waffle-assistant-tables-data-range-wrapper"));var a=this.La("waffle-range-selection-input");Zh(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().R(a,"keydown",this.tLb).R(a,"keyup",this.uLb).R(a,fea,this.pFb).R(this.L,"change",this.vLb);this.Ga.subscribe(c7a,"action",this.wLb).subscribe(a7a,"action",this.rnb);RMc(this);
a=this.La("waffle-tables-popup");eh(a,"waffle-tables-popup-answers-enabled",this.jb);var b=new eN(a,this.oa());this.va(b);fN(b);a.focus()};p.Fa=function(){D(this.Aa);GY.prototype.Fa.call(this)};function QMc(a,b,c,d){BU(a.Ua,null,b,c,d,!1,void 0,function(b){a.Aa=b})}function SMc(a){var b=a.La("waffle-assistant-table-canvas"),c=a.La("waffle-assistant-canvas-container");IMc(a.Ja,b,c,a.getTableRange(),a.D,a.H)}p.rnb=function(){this.dispatchEvent("Pd")};
p.wLb=function(){var a=!v$a.test(this.F);L(this.xb("waffle-assistant-tables-range-error"),a);eh(this.La("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.kb!=this.H||this.wb!=this.D;var b=!tvc(this.Na,this.getTableRange());if(a||b)a&&this.qa.Xb(35506),b&&this.qa.Xb(35507),this.dispatchEvent(new ZHc(this.F,this.H,this.D));this.dispatchEvent("Pd")}};
function RMc(a){var b=a.La("waffle-range-selection-input"),c=sA(a.Na);a.F=RF(c);b.value=a.F;TMc(a);SMc(a)}p.C9=function(a,b,c){GY.prototype.C9.call(this,a,b,c);SMc(this)};function UMc(a){var b=zK(a.O.C),c=b.kc();b=z$a(a.F,b);null!=b&&(c=qA(b,c),a.C9(c,VMc(a,c),a.D),TMc(a))}function VMc(a,b){b=WMc(b,a.D);return a.H>b?b:a.H}function WMc(a,b){a=0==b?a.Uc()-$v(a,2):a.Wc()-$v(a,4);return Math.min(a-1,3)}
function TMc(a){D(a.C);a.C=new ON;a.Ha(a.C);Yi(a.J,a.C,b7a);xU(a.C,CW.getInstance());a.C.render(a.La("waffle-assistant-tables-edit-headers-button"));a.getHandler().R(a.C,"action",a.bub);for(var b=WMc(a.getTableRange(),0),c=0;c<=b;c++){var d=(new lt("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.C.Pd(new hk(d))}c=WMc(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new lt("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.C.Pd(new hk(e))}c=a.H;a.C.tf(0==a.D?c:c+b+1);Zh(a.C.Da,"label","Headers")}p.pFb=function(){var a=this.La("waffle-range-selection-input");this.F!=a.value&&(this.F=a.value,UMc(this))};p.vLb=function(){var a=this.L.Ma();this.F=a;var b=this.La("waffle-range-selection-input");b.value=a;b.select();UMc(this)};
p.tLb=function(a){var b=this.La("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.F=b.value;UMc(this);c7a.wc();break;case 27:a.stopPropagation(),a.preventDefault(),RMc(this),a7a.wc()}};p.uLb=function(){this.F=this.La("waffle-range-selection-input").value;UMc(this)};p.bub=function(){var a=this.C.Wg(),b=WMc(this.getTableRange(),0);this.C9(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};function HY(a,b,c,d,e,f,h,k,l,m,q,t){DY.call(this,a,b,c,e,d,f,t);this.Pe=q;this.we=h;this.Ja=b;this.Ta=new N(this.oa());this.Ha(this.Ta);this.qa=new uMc;this.va(this.qa);this.D=[];this.F=null;this.Ab=new mr("",t,4);Ti(this.Ab,2,!1);this.Ha(this.Ab);this.He=k;this.ah=l;this.Xd=m;this.ea=null;this.Aa=0;this.Ga=null;this.$b=new kr("",new QX,this.oa());this.Ha(this.$b);this.Mc=new N(this.oa());this.Ha(this.Mc);this.Hd=(new yk).build();this.va(this.Hd);Yi(this.Hd,this.$b,d7a);this.$=this.J=null;this.Ra=
[]}y(HY,DY);var IY={YD:"waffle-assistant-scroll-pane-feature-content",Ncc:"waffle-assistant-empty-list",TZa:"waffle-assistant-features",a0a:"waffle-assistant-empty-list-learn-more",dda:"waffle-assistant-expanded-panel",Iwa:"waffle-assistant-replaceable-title",o2a:"waffle-assistant-scroll-pane",p3a:"waffle-assistant-sidepane-tables-range",q3a:"waffle-sidebar-tables-bar",eya:"waffle-assistant-tables-scroll-pane",r3a:"waffle-assistant-tables-edit-range-button",yw:"waffle-assistant-title"},XMc={defaultHelpArticleId:"6280499"};
p=HY.prototype;
p.Ia=function(){var a=this;HY.ma.Ia.call(this);this.Ta.Va(this.La(IY.dda));TX(this.C.Da,"Close");QA&&(this.Mc.Va(this.La(IY.p3a)),nMc(this),this.$b.Va(this.La(IY.r3a)));var b=this.Ja.L.F;HA&&(k1a||"en"==wG(b))&&(b=new BY(this.we,this.Na,this.zd,this.gf,this.H,this.qa,this.Ja,this.ah,this.Xd,this.Pe,this.oa()),this.Ha(b),this.D.push(b));b=new EMc(this.H,this.qa,this.oa());this.Ha(b);this.D.push(b);J(I(),"feedvs")&&(b=new vMc(this.H,this.qa,this.Na,this.oa()),this.Ha(b),this.D.push(b));q1a&&(b=new GMc(this.we,
this.zd,this.Ja,this.gf,this.H,this.qa,this.Pe,this.oa()),this.Ha(b),this.D.push(b));b=new cY(this.zd,this.Na,this.Af,this.H,this.qa,this.oa());this.Ha(b);this.D.push(b);var c=this.La(IY.TZa);A(this.D,function(b){b.render(c);a.Ta.Ha(b.C,!0)});this.Ab.Va(this.La(IY.a0a));this.getHandler().R(this.Ab,"action",this.u2b).R(this,"Pd",this.y3).R(this,"Od",this.v2b);YMc(this)};p.v2b=function(){var a=ZMc(this);a&&(a.Ga=!0)};p.u2b=function(){K.ao.wc(XMc)};function pMc(a){A(a.D,function(a){XIc(a)})}
function lMc(a,b,c,d){A(a.D,function(a){a.gU(b,c,d)})}function mMc(a){return!!ab(a.D,function(a){return a.Dla()})}p.Cba=function(){var a=this,b=this.La("waffle-assistant-scroll-pane").scrollTop+Hh(this.La("waffle-assistant-sidepane-content")).height;A(this.D,function(c){a.F&&a.F!=c||(c instanceof cY&&a.getHandler().Vc(c,"Kd",a.JKb),b=c.J1(b))})};function jMc(a){if(a.F)return a.F.C.C;var b=[];A(a.D,function(a){ob(b,WIc(a))});return b}p.Bba=function(a){HY.ma.Bba.call(this,a);YMc(this)};
p.Jf=function(a){A(this.D,function(b){b.Jf(a)})};p.vpa=function(){var a=this.La(IY.Iwa),b=this.La(IY.yw);Gh(b,Hh(a).height)};
p.Jc=function(){var a=this,b=this.La(IY.YD),c=this.La(IY.Iwa),d=this.Ta.Da;if(this.F)this.F.C.setVisible(!1),this.F.I1(!1),this.F=null,L(d,!1),L(b,!0),Rp(c,qMc),bi(c,"label"),this.resize(),iB("Explore Opened");else if(this.F=ab(this.D,function(a){return a.Qb()}))L(b,!1),L(d,!0),this.F.C.setVisible(!0),YIc(this.F,c),ei(c,this.F.getTitle()),b=this.F.getTitle()+" section expanded.",iB(b);this.vpa();b=new zi(function(){var b=ut;b&&b.dispatchEvent("resize");a.Cba()},300);this.va(b);b.start()};
p.setVisible=function(a){var b=this.isVisible();HY.ma.setVisible.call(this,a);a&&!b&&$Mc(this,!0);a||this.qa.clear()};p.pla=function(){HY.ma.pla.call(this);this.F&&this.Jc();this.y3()};p.ela=function(){HY.ma.ela.call(this);$Mc(this,!0)};p.dla=function(){HY.ma.dla.call(this);$Mc(this,!1)};p.Dka=function(a){HY.ma.Dka.call(this,a);$Mc(this,!0,a.C)};p.Cka=function(a){HY.ma.Cka.call(this,a);$Mc(this,!1)};
function aNc(a,b){if(QA){var c=ZMc(a);b?(ugc(a.J),a.J=new PMc(a.Ja,a.Na,a.He,a.ea,a.Aa,a.Ga,a.H,a.Xd,null!=c&&c.Qb()),a.Ha(a.J),a.J.render(a.getElement())):a.J&&(a.removeChild(a.J,!0),D(a.J),a.J=null);c&&QLc(c,b)}}function oMc(a,b){if(QA&&1!=a.Ga){var c=ZMc(a);b?(a.$=new OMc(a.Ja,a.Na,a.He,a.ea,a.Aa,a.Ga,null!=c&&c.Qb()),a.Ha(a.$),a.$.render(a.getElement())):a.$&&(a.removeChild(a.$,!0),D(a.$),a.$=null);c&&QLc(c,b)}}function YMc(a){A(a.D,function(b){b.qN(a.Gd())})}
function ZMc(a){a=ab(a.D,function(a){return a instanceof BY});return null!=a?a:null}function $Mc(a,b,c){A(a.D,function(a){a.zWa(b,c)});QA&&b&&(a.ea=null,a.Aa=0,a.Ga=null,a.y3(),nMc(a))}function nMc(a){var b=a.La(IY.q3a),c=a.La(IY.o2a);if(a.ea){var d=sA(a.ea);d=RF(d);d=P(MMc,{wH:d});a=a.Mc.Ib();de(a);a.appendChild(d);L(b,!0);ah(c,IY.eya)}else L(b,!1),ch(c,IY.eya)}p.y3=function(){aNc(this,!1);oMc(this,!1)};function bNc(a,b,c,d,e,f,h,k,l,m,q,t){var w=this;IW.call(this,b,h);this.qa=a;this.C=b;this.ea=c;this.Na=d;this.Ta=e;this.L=f;this.H=c.C;this.Oa=this.Ja=!1;this.F=null;this.O=l;this.Ra=t;this.Sc=new dw;this.J=null;cNc(this);i3a.Pa(!0);a=new hg;H(a,6,dNc());b=new fg;Zf(b,58,a);this.Aa=jj(kj(new ij,b),10).build();Al();this.Ga=-1;a=new zi(function(){return eNc(w,!1)},100);this.va(a);a.start()}y(bNc,IW);
function cNc(a){var b=aI(a.Ta);a.Ka.R(a.Na,"selectionChange",a.y2b).R(a.H,"Ba",a.w2b).R(b,"Xa",a.fxb).R(a.C,"Hd",a.pmb).R(a.C,"Gd",a.omb).R(a.C,"Fd",a.mmb).R(a.C,"Md",a.GBb).R(a.C,"Jd",a.Jnb).R(a.C,"Ld",a.x2b).R(a.C,"Qd",a.BEb).R(a.C,"Nd",a.cDb).R(a.C,"Id",a.Qmb).R(a.C,"Rd",a.A2b).R(a.qa.C,"recommender-confidence-update",a.gpb).R(a.C,"Od",a.z2b);a.V.Jb(EB,Na,a.lvb).subscribe(FB,"action",a.Nmb).subscribe(j3a,"action",a.iEb).subscribe(f3a,"action",a.lQa).subscribe(rC,"action",a.Nyb).subscribe(d7a,"action",
a.wEb)}p=bNc.prototype;p.lh=function(){return k3a};p.ls=function(){return l3a};p.Cq=function(a){bNc.ma.Cq.call(this,a);j3a.Pa(a);eNc(this,!1);!this.Ja&&a&&(this.Ja=!0);ws(this.Ra,{pc:a});a||this.C.Jc()};p.eZ=function(a){var b=this;this.C.vpa();var c=new zi(function(){bNc.ma.eZ.call(b,a)},300);this.va(c);c.start()};p.Hka=function(){bNc.ma.Hka.call(this);fNc(this,!1)};p.Jf=function(a){this.C.Jf(a);this.qa.Jf(a)};
p.pmb=function(a){var b=a.C.F,c=W(W(b,13),3);b=AU(b);var d=new Mw;X(d,1,c);var e=new Xx;X(e,1,d);X(e,3,!0);cuc(e,!0);this.L.C(new FS(e,b));a=a.dj();c=Jw(c);JY(this,a,!1,sBc(c))};p.Nmb=function(){var a=this.C.isVisible();this.lh().setVisible(!a);a||this.C.focus();fNc(this,!a)};function fNc(a,b){b?(JY(a,2253),a.Ga=Ha()):JY(a,2226,!0)}p.lQa=function(){this.C.isVisible()||this.Cq(!0)};p.Nyb=function(){var a=ZMc(this.C);a&&(a.Qb()?TLc(a,"",!0):(this.lQa(),SLc(a,"",!0)))};p.iEb=function(a){iMc(this.C,a)};
p.wEb=function(){aNc(this.C,!0)};p.y2b=function(){dJ(this.ea)&&null==this.C.J&&eNc(this,!0)};function eNc(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(dMc(d.Ua),kMc(d));a.qa.update(!b,a.C.isVisible(),c)}
p.gpb=function(a){var b=a.C,c=b?b.H:null;a=b?b.C:0;var d=!!b&&b.F,e=b?b.H.rect:null;e=!!e&&e.kh()>=e1a&&gA(e,"r")>=g1a&&gA(e,"c")>=h1a&&e.kh()<=f1a;b=!!b&&b.D&&e;if(b!==this.Oa||c&&!c.equals(this.F))this.Oa=b,this.F=c,this.Ga=Ha(),i3a.wc({z8:b,wH:c});e&&c&&c.rect&&(b=1E3>=c.rect.kh(),c=ritz_api.RitzModelApi.isFormsRegion(""+c.ud,c.rect.top,c.rect.left,c.rect.height+c.rect.top,c.rect.width+c.rect.left),d=!this.C.isVisible()&&!this.Ja&&d&&b&&!this.ea.Ch(),c=Y0a&&c,b=Z0a&&this.ea.Gd(),d&&(c||b)&&(d=
new hg,H(d,1,a),H(d,2,c),H(d,3,b),H(d,5,PA),H(d,6,dNc()),a=new fg,Zf(a,58,d),a=kj(jj(new ij,10),a).build(),this.Bza(a)))};p.Bza=function(a){var b=this;this.C.Zc=!0;var c=TI(zK(this.H));if(!rcc.C&&!c){var d=a||this.Aa;this.lh().setVisible(!0);this.O.Xb(2225,d);JY(this,2253);a=new zi(function(){b.C.isVisible()||b.O.Xb(2752,d)},5E3);this.va(a);a.start()}};
function dNc(){switch(i1a){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.Qmb=function(){this.C.Jc()};p.A2b=function(a){var b=a.C;var c=AU(b.F);var d=parseInt;var e=c.yb();d=d(e,10);this.J=sA(c);this.L.C(new Fcc(d));BMc(b,c);JY(this,a.dj())};p.w2b=function(){JG(this.H)?(this.C.Pa(!0),eNc(this,!1)):(this.lh().setVisible(!1),this.C.Pa(!1))};p.lvb=function(){this.C.Bba(!EB.isEnabled())};p.fxb=function(a){eNc(this,!1,Tbb(a))};
p.omb=function(a){var b=zK(this.H),c=""+b.kc(),d=[],e=Svc(b);if(e){b=new Oy;var f=$v(e,2);X(b,3,f);f=$v(e,2);X(b,2,f);e=$v(e,1);X(b,1,e);d.push(b)}b=a.C.Ac;for(e=0;e<b.length;e++)f=new Oy,X(f,2,b[e]),d.push(f);this.L.C(new HW(d,c));JY(this,a.dj())};
p.mmb=function(a){var b=a.C,c=IBc(b.C);var d=AU(b.F);var e=c.Hu?c.sx:null,f=c.C?c.Tw:null,h=parseInt;var k=d.yb();h=h(k,10);k=gNc(d);this.J=sA(d);k?this.L.C(new KW(k,h,this.J,e,c.Wr,c.Xs,f)):this.L.C(new GW(h,this.J,e,c.Wr,c.Xs,f));d=new Wtc;H(d,1,1);c=new vU;b=W(b.F,2);H(c,2,b);Zf(c,5,d);b=zIc(this.F);Zf(b,46,c);b=kj(jj(new ij,10),b).build();this.O.C(a.dj(),b)};p.GBb=function(a){a=a.C;var b=AU(a.F);var c=parseInt;var d=b.yb();c=c(d,10);d=gNc(b);this.J=sA(b);this.L.C(new UBc(d,c));BMc(a,b)};
p.z2b=function(a){var b=zK(this.ea.C),c=b.kc();b=qA(z$a(a.J,b),c);c=xIc(b,a.F,a.V);var d=this.qa,e=a.F;juc(d.C);d.C.Na=b;d.C.Ja=c;d.C.Oa=e;puc(d.C,!0,!0,!1);JY(this,a.dj())};function gNc(a){var b=a.yb();a=sA(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.yc(),a.rc(),a.Uc(),a.Wc(),7,!1);return 0<b.length?b[0]:null}p.Jnb=function(a){KI(zK(this.H),a.Ja);JY(this,a.dj())};
p.BEb=function(a){var b=a.C;a=a.dj();if(b instanceof pY||b instanceof rY||b instanceof FMc)JY(this,a);else{var c=jMc(this.C),d=new vU,e=W(b.F,2);c=c.indexOf(b);H(d,1,c);H(d,2,e);e=new fg;Zf(e,46,d);if(b instanceof ZX){(d=b.H)?(b=hNc(this,b,d),b=fAc(b,d,d.dg())):b=null;if(!b)return;Zf(e,39,b)}else if(b instanceof MIc){var f=b.F;c=new dHc;if(b instanceof MIc)b=1;else throw Error("Unknown text analysis card type.");f=Zv(W(f,8),20).slice(0,10);H(c,2,f||[]);H(c,1,b);Zf(d,3,c)}e=kj(jj(new ij,10),e).build();
this.O.C(a,e)}};p.cDb=function(){this.C.Jc()};
p.x2b=function(a){var b=a.J;if(b){var c=zK(this.H),d=a.$;d||(d=iA(IG(this.Na).D.C));var e=16,f=16,h=a.Ga;h&&(e=h.x,f=h.y);h=zuc(this.ea.J);d={oid:null,ar:OI(c,d.y),ac:PI(c,d.x),x:e,y:f,h:wbb.height,w:wbb.width,p:{context:Fvc(h)}};(c=b.dg())?(e=new Vk(c),d=new eK(WI(this.H)||0,d,!1,!1),f=dl(e,"headers"),f=null!=f&&na(f)&&Kb(f)?parseInt(f,10):-1,d.Ga=f,d.L=0,f="1"==dl(e,"transpose"),d.qa=f,d.H=f?"ROWS":"COLS",f=dl(e,"range"),f=uvc(vvc(f,","),this.H),d.lH(f),(e=dl(e,"dt"))&&Jnb(d,this.Sc.xd(vz.Ca(),
JSON.parse(decodeURIComponent(e))))):(e=new Cz,X(e,2,"0.6"),f=a.Od().toJSON(),X(e,1,f),d=new eK(WI(this.H)||0,d,!1,!1,e));fK(d);xuc(d,b);this.Na.dispatchEvent(new $M("objectRequest"));this.L.C(new eP(this.ea,d));e=iNc(this,b,a.V,a.Od());d=d.getId()||0;e.H=d;hW(this.O,a.dj(),e,10,b,c,void 0,a.F)}};function hNc(a,b,c){var d=jMc(a.C).filter(function(a){return a instanceof ZX});return iNc(a,c,d.indexOf(b),b.H&&b.H.Od())}
function iNc(a,b,c,d){var e=new fW;a=jMc(a.C).filter(function(a){return a instanceof ZX}).map(function(a){return a.getChartType()});e.V=a;e.J=c;Szc(e,b.getChartType());e.F=d?d.clone():null;return e}
function JY(a,b,c,d){if(a.F){var e=Xf(Aka(a.Aa),hg,58).getTableRange();if(c||!e||e.yb()!=a.F.ud||e.rc()!=a.F.rect.rc()||e.yc()!=a.F.rect.yc()||e.Wc()!=a.F.rect.Wc()||e.Uc()!=a.F.rect.Uc()){e=new hg;H(e,6,dNc());var f=yIc(a.F);Zf(e,7,f);c&&(c=Ha()-a.Ga,H(e,8,1E3*c),null!=a.C.Ac&&(c=Ha()-a.C.Ac,H(e,10,1E3*c)));d&&Xtc(e,d);d=J(I(),"feacos");H(e,9,d);d=new fg;Zf(d,58,e);a.Aa=jj(kj(new ij,d),10).build()}}a.O.Xb(b,a.Aa)};function jNc(){B.call(this)}y(jNc,TA);jNc.prototype.tgb=function(){return fMc};jNc.prototype.vgb=function(){return HY};jNc.prototype.ugb=function(){return bNc};jNc.prototype.F=function(){return XHc};aB("assistant",jNc);
