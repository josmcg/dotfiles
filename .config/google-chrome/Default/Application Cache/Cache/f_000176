fg.prototype.qQ=ER(11,function(){return G(this,56)});var xXd=[5];function yXd(a){Sf(this,a,0,-1,xXd,null)}y(yXd,Rf);yXd.prototype.getContext=function(){return G(this,1)};yXd.prototype.setContext=function(a){H(this,1,a)};yXd.prototype.$u=function(){H(this,1,void 0)};function zXd(a,b){var c=new jX,d;for(d in a.C)d in b.C||(c.C[d]=null);return c}
function AXd(a){return R("<div"+(a.id?' id="'+T(a.id)+'"':"")+' class="'+(a.Nf?T(a.Nf)+" ":"")+T("goog-flat-menu-button")+" "+T("goog-flat-menu-button-disabled")+" "+T("goog-inline-block")+'" role="button"'+(a.xo?' aria-label="'+T(a.xo)+'"':"")+'><div class="'+T("goog-flat-menu-button-caption")+" "+T("goog-inline-block")+'">'+Q(a.qB)+'</div><div class="'+T("goog-flat-menu-button-dropdown")+" "+T("goog-inline-block")+'" aria-hidden="true">&nbsp;</div>'+(a.cl?Q(a.cl):"")+"</div>")}
function BXd(a,b,c){b=c||b;a=a||{};return R(jEa($p({FW:bq("docs-icon-close-small")},a),b))}function CXd(a,b){us.call(this);this.C=a;this.D[a]=b}y(CXd,us);CXd.prototype.Sl=function(a){var b={};b[this.C]=a;ws(this,b)};function Z5(){Kr.call(this);this.C=new jX;Lr(this,new Pr(Jr,{},{wordList:[]}));this.J=new hm;this.va(this.J)}y(Z5,Kr);va(Z5);Z5.prototype.F=function(a){DXd(this,a,!0)};function DXd(a,b,c){var d=a.C.contains(b.toLowerCase()),e=b.toLowerCase();a.C.add(e);if(!d){var f={};f.value=e;Mr(a).get("wordList").push(f);c&&EXd(a,[b],[])}return!d}Z5.prototype.L=function(a){FXd(this,a,!0)};
function FXd(a,b,c){var d=a.C.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.C.remove(e);for(var f=Mr(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&EXd(a,[],[b])}return d}Z5.prototype.H=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)DXd(this,a[b].value,!1);a.length&&this.J.dispatchEvent(null)};function EXd(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.J.dispatchEvent(null);a.D.dispatchEvent(new Or(new Nr("docs-user_dictionary",d),Mr(a)))};function GXd(a,b,c){Mp.call(this,a,b,c);np(this,"Preferences")}y(GXd,Mp);p=GXd.prototype;p.Ia=function(){GXd.ma.Ia.call(this);this.getHandler().R(this,"dialogselect",this.Z8a)};p.setVisible=function(a){GXd.ma.setVisible.call(this,a);a&&this.update()};p.update=ua;p.Z8a=function(a){"ok"==a.key&&this.oSa()};p.oSa=ua;function HXd(a){a='<b>"'+(Q(a.jU)+'"</b> added to your personal dictionary.');return R(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function IXd(a){a='<b>"'+(Q(a.jU)+'"</b> removed from your personal dictionary.');return R(""+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}
function JXd(a,b,c){b=c||b;a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input '+T("jfk-textinput")+'" type="text" aria-label="'+T(a.TMa)+'" placeholder="'+T(a.TMa)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+Q(lr({Ed:"docs-userdictionarydialog-button-add",style:0,content:gq("Add")},b))+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>');
return R(a)}function KXd(a){return R('<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+T(a.jU)+'" class="docs-userdictionarydialog-row-content">'+Q(a.jU)+"</div></div>")};function $5(a,b){Oj.call(this,void 0,new LXd);this.Isa=a;this.C=b}y($5,Oj);$5.prototype.Lo=ba();$5.prototype.gR=function(a){a.relatedTarget&&oe(this.C,a.relatedTarget)||$5.ma.gR.call(this,a)};$5.prototype.Li=function(a){return(46==a.keyCode||8==a.keyCode)&&this.Dh(a)};function LXd(){}y(LXd,fi);LXd.prototype.tc=n("docs-userdictionarydialog-row-container");LXd.prototype.xa=function(a){return P(KXd,{jU:a.Isa})};function a6(a){bk.call(this,void 0,new MXd);this.D=a;this.C=this.F=null}y(a6,bk);p=a6.prototype;p.Ia=function(){a6.ma.Ia.call(this);ei(this.Da,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");Yh(this.Da,"listbox");var a=this.F;L(a,!1);Nh(a,!0);this.C=new Jj(a);this.getHandler().R(this,"action",this.Boa).R(this.F,"click",this.Boa).R(this.C,"key",this.mnb)};p.hd=function(){a6.ma.hd.call(this);D(this.C);this.C=null};
function NXd(a){var b=[];a.Cf(function(a){b.push(a.Isa)});return b}p.Boa=function(){var a=ek(this);var b=this.Oj==this.cd()-1;this.highlightPrevious();this.removeChild(a,!0);b||this.highlightNext();OXd(this);this.dispatchEvent("change")};p.mnb=function(a){return 13==a.keyCode||32==a.keyCode?(this.Boa(a),a.preventDefault(),a.stopPropagation(),!0):!1};p.kx=function(){0==this.Ki("docs-userdictionarydialog-row-container-hover").length&&fk(this)};p.ws=function(a){a.stopPropagation();a.preventDefault()};
p.Hj=function(a){return 27==a.keyCode?!1:a6.ma.Hj.call(this,a)};p.pY=function(a){a6.ma.pY.call(this,a);OXd(this)};p.Cja=function(a){var b=xe(document);a6.ma.Cja.call(this,a);b&&$g(b,"docs-userdictionarydialog-list-remove-button")?this.Da.focus():OXd(this)};function OXd(a){if(ek(a)){var b=ek(a),c=Math.round((Hh(b.Da).height-Hh(a.F).height)/2);a.F.style.top=wh(b.Da).y+c+"px";ei(a.F,"Remove "+b.Isa);L(a.F,!0)}else L(a.F,!1)}function MXd(){this.C=void 0}y(MXd,Nj);
MXd.prototype.Fp=function(a){var b=P(BXd,{enabled:!0,Nf:"docs-userdictionarydialog-list-remove-button"});a.F=b;a.getElement().appendChild(b)};function b6(a,b,c,d){GXd.call(this,b,c,d);this.ea=a;this.F=new mr(null,d);this.Ha(this.F);this.L=this.C=null;this.J=new a6(a);this.Ha(this.J);this.O=null;np(this,"Personal dictionary");a=Ip((new vp).set("ok","Save",!0),Lp,!1,!0);yp(this,a)}y(b6,GXd);p=b6.prototype;p.xa=function(){b6.ma.xa.call(this);Rp(this.Ib(),JXd,{TMa:"Add a new word"});yq(this,"ok");this.F.Va(this.La("docs-userdictionarydialog-button-add"));this.J.Va(this.La("docs-userdictionarydialog-list-container"));this.C=this.La("docs-userdictionarydialog-input")};
p.Ia=function(){b6.ma.Ia.call(this);this.F.Pa(!1);this.L=new Aq(this.C);this.getHandler().R(this.F,"action",this.slb).R(this.C,"keypress",this.C$a).R(this.L,"input",this.B$a).R(this.J,"change",this.zqb);this.getHandler().R(this.F.getElement(),"focus",this.gha).R(this.C,"focus",this.gha);for(var a=Aza(this.D),b=0;b<a.length;b++)this.getHandler().R(a[b],"focus",this.gha);this.O=new qM(this.J)};p.hd=function(){b6.ma.hd.call(this);Cb(this.L,this.O);this.O=this.L=null};p.slb=function(){PXd(this)};
p.B$a=function(){this.F.Pa(!Jb(Yb(this.C.value)))};p.C$a=function(a){13==a.keyCode&&(this.F.isEnabled()&&PXd(this),a.stopPropagation(),a.preventDefault())};p.gha=function(){this.J.yg(-1)};p.zqb=function(){zp(this.D,"ok").disabled=!1};p.update=function(){var a=this.J;a.Id(!0);var b=a.D.C.Cd();b.sort(wDc());for(var c=0;c<b.length;c++)a.Ha(new $5(b[c],a.F),!0);QXd(this,"");zp(this.D,"ok").disabled=!0};
p.oSa=function(){var a=this.J;var b=new jX(a.D.C.Cd());var c=new jX(NXd(a));a=zXd(c,b).Cd();b=zXd(b,c).Cd();c=this.ea;for(var d=[],e=[],f=0;f<a.length;f++)DXd(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)FXd(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&EXd(c,d,e)};
p.setVisible=function(a){b6.ma.setVisible.call(this,a);if(a){var b=this.C;b&&(b.focus(),a=b.value.length,GEa(b)?(b.selectionStart=a,b.selectionEnd=a):Ic&&!Tc("9")&&(a=IEa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};function QXd(a,b,c){a.C.value=b;a.F.Pa(!Jb(Yb(a.C.value)));c&&a.C.select()}
function PXd(a){var b=a.J,c=a.C.value;c=c.toLowerCase().trim();-1==NXd(b).indexOf(c)&&(c=new $5(c,b.F),b.jh(c,0,!0),b.Da.scrollTop=0,b.dispatchEvent("change"));Fe(a.oa())==a.C&&a.C.blur();QXd(a,"");a.C.focus()};function RXd(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&QXd(a,c,!0)};function SXd(){B.call(this);this.C=new Xq;this.D=new hm;this.va(this.D)}y(SXd,B);function TXd(){}TXd.prototype.get=Je;function UXd(a,b){this.C=a;this.D=b}UXd.prototype.equals=function(a){return this.C.equals(a.C)&&this.D.equals(a.getSelection())};UXd.prototype.getSelection=g("D");function VXd(a,b){this.D=a;this.C=b};function WXd(a,b,c){this.C=a;this.F=b;this.D=c||null}WXd.prototype.Dv=g("F");function XXd(a,b,c,d,e,f){this.F=a;this.L=b;this.C=c;this.D=d;this.H=e;this.J=f||null;this.Ka=new hh(this);this.va(this.Ka)}y(XXd,B);p=XXd.prototype;p.A$a=function(a){var b=this.C.C;YXd(this.D,a);ZXd(this,b,!0)};
p.Inb=function(a){var b=this.C.C,c=this.D,d=Ub(a.C.Dv()),e=a.D;a=new uE;X(a,1,"\\b"+d+"\\b");X(a,3,e);X(a,6,!1);X(a,7,!1);X(a,8,!0);a.setType(2);X(a,11,0);d=c.C.F;switch(c.C.V){case "RANGE":X(a,5,0);a.setSelection(qA(d.rect,d.ud));var f=QH(c.D,d.ud);break;case "SHEET":X(a,5,1);f=new uw;X(f,1,""+d.ud);a.setSelection(f);f=QH(c.D,d.ud);break;case "WORKBOOK":X(a,5,2),f=c.D.V5(-1,0,!1)}f=f.Nc();c.F.C(new dX(f,a));ZXd(this,b,!0)};
p.Bub=function(a){var b=this.C.C;if(na(a)){var c=this.L;c.C.contains(a.toLowerCase())||(c.C.add(a.toLowerCase()),c.D.dispatchEvent(null))}ZXd(this,b,!1)};p.qpb=function(a){var b=this.C.C;if(a instanceof UXd){var c=this.D.H,d=a.C.Dv();a=a.getSelection();if(!$Xd(c,d,a)){var e=c.C[""+a.C];e||(e=YF(c.F,a.C),e.getSheetType(),e=e.Nc(),e=new bI(e,!0),c.C[""+a.C]=e);c=a.Bd.y;a=a.Bd.x;var f=e.Se(c,a);f||(f=new Xq,cI(e,c,a,f));f.add(d.toLowerCase())}}ZXd(this,b,!1)};
p.qzb=function(a){var b=this.C.C;na(a)&&(this.J?this.J.F(a):Z5.getInstance().F(a));ZXd(this,b,!1)};p.bDa=function(){K.nda.Oc(!1);this.Ka.Rc(this.F,"docs-text-spellcheckdialogcontroller-closed",this.bDa);aYd(this.D.C)};p.oMb=function(){ZXd(this,null,!1)};p.GKa=function(a){var b=this.F.C;L(b.Aa,!1);L(b.Ga,!0);b=this.C;var c=v(this.JVa,this,this.C.C,!1);this.H.C.getSelection();b.C&&(a?b.L.unshift(b.C):b.ea.push(b.C));bYd(b,c,!!a)};
function ZXd(a,b,c){var d=a.F.C;L(d.Aa,!1);L(d.Ga,!0);b=v(a.JVa,a,b,c);a.H.C.getSelection();bYd(a.C,b,!1)}
p.JVa=function(a,b){a=this.F;a.C.setVisible(!0);var c=a.C;L(c.Aa,!0);L(c.Ga,!1);c=a.C;var d=c.J.C;xi(c.jb);var e=c.oa().xb("docs-slidingdialog-content",c.getElement());e&&Zh(e,"label",d?"Spellcheck":"No spelling suggestions");if(d){e=d.C;var f=c.oa();c.getHandler().Rc(c.F,"focus",c.hLa).Rc(c.F,"blur",c.gLa).Rc(c.O,"input",c.jLa).Rc(c.F,"keydown",c.iLa);c.H.Qa("");var h=c.F,k=h.cloneNode(!0);he(k,h);c.F=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!c.F)throw Error("Replacement input not in DOM.");
D(c.removeChild(c.H));c.H=new xS("",f);c.Ha(c.H);c.H.Va(c.F);D(c.O);c.O=new Aq(c.F);for(c.getHandler().R(c.F,"focus",c.hLa).R(c.F,"blur",c.gLa).R(c.O,"input",c.jLa).R(c.F,"keydown",c.iLa);0<c.D.cd();)c.D.Bn(0).dispose();f="Next misspelling. Change "+(e.Dv()+" to:");Zh(c.F,"label",f);c.oa().Te(c.vd,e.Dv());f=oc(e.C);if(0==f.length)c.H.Qa(e.Dv()),e=new hk("No suggestions"),c.D.Ha(e,!0),e.kf(2,!1),e.Pa(!1),c.$b.Sl(!1);else{c.H.Qa(f[0]);for(h=0;h<f.length;h++)e=new hk(f[h]),c.D.Ha(e,!0),c.getHandler().R(e,
"action",c.vGb).R(e.getElement(),"dblclick",c.Nwb),1<f.length&&(e.yp(!0),ah(Qd("goog-menuitem-checkbox",e.Da),"goog-inline-block"));(e=c.D.kd(0))&&1<c.D.cd()&&e.Ec(!0);c.D.yg(0);c.$b.Sl(!0)}CDc(c.Na,d.getSelection());c.uVa.call(c,c.ea);c.uVa.call(c,c.Ra);L(c.Ua,!1);L(c.Ta,!0)}else L(c.Ta,!1),de(c.Ob),c.Db&&c.Ob.appendChild(c.Db),L(c.Ua,!0),c.jb=wi(v(c.jr,c),c.Ac),c.Na.$u();a.C.focus();(a=this.C.C)?cYd(this.D,a.getSelection()):b&&cYd(this.D)};function dYd(a,b){this.C=a;this.D=b}var eYd=Ec(K.i1a.getId(),K.E_a.getId(),K.sN.getId(),K.IU.getId(),K.zU.getId()),fYd=Ec(K.mYa.getId(),K.EN.getId());function gYd(a,b,c,d,e,f,h){iX.call(this,h);this.L=a;this.J=b;this.zd=new dYd(e,f);this.Na=new BDc(c);this.Ha(this.Na);this.$=new mr(null,h);this.Ha(this.$);this.ea=new mk(h);this.kb=null;this.Mc=new tr(null,this.ea,NN.getInstance());this.Ha(this.Mc);this.Oa=new mr(null,h);this.Ha(this.Oa);this.Ra=new mk(h);this.Bb=null;this.Zc=new tr(null,this.Ra,NN.getInstance());this.Ha(this.Zc);this.wb=this.qa=this.V=null;this.H=new xS("",h);this.Ha(this.H);this.D=new hYd(h);nk(this.D,!1);this.Ha(this.D);this.Db=
this.Ob=this.Ua=this.Ta=this.O=this.F=null;this.Ac=5E3;this.jb=this.vd=null;this.$b=d;this.Aa=this.Ga=this.Ja=null}y(gYd,iX);function iYd(a){bh(a.Da,["goog-menu-no-icon","goog-menu-noaccel"])}p=gYd.prototype;
p.pha=function(){var a=bq("Spellcheck");var b=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+Q(EDc())+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><div class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</div><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false">'+Q(DDc({id:"docs-spellcheckslidingdialog-replacement-context"}))+
"</td><td>"+Q(lr({id:"docs-spellcheckslidingdialog-button-change",style:2,Ed:"docs-spellcheckslidingdialog-buttons-action",content:gq("Change")},void 0))+Q(AXd({id:"docs-spellcheckslidingdialog-button-change-menu",qB:""}))+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+Q(lr({id:"docs-spellcheckslidingdialog-button-ignore",style:0,Ed:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",
content:gq("Ignore")},void 0))+Q(AXd({id:"docs-spellcheckslidingdialog-button-ignore-menu",Nf:"docs-spellcheckslidingdialog-buttons-white-menu",qB:""}))+"<br/>"+Q(lr({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,Ed:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",content:gq("Add to Dictionary")},void 0))+Q(AXd({id:"docs-spellcheckslidingdialog-button-dictionary-menu",Nf:"docs-spellcheckslidingdialog-buttons-white-menu",qB:""}))+"</td></tr></tbody></table></div></div></div>");
b=R(b);a=""+(""+Q(FDc({GBa:a,Tk:gq(""+b)}))+"");return R(a)};p.K5=function(a){var b=this.zd,c=this.J.C,d=new fg,e=c?c.C.qQ():null,f=b.C.C.replace(/_/g,"-");J(I(),"docs-anddc")||J(I(),"docs-agdc");Jb(Yb(e))||H(d,56,e);H(d,60,f);if(c){e=c.C;var h,k;oc(e.C).length&&(h=oc(e.C)[0]);h&&(k=e.C[h]);h=new yXd;k&&H(h,5,k.C||[]);if(b=b.D.get(c))a=eYd[a]?b.C-b.D:fYd[a]?b.C:a==K.Z1a.getId()?b.C+1:b.C-1,H(h,6,a);Zf(d,66,h)}return kj(jj(new ij,1),d).build()};
p.xa=function(){gYd.ma.xa.call(this);var a=Vd("SPAN","docs-spellcheckslidingdialog-menu-text","Change all"),b=Vd("SPAN","docs-spellcheckslidingdialog-count","");this.kb=new hk([a,b]);this.ea.Ha(this.kb,!0);a=Vd("SPAN","docs-spellcheckslidingdialog-menu-text","Ignore all");b=Vd("SPAN","docs-spellcheckslidingdialog-count","");this.Bb=new hk([a,b]);this.Ra.Ha(this.Bb,!0)};
p.Ia=function(){gYd.ma.Ia.call(this);ah(this.Da,"docs-spellcheckslidingdialog");var a=this.oa();this.Ga=a.getElement("docs-spellcheckslidingdialog-loading");this.Aa=a.getElement("docs-spellcheckslidingdialog-content");this.Ua=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.Ob=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.Ta=a.getElement("docs-spellcheckslidingdialog-misspellings");this.F=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.O=
new Aq(this.F);this.vd=a.getElement("docs-spellcheckslidingdialog-original-word");this.Na.Va(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.H.Va(this.F);this.$.Va(a.getElement("docs-spellcheckslidingdialog-button-change"));this.Oa.Va(a.getElement("docs-spellcheckslidingdialog-button-ignore"));jYd(this.Mc,this.$,"docs-spellcheckslidingdialog-button-change-menu",K.qda,this.L,a);jYd(this.Zc,this.Oa,"docs-spellcheckslidingdialog-button-ignore-menu",K.sda,this.L,a);this.D.Va(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
this.D.Kh(!0);iYd(this.D);Yi(this.L,this.Oa,K.yU,$i,v(this.J.Ja,this.J),v(this.K5,this,K.yU.getId()));Yi(this.L,this.$,K.tN,$i,v(this.Fib,this),v(this.K5,this,K.tN.getId()));this.V=new mr(null,this.oa());this.qa=new mk(a);this.wb=new tr(null,this.qa,NN.getInstance(),a);this.Ha(this.V);this.Ha(this.wb);this.V.Va(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));kYd(this,this.V,K.IU,!0);jYd(this.wb,this.V,"docs-spellcheckslidingdialog-button-dictionary-menu",K.rda,this.L,a);a=new hk("View personal dictionary...");
var b=zc($i);delete b["node-label"];delete b.label;Yi(this.L,a,K.Ey,b,v(this.C5,this,this.J));this.qa.Ha(a,!0);iYd(this.qa);Yi(this.L,this.kb,K.sN,void 0,v(this.F7a,this),v(this.K5,this,K.sN.getId()));iYd(this.ea);kYd(this,this.Bb,K.zU,!1);iYd(this.Ra);this.getHandler().R(this.D.getElement(),Ic?Xe:"focus",this.UEb);this.Ja=new Bt(this.getElement());this.va(this.Ja);a=nHa("Ctrl+single-quote",!1);b=nHa("Ctrl+semicolon",!1);qHa(this.Ja,K.G2,[a]);qHa(this.Ja,K.I2,[b])};
p.focus=function(){Kh(this.Ta)?BS(this.H):this.Ua.focus()};function jYd(a,b,c,d,e,f){c=f.getElement(c);a.Va(c);yU(a,1);R9b(a,b.getElement());yU(b,2);b=new pj(c,a.Ne()?1:5);Q9b(a,b);Yi(e,a,d,$i)}p.uVa=function(a){a=Qd("docs-spellcheckslidingdialog-count",a.getElement());this.oa().Te(a,"")};function lYd(a){var b=a.H.Ma();a=new WXd(b,a.C5(a.J),a.J);K.tN.wc(a)}p.Nwb=function(){lYd(this)};p.hLa=function(){var a=this.oa().Sq(this.F);ah(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
p.gLa=function(){var a=this.oa().Sq(this.F);ch(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};p.iLa=function(a){13==a.keyCode&&lYd(this)};p.UEb=function(){for(var a=0;a<this.D.cd();a++){var b=this.D.kd(a);if(b.isChecked()){b.Tf(!0);return}}0<this.D.cd()&&this.D.yg(0)};function mYd(a){for(var b=0;b<a.D.cd();b++)a.D.kd(b).Ec(!1)}p.jLa=function(){mYd(this);this.$b.Sl(!0)};p.vGb=function(a){var b=a.target.Ma();mYd(this);this.H.Qa(b);(a=a.target)&&1<this.D.cd()&&a.Ec(!0);BS(this.H)};
p.Fib=function(){var a=this.H.Ma();return new WXd(a,this.C5(this.J),this.J)};p.F7a=function(){var a=this.J;a=a.C?a.C.C:null;return new VXd(this.H.Ma(),a)};function kYd(a,b,c,d){Yi(a.L,b,c,d?$i:void 0,v(a.C5,a,a.J),v(a.K5,a,c.getId()))}p.C5=function(a){return(a=a.C)?a.C.Dv():null};p.Fa=function(){xi(this.jb);D(this.O);gYd.ma.Fa.call(this)};function hYd(a,b){mk.call(this,a,b)}y(hYd,mk);hYd.prototype.Hj=function(a){return 27==a.keyCode?!1:hYd.ma.Hj.call(this,a)};function nYd(){var a=Z5.getInstance(),b=Un.getInstance();this.H=a;this.C=b;this.D=0}nYd.prototype.F=function(a){this.H.F(a);a=Xn(P(HXd,{jU:a}),K.Dn.getLabel(),v(this.L,this,a),"info",!0,1E4);Vn(this.C,this.D);this.D=this.C.postMessage(a)};nYd.prototype.L=function(a){this.H.L(a);a=Xn(P(IXd,{jU:a}),K.Dn.getLabel(),v(this.F,this,a),"info",!0,1E4);Vn(this.C,this.D);this.D=this.C.postMessage(a)};function oYd(a,b,c,d,e,f,h,k){F.call(this);this.J=a;this.H=b;this.L=c;this.D=e;this.hb=k||new Ld;this.C=new gYd(this.H,this.D,this.L,d,f,h,this.hb);this.va(this.C);this.Ka=new hh(this);this.va(this.Ka)}y(oYd,F);oYd.prototype.F=function(){this.Ka.Rc(this.C,"close",this.F);this.dispatchEvent("docs-text-spellcheckdialogcontroller-closed");lCa(ur.getInstance())||this.J.Cb(3);K.Pk.isEnabled()||Un.getInstance().postMessage(Wn("Spellcheck will be unavailable until you reconnect.","info",!0,1E4))};function pYd(a){B.call(this);this.F=a;this.C={};this.D=new hh(this);this.va(this.D);this.D.R(a,"Na",this.H)}y(pYd,B);function $Xd(a,b,c){if(a=a.C[""+c.C])if(c=a.Se(c.Bd.y,c.Bd.x))return!!c.contains(b.toLowerCase());return!1}pYd.prototype.H=function(a){D(this.C[""+a.hh]);delete this.C[""+a.hh]};function qYd(){this.C=[]};function rYd(a,b,c){this.D=a;this.F=c||null;this.C=b}rYd.prototype.Dv=g("D");rYd.prototype.qQ=g("F");rYd.prototype.equals=function(a){var b=a.Dv(),c=a.qQ();a=oc(a.C);return this.D==b&&this.F==c&&xb(oc(this.C),a)};function c6(){V.call(this)}y(c6,V);var sYd=null;c6.prototype.rangeCount=function(){return Vv(this,2)};function d6(){V.call(this)}y(d6,V);var tYd=null;d6.prototype.kc=function(){return W(this,1)};function uYd(){V.call(this)}y(uYd,V);var vYd=null;function e6(){V.call(this)}y(e6,V);var wYd=null;e6.prototype.OJ=function(){return W(this,2)};function f6(){V.call(this)}y(f6,V);var xYd=null;f6.prototype.Dv=function(){return W(this,1)};f6.prototype.qQ=function(){return W(this,5)};
c6.prototype.Ca=function(){var a=sYd;a||(sYd=a=aw(c6,{0:{name:"SpellcheckRequest",qb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",Ba:5,type:Number},2:{name:"range",Ba:11,type:uw},3:{name:"search_all_sheets",Ba:8,type:Boolean},4:{name:"active_filter_views",Hc:!0,Ba:11,type:d6}}));return a};c6.Ca=c6.prototype.Ca;
d6.prototype.Ca=function(){var a=tYd;a||(tYd=a=aw(d6,{0:{name:"FilterViewDataProto",qb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",Ba:9,type:String},2:{name:"filter_view_id",Ba:9,type:String}}));return a};d6.Ca=d6.prototype.Ca;
uYd.prototype.Ca=function(){var a=vYd;a||(vYd=a=aw(uYd,{0:{name:"SpellcheckResponse",qb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",Ba:5,type:Number},2:{name:"last_column_searched",Ba:5,type:Number},3:{name:"last_grid_id_searched",Ba:9,type:String},4:{name:"searched_all_sheets",Ba:8,type:Boolean},6:{name:"searched_whole_range",Ba:8,type:Boolean},5:{name:"cell_suggestions",Hc:!0,Ba:11,type:e6}}));return a};uYd.Ca=uYd.prototype.Ca;
e6.prototype.Ca=function(){var a=wYd;a||(wYd=a=aw(e6,{0:{name:"CellSuggestionsProto",qb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",Hc:!0,Ba:11,type:f6},2:{name:"cell",Ba:11,type:Vx}}));return a};e6.Ca=e6.prototype.Ca;
f6.prototype.Ca=function(){var a=xYd;a||(xYd=a=aw(f6,{0:{name:"PhraseSuggestionsProto",qb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",Ba:9,type:String},2:{name:"offset_start_index",Ba:5,type:Number},3:{name:"offset_end_index",Ba:5,type:Number},4:{name:"suggestions",Hc:!0,Ba:9,type:String},5:{name:"spelling_language",Ba:9,type:String}}));return a};f6.Ca=f6.prototype.Ca;function yYd(a,b,c){this.Bd=a;this.C=b;this.rf=c}yYd.prototype.equals=function(a){return this===a?!0:a instanceof yYd?Ed(a.Bd,this.Bd)&&a.C==this.C&&kMa(a.rf,this.rf):!1};function g6(a,b,c,d,e){this.H=a;this.Ta=b;this.Ua=c;this.Ra=d;this.Oa=e;this.D=this.J=this.C=null;this.O=!1;this.L=[];this.ea=[];this.qa=new hh(this);this.va(this.qa);this.$=null;this.V="RANGE";this.Ga=new dw;this.Ga.Gi=!0;this.Aa=new dw;this.Aa.Gi=!1}y(g6,B);g6.prototype.Ja=g("C");function aYd(a){wK(a.$);a.qa.Lc();a.V="RANGE";a.O=!1;a.L=[];a.ea=[]}
function zYd(a,b){var c=b.getSelection(),d=QH(a.H,c.C),e;(e=!d)||(d=d.Nc(),e=c.Bd,e=!(jI(LG(d,"r"),e.y)&&jI(LG(d,"c"),e.x)));if(e)return!1;c=c.rf;a=AYd(a,b);b=b.C.Dv();return a.substring(c.start,c.end)==b}function AYd(a,b){a=BYd(a,b);return Db(a,"'")?a.substring(1):a}function CYd(a,b){a=BYd(a,b);return Db(a,"'")}function BYd(a,b){b=b.getSelection();var c=b.Bd,d=b.C;a=QH(a.H,d).Nc();a.vt(Vz(b.Bd));return WH(a.Qf(c.y,c.x),d,c.y,c.x)}
function DYd(a,b){if(a.D){var c=new c6,d=new uw;X(d,1,a.D);X(d,2,a.J.y);switch(a.V){case "WORKBOOK":X(c,3,!0);d.Gu(0);var e=XI(a.H);for(var f=0;f<e.length;f++)0==e[f].getSheetType()&&EYd(c,e[f]);break;case "SHEET":d.Gu(0);e=QH(a.H,a.F.ud);EYd(c,e);break;case "RANGE":d.Gu(a.F.rect.rc()),vw(d,a.F.rect.Uc()),d.Rx(a.F.rect.Wc()),e=QH(a.H,a.F.ud),EYd(c,e)}X(c,2,d);X(c,1,a.J.x+1);Ot(Cq(ts(Dq(a.Ta.Ke("/spell"),{data:a.Ga.serialize(c)}),"POST"),function(a){this.Zk(a,b)},a),function(){this.Zk(null,b)},a).ue()}else FYd(a,
b,!1)}function EYd(a,b){if(b){var c=b.Nc().H;if(HG(c)){b=""+b.yb();c=dI(c);var d=new d6;X(d,1,b);X(d,2,c);Wv(a,4,d)}}}
g6.prototype.Zk=function(a,b){if(a){a=this.Aa.xd(uYd.Ca(),a.Xe());this.J=new Dd(W(a,2),W(a,1));this.D=W(a,3);this.O=W(a,6);a=Zv(a,5);for(var c=0;c<a.length;c++){var d=a[c],e=d.OJ().Tq(),f=d.OJ().getColumnIndex();e=new Dd(f,e);f=parseInt(d.OJ().yb(),10);d=Zv(d,1);for(var h=0;h<d.length;h++){var k=d[h],l=k.Dv(),m=W(k,2),q=W(k,3),t=k.qQ();m=new yYd(e,f,new Bu(m,q));if(!GYd(this,l,m)){k=Zv(k,4);q={};for(var w=0;w<k.length;w++)q[k[w]]=new qYd;this.L.push(new UXd(new rYd(l,q,t),m))}}}}bYd(this,b,!1)};
function bYd(a,b,c){if(c){var d=a.ea;var e=v(d.pop,d)}else d=a.L,e=v(d.shift,d);for(;0<d.length;){var f=e(),h=f.C.Dv();if(!GYd(a,h,f.getSelection())){e=c;h=f.getSelection();c=QH(a.H,h.C);d=c.Nc();h=Vz(h.Bd);f=v(a.Na,a,f,b,e);d.vt(h)?f():(wK(a.$),a.$=RG(c.C,h).addCallback(f));return}}FYd(a,b,c)}function FYd(a,b,c){a.O||c?(a.C=null,b(null)):DYd(a,b)}g6.prototype.Na=function(a,b,c){zYd(this,a)?(this.C=a,b(a.C)):bYd(this,b,c)};
function GYd(a,b,c){return a.Ra.C.contains(b.toLowerCase())||$Xd(a.Oa,b,c)||a.Ua.C.contains(b.toLowerCase())}g6.prototype.Fa=function(){g6.ma.Fa.call(this);wK(this.$)};function HYd(a,b,c,d){this.D=a;this.F=b;this.C=c;this.H=d}
function YXd(a,b){var c=b.D.C;if(zYd(a.C,c)){var d=c.getSelection(),e=d.C,f=d.rf,h=QH(a.D,e).Nc(),k=CYd(a.C,c);c=AYd(a.C,c);var l=new uO(h,Vz(d.Bd),(k?"'":"")+c.substring(0,f.start)+b.C+c.substring(f.end));UF(l,v(function(a){if(a){a=this.C;for(var c=b.C,e=0;e<a.L.length;e++){var f=a.L[e].getSelection();if(Ed(f.Bd,d.Bd)&&f.C==d.C&&f.rf.start>d.rf.end){var h=d.rf.getLength()-c.length;f.rf.start-=h;f.rf.end-=h}}}},a));EU(a.D,new kA(e,"",Vz(d.Bd)),v(function(){this.F.C(l)},a))}}
function cYd(a,b){b&&EU(a.D,new kA(b.C,"",Vz(b.Bd)))};function IYd(a){this.D=new GDc(a)}IYd.prototype.C=function(a){var b=new Wx,c=new uw;X(c,2,a.Bd.y);vw(c,a.Bd.y+1);c.Gu(a.Bd.x);c.Rx(a.Bd.x+1);X(c,1,""+a.C);Wv(b,2,c);c=new Vx;X(c,1,""+a.C);X(c,2,a.Bd.y);X(c,3,a.Bd.x);X(b,1,c);return this.D.C(new tA(b))};function JYd(a,b,c,d,e,f,h,k){ZW.call(this,"docs-spellcheckslidingdialog-id",c);this.H=v(this.lsa,this);this.Ga=a;this.Oa=new nYd;this.Aa=new SXd;this.qa=new pYd(a);this.J=new g6(a,e,Z5.getInstance(),this.Aa,this.qa);this.Na=new HYd(a,b,this.J,this.qa);b=Kd();e=new TXd;a=new oYd(c,(new yk).build(),new IYd(a),new CXd("trigger-text",!1),this.J,k,e,b);this.va(a);this.V=a.C;this.D=new XXd(a,this.Aa,this.J,this.Na,d,this.Oa);this.F=b.xa("DIV",{style:"margin-top: 10px"});this.L=iS("Search the rest of the sheet",
b);this.L.render(this.F);this.getHandler().R(this.L,"action",this.gUb);this.O=iS("Search all sheets",b);this.O.render(this.F);this.getHandler().R(this.O,"action",v(this.lsa,this,"WORKBOOK"));Qr(h,Z5.getInstance(),"docs-user_dictionary");K.yU.subscribe("action",this.D.qpb,this.D);K.zU.subscribe("action",this.D.Bub,this.D);K.IU.subscribe("action",this.D.qzb,this.D);K.tN.subscribe("action",this.D.A$a,this.D);K.sN.subscribe("action",this.D.Inb,this.D);K.G2.subscribe("action",v(this.D.GKa,this.D,!1));
K.I2.subscribe("action",v(this.D.GKa,this.D,!0));d=Ge(this.V);h=new b6(Z5.getInstance());f.Ii(h);f=Fa(RXd,h,d);this.Ja=Me(f,void 0)}y(JYd,ZW);p=JYd.prototype;p.lQ=g("V");p.Ku=function(){JYd.ma.Ku.call(this);this.getHandler().R(this.C,"close",this.V0b).R(this.Ga,"Sa",this.W0b)};p.V0b=function(){this.NB()};p.W0b=function(){this.C.jr();this.NB()};
p.lsa=function(a,b){var c=b||null,d;a||((b=this.Ga.C)?0==b.getSheetType()?(c=b.Nc().Qc(),1<c.kh()?(a="RANGE",c=new kA(b.yb(),b.pe(),c)):(a="SHEET",c=new kA(b.yb(),b.pe(),null))):a="WORKBOOK":a="WORKBOOK");"WORKBOOK"!=a&&(d=15E3);switch(a){case "RANGE":this.L.setVisible(!0);this.O.setVisible(!0);L(this.F,!0);break;case "SHEET":this.L.setVisible(!1);this.O.setVisible(!0);L(this.F,!0);break;case "WORKBOOK":L(this.F,!1)}b=this.J;aYd(b);b.V=a;b.F=c;switch(a){case "WORKBOOK":b.J=new Dd(-1,0);(a=b.H.V5(-1,
0,!1,!0))?b.D=""+a.yb():(b.D=null,b.O=!0);break;case "SHEET":b.J=new Dd(-1,0);b.D=""+c.ud;break;case "RANGE":b.J=new Dd(c.rect.left-1,c.rect.top),b.D=""+c.ud}a=this.V;a.Db=this.F;a.Ac=d?d:5E3;a=this.D;K.nda.Oc(!0);a.Ka.R(a.F,"docs-text-spellcheckdialogcontroller-closed",a.bDa);d=a.F;a=v(a.oMb,a);b=d.D.C;d.C.Wb()||d.C.render(ye(d.hb,"docs-spellcheckslidingdialog-id"));(c=d.C.wJ)&&b?d.C.focus():(c||d.Ka.R(d.C,"close",d.F),a())};p.X0b=function(){this.Ja()};
p.gUb=function(){var a=this.J.F;this.lsa("SHEET",new kA(a.ud,a.Tg,null))};function KYd(){B.call(this)}y(KYd,TA);KYd.prototype.C=function(a,b,c,d,e,f,h,k){return new JYd(a,b,c,d,e,f,h,k)};aB("spellcheck",KYd);
